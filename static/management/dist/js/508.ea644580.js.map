{"version":3,"file":"js/508.ea644580.js","mappings":"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","sources":["webpack://zmwk_session_archive/./node_modules/@ant-design/icons-svg/es/asn/RedoOutlined.js","webpack://zmwk_session_archive/./node_modules/@ant-design/icons-vue/es/icons/RedoOutlined.js","webpack://zmwk_session_archive/./src/api/company.js","webpack://zmwk_session_archive/./src/views/customerManagement/index.vue","webpack://zmwk_session_archive/./src/views/customerManagement/index.vue?14f2"],"sourcesContent":["// This icon file is generated automatically.\nvar RedoOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z\" } }] }, \"name\": \"redo\", \"theme\": \"outlined\" };\nexport default RedoOutlined;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport RedoOutlinedSvg from \"@ant-design/icons-svg/es/asn/RedoOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar RedoOutlined = function RedoOutlined(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": RedoOutlinedSvg\n  }), null);\n};\n\nRedoOutlined.displayName = 'RedoOutlined';\nRedoOutlined.inheritAttrs = false;\nexport default RedoOutlined;","import request from \"@/api/request\";\r\n\r\nexport const syncDepartmentStaff = () => {\r\n    return request.get('/api/department/sync')\r\n}\r\n\r\nexport const departmentList = () => {\r\n    return request.get('/api/department/list')\r\n}\r\n\r\nexport const staffList = (data) => {\r\n    return request.get('/api/staff/list', {params: data})\r\n}\r\n\r\nexport const groupsList = (data) => {\r\n    return request.get('/api/groups/list', {params: data})\r\n}\r\n\r\nexport const groupsSync = (data) => {\r\n    return request.get('/api/groups/sync', {params: data})\r\n}\r\n\r\nexport const customersList = (data) => {\r\n    return request.get('/api/customers/list', {params: data})\r\n}\r\n\r\nexport const customersSync = (data) => {\r\n    return request.get('/api/customers/sync', {params: data})\r\n}\r\n","<template>\r\n    <MainLayout title=\"客户列表\">\r\n        <div class=\"filter-box\">\r\n            <div class=\"filter-item\">\r\n                <label>搜索客户：</label>\r\n                <div class=\"mr10\">\r\n                    <a-input\r\n                        style=\"width: 100%;\"\r\n                        placeholder=\"请输入客户昵称搜索\"\r\n                        allowClear\r\n                        @pressEnter=\"initSearch\"\r\n                        v-model:value=\"filterData.keyword\"\r\n                    ></a-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"filter-item\"></div>\r\n            <div class=\"filter-item\" style=\"justify-content: right\">\r\n                <a-button @click=\"initSearch\" type=\"primary\">搜索</a-button>\r\n                <a-button @click=\"resetSearch\" class=\"ml8\">重置</a-button>\r\n            </div>\r\n        </div>\r\n        <div class=\"container\">\r\n            <div class=\"left-block\">\r\n                <div class=\"header-box mt12\">\r\n                    <div class=\"fl-fc\">\r\n                        <span class=\"wz\">\r\n                            <a-radio-group\r\n                                v-model:value=\"dataShowType\"\r\n                                button-style=\"solid\"\r\n                                style=\"margin-right: 4px;\"\r\n                                @change=\"dataTypeChange\"\r\n                            >\r\n                                <a-radio-button value=\"a\" :disabled=\"has_search_flag\">\r\n                                近七日\r\n                                </a-radio-button>\r\n                                <a-radio-button value=\"b\" style=\"width: 74px; text-align: center;\">\r\n                                全部\r\n                                </a-radio-button>\r\n                            </a-radio-group>\r\n                            {{!has_search_flag && dataShowType == 'a' ? '共新增' : '共'}}{{ totals || 0 }}个客户\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div\r\n                        class=\"list margin-bottom-16 self-header-two fx-ac\"\r\n                        style=\"justify-content: space-between; margin-top: 12px;\"\r\n                    >\r\n                        <div class=\"fx-ac update-box\">\r\n                            <div>\r\n                                <span class=\"lefts_sizes\" v-if=\"last_sync_time\">\r\n                                上次更新时间：{{ timeContrast(last_sync_time) }}\r\n                                </span>\r\n                            </div>\r\n                            <a-button\r\n                                :loading=\"updateLoading\"\r\n                                class=\"lefts btn-update\"\r\n                                @click=\"Update\"\r\n                                >\r\n                                <template #icon><RedoOutlined class=\"update-icon\" /></template>\r\n                                {{ updateLoading ? \"更新中\" : \"更新数据\" }}\r\n                            </a-button>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <a-table\r\n                    class=\"mt16\"\r\n                    :loading=\"loading\"\r\n                    :data-source=\"list\"\r\n                    :columns=\"columns\"\r\n                    :pagination=\"pagination\"\r\n                    @change=\"tableChange\"\r\n                >\r\n                    <template #bodyCell=\"{ column, text, record }\">\r\n                        <template v-if=\"'external_name' === column.dataIndex\">\r\n                            <a-tooltip overlayClassName=\"user-info-tooltip\">\r\n                                <template #title>\r\n                                    <div>客户备注：{{ record.staff_remark }}</div>\r\n                                    <!-- <div>unionID：{{ record.unionid || \"--\" }}</div> -->\r\n                                    <div>外部联系人ID：{{ record.external_userid }}</div>\r\n                                </template>\r\n                                <div class=\"qunfa\" style=\"display: flex; align-items: center\">\r\n                                    <img v-if=\"record.avatar\"\r\n                                        :src=\"record.avatar\"\r\n                                        style=\"width: 32px; height: 32px; margin-right: 8px\"\r\n                                        alt=\"\"/>\r\n                                    <img v-else src=\"../../assets/image/taglogo.svg\" alt=\"\"/>\r\n                                    <div class=\"qunfa-box\">\r\n                                        <div>\r\n                                            <span class=\"qunfa_name\">\r\n                                                {{ textLimit(record.external_name, 7) }}\r\n                                            </span>\r\n                                            <span style=\"color: #faad14\">\r\n                                                {{ record.corp_name == \"\" ? \"@微信\" : \"@\" + record.corp_name }}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </a-tooltip>\r\n                        </template>\r\n                        <template v-if=\"'add_status' === column.dataIndex\">\r\n                            <a-tag :color=\"record.add_status == '0' ? 'volcano' : 'green'\">\r\n                                {{ record.add_status == 0 ? \"已流失\" : \"未流失\" }}\r\n                            </a-tag>\r\n                        </template>\r\n                        <template v-if=\"'staff_name_slot' === column.dataIndex\">\r\n                            <span class=\"wk-black-65-text\">{{ record.staff_user_name }}</span>\r\n                        </template>\r\n\r\n                        <template v-if=\"'add_time' === column.dataIndex\">\r\n                            <span class=\"wk-black-65-text\">{{ record.add_time }}</span>\r\n                        </template>\r\n\r\n                        <template v-if=\"'source' === column.dataIndex\">\r\n                            {{ record.add_way }}\r\n                            {{ record.state && record.state.name ? \"【\" + record.state.name + \"】\" : \"\" }}\r\n                        </template>\r\n                        <template v-if=\"'tag_data' === column.dataIndex\">\r\n                            <span class=\"tages_wid\">\r\n                                <template v-if=\"record.tag_data.length > 1\">\r\n                                    <a-popover  :overlayStyle=\"{ zIndex: 998 }\">\r\n                                        <template #content>\r\n                                            <div style=\"width: 200px\">\r\n                                            <a-tag\r\n                                                style=\"white-space: pre-wrap; margin-bottom: 5px;\"\r\n                                                color=\"blue\"\r\n                                                v-for=\"item in record.tag_data.slice(\r\n                                                1,\r\n                                                record.tag_data.length\r\n                                                )\"\r\n                                                :key=\"item.tag_id\"\r\n                                                >{{ item.tag_name }}</a-tag\r\n                                            >\r\n                                            </div>\r\n                                        </template>\r\n                                        <div class=\"nowrap flex\">\r\n                                            <a-tag color=\"blue\" style=\"margin-bottom:0;\">{{\r\n                                            record.tag_data[0] && record.tag_data[0].tag_name.length > 10 ? record.tag_data[0].tag_name.substring(0, 10) + '...' : record.tag_data[0].tag_name\r\n                                            }}</a-tag>\r\n                                            <div class=\"nowrap\" style=\"color: #1890ff;width:30px;\">\r\n                                            +{{ record.tag_data.length - 1 }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </a-popover>\r\n                                </template>\r\n                                <template v-else-if=\"record.tag_data.length == 1\">\r\n                                    <a-tag\r\n                                    color=\"blue\"\r\n                                    style=\"margin-bottom:0;\"\r\n                                    v-if=\"record.tag_data.length\"\r\n                                    >{{ record.tag_data[0] && record.tag_data[0].tag_name.length > 10 ? record.tag_data[0].tag_name.substring(0, 10) + '...' : record.tag_data[0].tag_name }}</a-tag\r\n                                    >\r\n                                </template>\r\n                                <template v-else>\r\n                                    <div>\r\n                                        -\r\n                                    </div>\r\n                                </template>\r\n                            </span>\r\n                        </template>\r\n                    </template>\r\n                </a-table>\r\n            </div>\r\n        </div>\r\n    </MainLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {onMounted, ref, reactive} from 'vue';\r\nimport {RedoOutlined} from '@ant-design/icons-vue';\r\nimport MainLayout from \"@/components/mainLayout.vue\";\r\nimport { customersList, customersSync } from \"@/api/company\";\r\nimport { formatDate } from \"@/utils/tools.js\"\r\nimport { message } from 'ant-design-vue';\r\nimport dayjs from 'dayjs';\r\n\r\nconst searchForm = reactive({\r\n    size: 20,\r\n    page: 1,\r\n    name: \"\",\r\n    member_name: \"\",\r\n    tagNames: [],\r\n    remark_yes: -1,\r\n    sort: 1,\r\n    normal_status: '',\r\n})\r\n\r\nconst filterTagParams = reactive({\r\n    type: 0,\r\n    contain_tag: [],\r\n    contain_tag_keys: [],\r\n    contain_tag_map: [],\r\n    exclude_tag: [],\r\n    exclude_tag_map: []\r\n})\r\n\r\nconst columns = [\r\n    {\r\n        dataIndex: \"external_name\",\r\n        key: \"external_name\",\r\n        title: \"客户昵称\",\r\n        scopedSlots: {customRender: \"external_name\"},\r\n        fixed: \"left\"\r\n    },\r\n    {\r\n        title: \"流失状态\",\r\n        dataIndex: \"add_status\",\r\n        key: \"add_status\",\r\n        scopedSlots: {customRender: \"add_status\"}\r\n    },\r\n    {\r\n        title: \"所属员工\",\r\n        dataIndex: \"staff_user_name\",\r\n        key: \"staff_user_name\",\r\n        width: 120,\r\n        scopedSlots: {customRender: \"staff_name_slot\"}\r\n    },\r\n    {\r\n        title: \"添加时间\",\r\n        dataIndex: \"add_time\",\r\n        key: \"add_time\"\r\n    },\r\n    {\r\n        title: \"客户标签\",\r\n        key: \"tag_data\",\r\n        dataIndex: \"tag_data\",\r\n        scopedSlots: {customRender: \"tag_data\"}\r\n    }\r\n]\r\n\r\nconst last_sync_time = ref('') // 更新数据\r\nconst dataShowType = ref('b')\r\nconst createGroupDates = ref('')\r\nconst loading = ref(false)\r\nconst list = ref([])\r\nconst pagination = reactive({\r\n    total: 0,\r\n    current: 1,\r\n    pageSize: 10,\r\n    showSizeChanger: true,\r\n    pageSizeOptions: ['10', '20', '50', '100'],\r\n})\r\nconst filterData = reactive({\r\n    keyword: '',\r\n})\r\n\r\nconst totals = ref(0)\r\n// const unique_totals = ref(0) // 去重客户数\r\nconst updateLoading = ref(false)\r\nconst has_search_flag = ref(false)\r\nconst staff_ids = ref([])\r\n\r\nfunction timeContrast(time) {\r\n    // 当前时间\r\n    let new_time = parseInt(new Date().getTime() / 1000) + \"\";\r\n\r\n    let result = \"\";\r\n    let diffTime = \"\";\r\n    // 同步时间差\r\n    // diffTime = new_time * 1 - moment(time).format(\"X\");\r\n    diffTime = new_time * 1 - +time;\r\n    if (diffTime <= 60) {\r\n    result = diffTime + \"秒前 \";\r\n    } else if (diffTime > 60 && diffTime <= 3660) {\r\n    result = parseInt(diffTime / 60) + \"分钟前 \";\r\n    } else if (diffTime > 3660 && diffTime <= 86400) {\r\n    result = parseInt(diffTime / 3600) + \"小时前 \";\r\n    } else if (diffTime > 86400) {\r\n    result = parseInt(diffTime / 86400) + \"天前 \";\r\n    }\r\n    return result\r\n}\r\n\r\nconst dataTypeChange = () => {\r\n    search()\r\n}\r\n\r\nconst textLimit = (text, max) => {\r\n    if (!text) {\r\n        return  \"\"\r\n    }\r\n    return text.length > max ? text.substring(0, max) + \"..\" : text\r\n}\r\n\r\nconst refresh = ref(0)\r\n\r\nconst Update = () => {\r\n    //更新数据\r\n    if (refresh.value == 0) {\r\n    refresh.value = 1;\r\n    updateLoading.value = true;\r\n    customersSync({}).then((res) => {\r\n        refresh.value = 0;\r\n        updateLoading.value = false;\r\n        message.success('更新成功')\r\n    });\r\n    }\r\n}\r\n\r\nonMounted(() => {\r\n    loadData()\r\n})\r\n\r\nconst lastGetTime = ref(0)\r\n\r\nconst initSearch = () => {\r\n    lastGetTime.value = new Date().getTime() / 1000;\r\n    searchForm.page = 1;\r\n    search();\r\n}\r\n\r\nconst resetSearch = () => {\r\n    filterTagParams.type = 0\r\n    filterTagParams.contain_tag = []\r\n    filterTagParams.contain_tag_keys = []\r\n    filterTagParams.contain_tag_map = []\r\n    filterTagParams.exclude_tag = []\r\n    filterTagParams.exclude_tag_map = []\r\n    staff_ids.value = [];\r\n    createGroupDates.value = \"\";\r\n    filterData.keyword = ''\r\n    initSearch();\r\n}\r\n\r\nconst search = () => {\r\n    list.value = []\r\n    pagination.total = 1\r\n    pagination.current = 1\r\n    loadData()\r\n}\r\n\r\nconst loadData = () => {\r\n    loading.value = true\r\n    let params = {\r\n        page: pagination.current,\r\n        size: pagination.pageSize\r\n    }\r\n    filterData.keyword = filterData.keyword.trim()\r\n    if (filterData.keyword) {\r\n        params.keyword = filterData.keyword\r\n    }\r\n    if (dataShowType.value === 'a') {\r\n        params.add_time = dayjs().subtract(6, 'day').format('YYYY-MM-DD HH:mm:ss')\r\n    }\r\n    customersList(params).then(res => {\r\n        list.value = res.data.items || []\r\n        last_sync_time.value = res.data.last_sync_time || ''\r\n        pagination.total = Number(res.data.total)\r\n        totals.value = res.data.total\r\n    }).finally(() => {\r\n        loading.value = false\r\n    })\r\n}\r\n\r\nconst tableChange = p => {\r\n    pagination.current = p.current\r\n    pagination.pageSize = p.pageSize\r\n    loadData()\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.container {\r\n    display: flex;\r\n    margin: 12px;\r\n\r\n    > div {\r\n        background: #FFF;\r\n        border-radius: 2px;\r\n        // overflow-y: scroll;\r\n        // height: calc(100vh - 250px);\r\n    }\r\n\r\n    .left-block {\r\n        padding: 12px;\r\n        flex: 1;\r\n    }\r\n\r\n    .right-block {\r\n        flex-shrink: 0;\r\n        width: 16vw;\r\n        max-width: 300px;\r\n\r\n        :deep(.ant-tabs) {\r\n            .ant-tabs-tab {\r\n                margin: 0 12px;\r\n            }\r\n\r\n            .ant-tabs-content {\r\n                padding: 0 12px;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.filter-box {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n  padding: 16px 24px 0;\r\n  background-color: white;\r\n  margin: 12px;\r\n\r\n  .mr10{\r\n    margin-right: 10px;\r\n  }\r\n  .filter-item {\r\n    margin-bottom: 16px;\r\n    display: flex;\r\n    align-items: center;\r\n    width: 25%;\r\n    flex-shrink: 0;\r\n\r\n    > div {\r\n      width: calc(100% - 70px);\r\n    }\r\n\r\n    label {\r\n      white-space: nowrap;\r\n      display: inline-block;\r\n      width: 70px;\r\n      flex-shrink: 0;\r\n      text-align: right;\r\n    }\r\n\r\n    .name-box {\r\n        display: flex;\r\n    }\r\n  }\r\n}\r\n\r\n.header-box {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: self-start;\r\n    gap: 8px;\r\n}\r\n\r\n.scan-code-group {\r\n    color: #2475fc;\r\n    cursor: pointer;\r\n}\r\n\r\n.margin-left-15 {\r\n    margin-left: 15px;\r\n}\r\n\r\n.list {\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    font-size: 16px;\r\n    font-family: PingFangSC-Regular, PingFang SC;\r\n    font-weight: 400;\r\n    color: #000000;\r\n    line-height: 24px;\r\n\r\n    .wz {\r\n      font-size: 14px;\r\n      color: rgba(0, 0, 0, 0.65);\r\n    }\r\n    .fl-fc{\r\n      display: flex;\r\n      flex-direction: column;\r\n    }\r\n\r\n    .wz-color {\r\n      color: rgba(0, 0, 0, 0.45);\r\n    }\r\n\r\n    .mb10 {\r\n      margin-bottom: 10px;\r\n    }\r\n    .mr10 {\r\n      margin-right: 10px;\r\n    }\r\n    .lefts {\r\n      margin-left: 10px;\r\n    }\r\n\r\n    .lefts_size {\r\n      transform: rotate(-100deg);\r\n      color: #595959;\r\n    }\r\n\r\n    .lefts_sizes {\r\n      margin-left: 5px;\r\n      cursor: auto;\r\n    }\r\n    .lefts_check{\r\n      margin-left:16px;\r\n      .ant-checkbox+span{\r\n        padding-right:0;\r\n      }\r\n    }\r\n\r\n    span {\r\n      cursor: pointer;\r\n      font-size: 13px;\r\n      font-family: PingFangSC-Regular, PingFang SC;\r\n      font-weight: 400;\r\n      color: rgba(0, 0, 0, 0.45);\r\n      line-height: 22px;\r\n    }\r\n}\r\n\r\n.update-box {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .btn-update {\r\n        color: #595959;\r\n\r\n        &:hover, &:hover .update-icon{\r\n            color: #4096ff;\r\n        }\r\n\r\n    }\r\n}\r\n\r\n.qunfa-box {\r\n  margin-bottom: 0;\r\n  padding: 2px 8px;\r\n}\r\n\r\n.qunfa {\r\n  font-size: 12px;\r\n  width: 250px;\r\n}\r\n\r\n.qunfa_name {\r\n  font-size: 13px;\r\n  font-family: PingFangSC-Medium, PingFang SC;\r\n  font-weight: 500;\r\n  color: rgba(0, 0, 0, 0.65);\r\n  margin-right: 6px;\r\n}\r\n\r\n.tages_wid {\r\n  display: inline-block;\r\n  // width: 400px;\r\n\r\n  // span {\r\n    // margin-bottom: 8px;\r\n  // }\r\n}\r\n\r\n.margin-bottom-16 {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.nowrap{\r\n  white-space: nowrap;\r\n}\r\n\r\n.flex {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.user-info-tooltip .ant-tooltip-inner {\r\n    width: max-content;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=44756889&scoped=true&lang=less\"\nimport \"./index.vue?vue&type=style&index=1&id=44756889&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-44756889\"]])\n\nexport default __exports__"],"names":["RedoOutlined","_objectSpread","target","i","arguments","length","source","Object","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","props","context","p","attrs","_createVNode","AntdIcon","RedoOutlinedSvg","displayName","inheritAttrs","syncDepartmentStaff","request","get","departmentList","staffList","data","params","groupsList","groupsSync","customersList","customersSync","searchForm","reactive","size","page","name","member_name","tagNames","remark_yes","sort","normal_status","filterTagParams","type","contain_tag","contain_tag_keys","contain_tag_map","exclude_tag","exclude_tag_map","columns","dataIndex","title","scopedSlots","customRender","fixed","width","last_sync_time","ref","dataShowType","createGroupDates","loading","list","pagination","total","current","pageSize","showSizeChanger","pageSizeOptions","filterData","keyword","totals","updateLoading","has_search_flag","staff_ids","timeContrast","time","new_time","parseInt","Date","getTime","result","diffTime","dataTypeChange","search","textLimit","text","max","substring","refresh","Update","then","res","message","success","onMounted","loadData","lastGetTime","initSearch","resetSearch","trim","add_time","dayjs","subtract","format","items","Number","finally","tableChange","__exports__"],"sourceRoot":""}