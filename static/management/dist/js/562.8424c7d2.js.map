{"version":3,"file":"js/562.8424c7d2.js","mappings":"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","sources":["webpack://zmwk_session_archive/./node_modules/@ant-design/icons-svg/es/asn/SyncOutlined.js","webpack://zmwk_session_archive/./node_modules/@ant-design/icons-vue/es/icons/SyncOutlined.js","webpack://zmwk_session_archive/./src/api/company.js","webpack://zmwk_session_archive/./src/views/groupManagement/index.vue","webpack://zmwk_session_archive/./src/views/groupManagement/index.vue?6f3f"],"sourcesContent":["// This icon file is generated automatically.\nvar SyncOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z\" } }] }, \"name\": \"sync\", \"theme\": \"outlined\" };\nexport default SyncOutlined;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport SyncOutlinedSvg from \"@ant-design/icons-svg/es/asn/SyncOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar SyncOutlined = function SyncOutlined(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": SyncOutlinedSvg\n  }), null);\n};\n\nSyncOutlined.displayName = 'SyncOutlined';\nSyncOutlined.inheritAttrs = false;\nexport default SyncOutlined;","import request from \"@/api/request\";\r\n\r\nexport const syncDepartmentStaff = () => {\r\n    return request.get('/api/department/sync')\r\n}\r\n\r\nexport const departmentList = () => {\r\n    return request.get('/api/department/list')\r\n}\r\n\r\nexport const staffList = (data) => {\r\n    return request.get('/api/staff/list', {params: data})\r\n}\r\n\r\nexport const groupsList = (data) => {\r\n    return request.get('/api/groups/list', {params: data})\r\n}\r\n\r\nexport const groupsSync = (data) => {\r\n    return request.get('/api/groups/sync', {params: data})\r\n}\r\n\r\nexport const customersList = (data) => {\r\n    return request.get('/api/customers/list', {params: data})\r\n}\r\n\r\nexport const customersSync = (data) => {\r\n    return request.get('/api/customers/sync', {params: data})\r\n}\r\n","<template>\r\n    <MainLayout title=\"群列表\">\r\n        <div class=\"filter-box\">\r\n            <div class=\"filter-item\">\r\n                <label>群名称：</label>\r\n                <div class=\"mr10\">\r\n                    <a-input\r\n                        ref=\"inputGroupNameRef\"\r\n                        style=\"width: 100%;\"\r\n                        placeholder=\"请输入客户群名称搜索\"\r\n                        allowClear\r\n                        @pressEnter=\"initSearch\"\r\n                        v-model:value=\"searchForm.name\"\r\n                    ></a-input>\r\n                </div>\r\n            </div>\r\n            <!-- <div class=\"filter-item\">\r\n                <label>群主：</label>\r\n                <div class=\"mr10\">\r\n                    <a-select\r\n                        style=\"width: 100%\"\r\n                        mode=\"multiple\"\r\n                        :maxTagCount=\"2\"\r\n                        placeholder=\"请选择群主\"\r\n                        :open=\"false\"\r\n                        allowClear\r\n                        @change=\"staffIdsChange\"\r\n                        v-model=\"staff_ids\"\r\n                        @dropdownVisibleChange=\"groupManageFocus\"\r\n                    >\r\n                        <a-select-option\r\n                            :value=\"item.user_id\"\r\n                            v-for=\"(item, index) in selectStaff\"\r\n                            :key=\"index\"\r\n                        >\r\n                        </a-select-option>\r\n                    </a-select>\r\n                </div>\r\n            </div>\r\n            <div class=\"filter-item\" style=\"justify-content: right;\">\r\n                <label>群标签：</label>\r\n                <div class=\"mr10\">\r\n                <a-popover placement=\"topLeft\">\r\n                    <template v-slot:content>\r\n                    <div v-if=\"filterTagParams.type === 3\">无标签</div>\r\n                    <div v-else-if=\"filterTagParams.type === 0 || filterTagParams.contain_tag_keys.length == 0\" class=\"zm-tip-info\">\r\n                        未选择标签\r\n                    </div>\r\n                    <div v-else>\r\n                        <div v-if=\"filterTagParams.contain_tag.length > 0\" class=\"mb16\">\r\n                        选择标签：\r\n                        <a-tag\r\n                            v-for=\"tag in filterTagParams.contain_tag_map\"\r\n                            :key=\"tag.key\"\r\n                            >{{ tag.label }}\r\n                        </a-tag>\r\n                        </div>\r\n                        <div v-if=\"filterTagParams.exclude_tag.length > 0\">\r\n                        排除标签：\r\n                        <a-tag\r\n                            v-for=\"tag in filterTagParams.exclude_tag_map\"\r\n                            :key=\"tag.key\"\r\n                            >{{ tag.label }}\r\n                        </a-tag>\r\n                        </div>\r\n                    </div>\r\n                    </template>\r\n                    <template v-slot:title></template>\r\n                    <a-select\r\n                        style=\"width: 100%\"\r\n                        mode=\"multiple\"\r\n                        readonly\r\n                        :placeholder=\"filterTagText()\"\r\n                        class=\"flex1 filter-tag-select\"\r\n                        :open=\"false\"\r\n                        :allowClear=\"true\"\r\n                        v-model=\"filterTagParams.contain_tag_keys\"\r\n                        :maxTagCount=\"3\"\r\n                        :maxTagTextLength=\"3\"\r\n                        @change=\"fileterTagChange\"\r\n                    >\r\n                    <a-select-option\r\n                        v-for=\"tag in filterTagParams.num_tag_list\"\r\n                        :key=\"tag.key\"\r\n                        :value=\"tag.key\"\r\n                    >\r\n                        {{ tag.label }}\r\n                    </a-select-option>\r\n                    </a-select>\r\n                </a-popover>\r\n                </div>\r\n            </div>\r\n            <div class=\"filter-item\">\r\n                <label>建群时间：</label>\r\n                <div>\r\n                <a-date-picker\r\n                    v-model=\"createGroupDates\"\r\n                    style=\"width: 100%\"\r\n                    format=\"YYYY-MM-DD\"\r\n                    :showToday=\"false\"\r\n                    @change=\"assignDate\"\r\n                />\r\n                </div>\r\n            </div>\r\n            <div class=\"filter-item\">\r\n                <label>排序条件：</label>\r\n                <div class=\"mr10\">\r\n                <a-select\r\n                    v-model=\"searchForm.sort\"\r\n                    style=\"width: 100%\"\r\n                    placeholder=\"请选择客户群标签搜索\"\r\n                    @change=\"sortChange\"\r\n                >\r\n                    <a-select-option :value=\"1\">群内总人数</a-select-option>\r\n                    <a-select-option :value=\"4\">创建时间</a-select-option>\r\n                </a-select>\r\n                </div>\r\n            </div>\r\n            <div class=\"filter-item\">\r\n                <label>群状态：</label>\r\n                <div class=\"mr10\">\r\n                <a-select\r\n                    v-model=\"searchForm.normal_status\"\r\n                    style=\"width: 100%\"\r\n                    placeholder=\"请选择群状态\"\r\n                    @change=\"initSearch\"\r\n                >\r\n                    <a-select-option :value=\"''\">全部</a-select-option>\r\n                    <a-select-option :value=\"1\">有效</a-select-option>\r\n                    <a-select-option :value=\"0\">异常</a-select-option>\r\n                </a-select>\r\n                </div>\r\n            </div> -->\r\n            <div class=\"filter-item\"></div>\r\n            <div class=\"filter-item\" style=\"justify-content: right\">\r\n                <a-button @click=\"initSearch\" type=\"primary\">搜索</a-button>\r\n                <a-button @click=\"resetSearch\" class=\"ml8\">重置</a-button>\r\n            </div>\r\n        </div>\r\n        <div class=\"container\">\r\n            <div class=\"left-block\">\r\n                <div class=\"header-box mt12\">\r\n                    <div class=\"zm-flex-between\">\r\n                        <div>群总数：<strong>{{ pagination.total }}</strong></div>\r\n                    </div>\r\n                    <a-tooltip overlayClassName=\"user-info-tooltip\">\r\n                        <template #title>\r\n                            <span>\r\n                                上次更新时间：<span class=\"num\">{{ last_sync_time || '暂无更新时间' }}</span>\r\n                            </span>\r\n                        </template>\r\n                        <a-button\r\n                            type=\"primary\"\r\n                            style=\"margin-left:20px;\"\r\n                            :icon=\"h(SyncOutlined)\"\r\n                            :loading=\"latest_info.success == false\"\r\n                            @click=\"pullCustomerGroup\"\r\n                        >\r\n                        更新数据\r\n                        </a-button>\r\n                    </a-tooltip>\r\n                </div>\r\n                <a-table\r\n                    class=\"mt16\"\r\n                    :loading=\"loading\"\r\n                    :data-source=\"list\"\r\n                    :columns=\"columns\"\r\n                    :pagination=\"pagination\"\r\n                    @change=\"tableChange\"\r\n                >\r\n                    <template #bodyCell=\"{ column, text, record }\">\r\n                        <template v-if=\"'name' === column.dataIndex\">\r\n                            <div class=\"zm-user-info\">\r\n                                <img class=\"avatar\" src=\"@/assets/default-avatar.png\"/>\r\n                                <span class=\"name\">{{ record.name }}</span>\r\n                            </div>\r\n                        </template>\r\n                        <template v-if=\"'group_create_time' === column.dataIndex\">\r\n                            <div class=\"create_time\">{{ record.group_create_time }}</div>\r\n                        </template>\r\n                        <!-- <template v-if=\"'btns' === column.dataIndex\">\r\n                            <a-popover\r\n                                placement=\"left\"\r\n                                @visibleChange=\"visiblePopoverChange($event, scope.row)\"\r\n                            >\r\n                                <template #content>\r\n                                <div class=\"group-enter-popup\">\r\n                                    <span>请使用企业微信扫描下方二维码，</span>\r\n                                    <span>可快速进群修改群名称</span>\r\n                                    <img\r\n                                    v-if=\"groupEnterUrl\"\r\n                                    :src=\"groupEnterUrl\"\r\n                                    style=\"width: 120px;height: 128px;\"\r\n                                    />\r\n                                </div>\r\n                                </template>\r\n                                <a class=\"mr16 height-automatic eli-one-text\">扫码进群</a>\r\n                            </a-popover>\r\n                        </template> -->\r\n                    </template>\r\n                </a-table>\r\n            </div>\r\n        </div>\r\n        <!-- <selectStaffNew\r\n            selectType=\"multiple\"\r\n            title=\"选择所属员工\"\r\n            ref=\"setStaffRef\"\r\n            @change=\"selectStaffChange\"\r\n        >\r\n        </selectStaffNew> -->\r\n    </MainLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, reactive, h } from 'vue';\r\nimport { message } from 'ant-design-vue';\r\n// import selectStaffNew from \"@/components/select-staff-new/index\";\r\nimport {SyncOutlined} from '@ant-design/icons-vue';\r\nimport MainLayout from \"@/components/mainLayout.vue\";\r\nimport { groupsList, groupsSync } from \"@/api/company\";\r\nimport { formatDate } from \"@/utils/tools.js\"\r\n// import jrQrcode from \"jr-qrcode\";\r\n\r\n// const setStaffRef = ref(null)\r\nconst inputGroupNameRef = ref(null)\r\nconst searchForm = reactive({\r\n    size: 20,\r\n    page: 1,\r\n    name: \"\",\r\n    member_name: \"\",\r\n    tagNames: [],\r\n    remark_yes: -1,\r\n    sort: 1,\r\n    normal_status: '',\r\n})\r\n\r\nconst filterTagParams = reactive({\r\n    type: 0,\r\n    contain_tag: [],\r\n    contain_tag_keys: [],\r\n    contain_tag_map: [],\r\n    exclude_tag: [],\r\n    exclude_tag_map: []\r\n})\r\n\r\nconst columns = [\r\n    {\r\n        title: '群名',\r\n        dataIndex: 'name',\r\n        scopedSlots: { customRender: 'name' },\r\n        minWidth: '200',\r\n        ellipsis: true,\r\n        sort_key: 'name',\r\n    },\r\n    {\r\n        title: '群主',\r\n        dataIndex: 'owner_name',\r\n        scopedSlots: { customRender: 'owner_name_slot' },\r\n        minWidth: '140',\r\n        sort_key: 'owner_name',\r\n    },\r\n    {\r\n        dataIndex: 'total_member',\r\n        title: '群人数',\r\n        minWidth: '65',\r\n        scopedSlots: { customRender: 'total_member' },\r\n        sort_key: 'total_member',\r\n    },\r\n    // {\r\n    //     title: '同步标签',\r\n    //     dataIndex: 'xkf_tag_dec',\r\n    //     minWidth: '100',\r\n    //     scopedSlots: { customRender: 'syncTag' },\r\n    //     sort_key: 'xkf_tag_dec',\r\n    // },\r\n    // {\r\n    //     title: '可见范围',\r\n    //     dataIndex: 'status',\r\n    //     minWidth: '75',\r\n    //     scopedSlots: { customRender: 'status' },\r\n    //     sort_key: 'status',\r\n    // },\r\n    {\r\n        dataIndex: 'group_create_time',\r\n        scopedSlots: { customRender: 'group_create_time' },\r\n        title: '创建时间',\r\n        minWidth: '120',\r\n        sort_key: 'group_create_time',\r\n    }\r\n    // ,\r\n    // {\r\n    //     dataIndex: 'btns',\r\n    //     title: '操作',\r\n    //     renderHeader: true,\r\n    //     scopedSlots: { customRender: 'btns' },\r\n    //     minWidth: '250',\r\n    //     fixed: 'right',\r\n    //     sort_key: 'play_key'\r\n    // }\r\n]\r\n\r\nconst createGroupDates = ref('')\r\nconst loading = ref(false)\r\nconst list = ref([])\r\nconst pagination = reactive({\r\n    total: 0,\r\n    current: 1,\r\n    pageSize: 10,\r\n    showSizeChanger: true,\r\n    pageSizeOptions: ['10', '20', '50', '100'],\r\n})\r\nconst filterData = reactive({\r\n    keyword: '',\r\n})\r\n\r\nconst staff_ids = ref([])\r\n// const selectStaff = ref([])\r\n// const staffIdsChange = () => {\r\n//     let arr = [];\r\n//     let staffs = [];\r\n//     staff_ids.value.forEach((i) => {\r\n//     selectStaff.value.forEach((it) => {\r\n//         if (i === it.user_id) {\r\n//         arr.push(it.staff_id);\r\n//         staffs.push(it);\r\n//         }\r\n//     });\r\n//     });\r\n//     searchForm.staff_id = arr.join(\",\");\r\n//     selectStaff.value = staffs;\r\n// }\r\n\r\n// const groupManageFocus = () => {\r\n//     if (setStaffRef.value) {\r\n//         setStaffRef.value.show(selectStaff.value)\r\n//     }\r\n// }\r\n\r\n//选中员工逻辑\r\n// const selectStaffChange = (val) => {\r\n//     selectStaff.value = val;\r\n//     staff_ids.value = val.map((item) => item.user_id);\r\n//     searchForm.staff_id = val.map((item) => item.staff_id).toString();\r\n// }\r\n\r\n// const filterTagText = () => {\r\n//     if(filterTagParams.contain_tag_keys.length == 0){\r\n//         return \"请选择客户群标签搜索\";\r\n//     }\r\n//     switch (filterTagParams.type) {\r\n//         case 0:\r\n//         return \"请选择客户群标签\";\r\n//         case 1:\r\n//         return \"满足任意一个群标签\";\r\n//         case 2:\r\n//         return \"同时满足所选群标签\";\r\n//         case 3:\r\n//         return \"无群标签\";\r\n//     }\r\n// }\r\n\r\n// const fileterTagChange = (val) => {\r\n//     if(val.length == 0){\r\n//         filterTagParams.contain_tag_keys = []\r\n//         filterTagParams.num_tag_list = []\r\n//         filterTagParams.contain_tag_map = []\r\n//         filterTagParams.exclude_tag_map = []\r\n//         filterTagParams.contain_tag = []\r\n//         filterTagParams.exclude_tag = []\r\n//         return\r\n//     }\r\n\r\n//     filterTagParams.contain_tag_keys = val\r\n//     // 当前删除的tag\r\n//     let del_tag = filterTagParams.num_tag_list.filter(sub=> !val.includes(sub.key))\r\n//     // 更新当前显示的数据\r\n//     filterTagParams.num_tag_list = filterTagParams.num_tag_list.filter(sub=> val.includes(sub.key))\r\n//     // 过滤掉已经删除的\r\n//     filterTagParams.contain_tag_map = filterTagParams.contain_tag_map.filter(sub=> !sub.key.includes(del_tag[0].key))\r\n//     filterTagParams.exclude_tag_map = filterTagParams.exclude_tag_map.filter(sub=> !sub.key.includes(del_tag[0].key))\r\n//     // 重新赋值keys\r\n//     filterTagParams.contain_tag = filterTagParams.contain_tag_map.map(sub=> sub.key)\r\n//     filterTagParams.exclude_tag = filterTagParams.exclude_tag_map.map(sub=> sub.key)\r\n// }\r\n\r\n// const rowSelection = ref({\r\n//   checkStrictly: false,\r\n//   onChange: (selectedRowKeys, selectedRows) => {\r\n//     console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows);\r\n//   },\r\n//   onSelect: (record, selected, selectedRows) => {\r\n//     console.log(record, selected, selectedRows);\r\n//   },\r\n//   onSelectAll: (selected, selectedRows, changeRows) => {\r\n//     console.log(selected, selectedRows, changeRows);\r\n//   },\r\n// });\r\n\r\n// const groupEnterUrl = ref('')\r\n// const visiblePopoverChange = (e, record) => {\r\n//     if(e){\r\n//         // let data = {\r\n//         //     group_id: record.chat_id,\r\n//         //     group_name:record.name\r\n//         // }\r\n//         // getGroupEnterLink(data).then((res) => {\r\n//         //     groupEnterUrl.value = jrQrcode.getQrBase64(res.data.url);\r\n//         // })\r\n//     }\r\n// }\r\n\r\nonMounted(() => {\r\n    loadData()\r\n})\r\n\r\nconst last_sync_time = ref('')\r\nconst refreshFlag = ref(false)\r\nconst latest_info = reactive({\r\n    end_time: void 0,\r\n    success: true\r\n})\r\nconst pullCustomerGroup = () => {\r\n    if (!refreshFlag.value) {\r\n        refreshFlag.value = true;\r\n        latest_info.success = false;\r\n        groupsSync({}).then((res) => {\r\n            console.log('rea1', res)\r\n            //已经在拉取的状态\r\n            refreshFlag.value = false;\r\n            latest_info.success = true;\r\n            message.success('更新成功')\r\n            // checkTaskStatus();\r\n        });\r\n    }\r\n}\r\n\r\n// const assignDate = (value, date) => {\r\n//     searchForm.start_time = date;\r\n//     searchForm.end_time = date;\r\n// }\r\n\r\nconst lastGetTime = ref(0)\r\n\r\nconst initSearch = () => {\r\n    lastGetTime.value = new Date().getTime() / 1000;\r\n    searchForm.page = 1;\r\n    search();\r\n}\r\n\r\nconst resetSearch = () => {\r\n    filterTagParams.type = 0\r\n    filterTagParams.contain_tag = []\r\n    filterTagParams.contain_tag_keys = []\r\n    filterTagParams.contain_tag_map = []\r\n    filterTagParams.exclude_tag = []\r\n    filterTagParams.exclude_tag_map = []\r\n    staff_ids.value = [];\r\n    createGroupDates.value = \"\";\r\n    searchForm.name = \"\"\r\n    initSearch();\r\n}\r\n\r\n// const sortChange = () => {\r\n\r\n// }\r\n\r\nconst search = () => {\r\n    list.value = []\r\n    pagination.total = 1\r\n    pagination.current = 1\r\n    loadData()\r\n}\r\n\r\nconst loadData = () => {\r\n    loading.value = true\r\n    console.log(searchForm)\r\n    let params = {\r\n        page: pagination.current,\r\n        size: pagination.pageSize,\r\n        keyword: searchForm.name\r\n    }\r\n    filterData.keyword = filterData.keyword.trim()\r\n    if (filterData.keyword) {\r\n        params.keyword = filterData.keyword\r\n    }\r\n    groupsList(params).then(res => {\r\n        console.log('res', res)\r\n        list.value = res.data.items || []\r\n        last_sync_time.value = res.data.last_sync_time || ''\r\n        pagination.total = Number(res.data.total)\r\n    }).finally(() => {\r\n        loading.value = false\r\n    })\r\n}\r\n\r\nconst tableChange = p => {\r\n    pagination.current = p.current\r\n    pagination.pageSize = p.pageSize\r\n    loadData()\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.container {\r\n    display: flex;\r\n    margin: 12px;\r\n\r\n    > div {\r\n        background: #FFF;\r\n        border-radius: 2px;\r\n        // overflow-y: scroll;\r\n        // height: calc(100vh - 250px);\r\n    }\r\n\r\n    .left-block {\r\n        padding: 12px;\r\n        flex: 1;\r\n    }\r\n\r\n    .right-block {\r\n        flex-shrink: 0;\r\n        width: 16vw;\r\n        max-width: 300px;\r\n\r\n        :deep(.ant-tabs) {\r\n            .ant-tabs-tab {\r\n                margin: 0 12px;\r\n            }\r\n\r\n            .ant-tabs-content {\r\n                padding: 0 12px;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.filter-box {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n  padding: 16px 24px 0;\r\n  background-color: white;\r\n  margin: 12px;\r\n\r\n  .mr10{\r\n    margin-right: 10px;\r\n  }\r\n  .filter-item {\r\n    margin-bottom: 16px;\r\n    display: flex;\r\n    align-items: center;\r\n    width: 25%;\r\n    flex-shrink: 0;\r\n\r\n    > div {\r\n      width: calc(100% - 70px);\r\n    }\r\n\r\n    label {\r\n      white-space: nowrap;\r\n      display: inline-block;\r\n      width: 70px;\r\n      flex-shrink: 0;\r\n      text-align: right;\r\n    }\r\n  }\r\n}\r\n\r\n.header-box {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.scan-code-group {\r\n    color: #2475fc;\r\n    cursor: pointer;\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.user-info-tooltip .ant-tooltip-inner {\r\n    width: max-content;\r\n    white-space: nowrap;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=c7ee14d4&scoped=true&lang=less\"\nimport \"./index.vue?vue&type=style&index=1&id=c7ee14d4&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c7ee14d4\"]])\n\nexport default __exports__"],"names":["SyncOutlined","_objectSpread","target","i","arguments","length","source","Object","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","props","context","p","attrs","_createVNode","AntdIcon","SyncOutlinedSvg","displayName","inheritAttrs","syncDepartmentStaff","request","get","departmentList","staffList","data","params","groupsList","groupsSync","customersList","customersSync","inputGroupNameRef","ref","searchForm","reactive","size","page","name","member_name","tagNames","remark_yes","sort","normal_status","filterTagParams","type","contain_tag","contain_tag_keys","contain_tag_map","exclude_tag","exclude_tag_map","columns","title","dataIndex","scopedSlots","customRender","minWidth","ellipsis","sort_key","createGroupDates","loading","list","pagination","total","current","pageSize","showSizeChanger","pageSizeOptions","filterData","keyword","staff_ids","onMounted","loadData","last_sync_time","refreshFlag","latest_info","end_time","success","pullCustomerGroup","then","res","console","log","message","lastGetTime","initSearch","Date","getTime","search","resetSearch","trim","items","Number","finally","tableChange","__exports__"],"sourceRoot":""}