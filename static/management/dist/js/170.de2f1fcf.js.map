{"version":3,"file":"js/170.de2f1fcf.js","mappings":"8LACSA,MAAM,e,6DAAXC,EAAAA,EAAAA,IAEM,MAFNC,EAEM,EADFC,EAAAA,EAAAA,IAAUC,I,eCDlB,MAAMC,EAAS,CAAC,EAKVC,GAA2B,OAAgBD,EAAQ,CAAC,CAAC,SAASE,GAAQ,CAAC,YAAY,qBAEzF,O,qgBCgGA,MAAMC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAeD,EAAAA,EAAAA,KAAI,GACnBE,GAAkBF,EAAAA,EAAAA,KAAI,GACtBG,GAAaH,EAAAA,EAAAA,KAAI,GACjBI,GAAgBJ,EAAAA,EAAAA,KAAI,GACpBK,GAAmBL,EAAAA,EAAAA,IAAI,CAAC,GACxBM,GAAYN,EAAAA,EAAAA,IAAI,CAClBO,GAAI,GACJC,SAAU,GACVC,aAAc,GACdC,gBAAiB,GACjBC,iBAAkB,GAClBC,wBAAyB,GACzBC,YAAa,MAGjBC,EAAAA,EAAAA,KAAU,KACNC,GAAc,IAGlB,MAAMA,EAAeA,KACjBhB,EAAQiB,OAAQ,GAChBC,EAAAA,EAAAA,IAAe,CACXC,aAAa,IACdC,MAAKC,IACJd,EAAUU,MAAQI,EAAIC,MAAQ,CAAC,EAC/BhB,EAAiBW,OAAQM,EAAAA,EAAAA,IAAQhB,EAAUU,MAAM,IAClDO,SAAQ,KACPxB,EAAQiB,OAAQ,CAAK,GACvB,EAGAQ,EAAeA,KACjB,GAAIvB,EAAae,MACb,IAGI,GAFAb,EAAWa,OAAQ,EACnBV,EAAUU,MAAMP,aAAeH,EAAUU,MAAMP,aAAagB,QACvDnB,EAAUU,MAAMP,aACjB,KAAM,aAEViB,EAAAA,EAAAA,IAAe,CACXjB,aAAcH,EAAUU,MAAMP,eAC/BU,MAAK,KACJQ,EAAAA,GAAQC,QAAQ,OAChB3B,EAAae,OAASf,EAAae,MACnCX,EAAiBW,MAAMP,aAAeH,EAAUU,MAAMP,YAAY,IACnEc,SAAQ,KACPpB,EAAWa,OAAQ,CAAK,GAEhC,CAAE,MAAOa,GACL1B,EAAWa,OAAQ,EACnBW,EAAAA,GAAQG,MAAMD,EAClB,CACJ,EAGEE,EAAqBA,KACvB9B,EAAae,OAAQ,EACrBV,EAAUU,OAAQM,EAAAA,EAAAA,IAAQjB,EAAiBW,MAAM,EAG/CgB,EAAkBA,KACpB,GAAI9B,EAAgBc,MAChB,IAGI,GAFAZ,EAAcY,OAAQ,EACtBV,EAAUU,MAAMH,YAAcP,EAAUU,MAAMH,YAAYY,QACrDnB,EAAUU,MAAMH,YACjB,KAAM,YAEV,IAAKP,EAAUU,MAAMJ,wBACjB,KAAM,YAEVc,EAAAA,EAAAA,IAAe,CACXb,YAAaP,EAAUU,MAAMH,YAC7BD,wBAAyBN,EAAUU,MAAMJ,0BAC1CO,MAAK,KACJQ,EAAAA,GAAQC,QAAQ,OAChB1B,EAAgBc,OAASd,EAAgBc,MACzCX,EAAiBW,MAAMH,YAAcP,EAAUU,MAAMH,YACrDR,EAAiBW,MAAMJ,wBAA0BN,EAAUU,MAAMJ,uBAAuB,IACzFW,SAAQ,KACPnB,EAAcY,OAAQ,CAAK,GAEnC,CAAE,MAAOa,GACLzB,EAAcY,OAAQ,EACtBW,EAAAA,GAAQG,MAAMD,EAClB,CACJ,EAGEI,EAAwBA,KAC1B/B,EAAgBc,OAAQ,EACxBV,EAAUU,OAAQM,EAAAA,EAAAA,IAAQjB,EAAiBW,MAAM,E,o4HC9LrD,MAAMnB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://zmwk_session_archive/./src/components/loadingBox.vue","webpack://zmwk_session_archive/./src/components/loadingBox.vue?2acc","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue?829f"],"sourcesContent":["<template>\r\n    <div class=\"loading-box\">\r\n        <a-spin />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.loading-box {\r\n    position: absolute;\r\n    width: 48px;\r\n    height: 48px;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    text-align: center;\r\n}\r\n</style>\r\n","import { render } from \"./loadingBox.vue?vue&type=template&id=3d53ffb8&scoped=true\"\nconst script = {}\n\nimport \"./loadingBox.vue?vue&type=style&index=0&id=3d53ffb8&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3d53ffb8\"]])\n\nexport default __exports__","<template>\r\n    <MainLayout title=\"会话存档配置信息\">\r\n        <div class=\"zm-main-box\">\r\n            <LoadingBox v-if=\"loading\"/>\r\n            <a-form\r\n                v-else\r\n                :label-col=\"{ span: 6 }\"\r\n                :wrapper-col=\"{ span: 10 }\"\r\n                autocomplete=\"off\"\r\n            >\r\n                <div class=\"form-block\">\r\n                    <div class=\"form-block-item\">\r\n                        <div class=\"form-block-title\">基础信息</div>\r\n                        <div class=\"form-block-content\">\r\n                            <a-form-item label=\"企业ID\">\r\n                                <div class=\"c595959\">{{ formState.id }}</div>\r\n                            </a-form-item>\r\n                            <a-form-item label=\"自建应用ID\">\r\n                                <div class=\"c595959\">{{ formState.agent_id }}</div>\r\n                            </a-form-item>\r\n                            <template v-if=\"baseInfoEdit\">\r\n                                <a-form-item label=\"自建应用密钥\">\r\n                                    <a-input v-model:value=\"formState.agent_secret\" placeholder=\"请输入自建应用密钥\"/>\r\n                                </a-form-item>\r\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\r\n                                    <a-button class=\"mr8\" @click=\"editBaseInfoCancel\">取 消</a-button>\r\n                                    <a-button type=\"primary\" @click=\"editBaseInfo\" :loading=\"baseSaving\">保 存\r\n                                    </a-button>\r\n                                </a-form-item>\r\n                            </template>\r\n                            <template v-else>\r\n                                <a-form-item label=\"自建应用密钥\">\r\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.agent_secret) }}</div>\r\n                                </a-form-item>\r\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\r\n                                    <a-button type=\"primary\" @click=\"baseInfoEdit = true\">修 改</a-button>\r\n                                </a-form-item>\r\n                            </template>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"form-block-item\">\r\n                        <div class=\"form-block-title\">复制以下信息并填入到企业微信后台</div>\r\n                        <div class=\"form-block-content\">\r\n                            <a-form-item label=\"加密公钥\" class=\"label-height-unset\">\r\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_public_key)\">\r\n                                    <div><a>点击复制</a></div>\r\n                                    {{ maskStringByPercentage(formState.chat_public_key) }}\r\n                                </div>\r\n                            </a-form-item>\r\n                            <a-form-item label=\"加密私钥\" class=\"label-height-unset\">\r\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_private_key)\">\r\n                                    <div><a>点击复制</a></div>\r\n                                    {{ maskStringByPercentage(formState.chat_private_key, 80) }}\r\n                                </div>\r\n                            </a-form-item>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"form-block-item\">\r\n                        <div class=\"form-block-title\">将企业微信后台会话存档配置页面的信息复制粘贴到下框中</div>\r\n                        <div class=\"form-block-content\">\r\n                            <template v-if=\"sessionInfoEdit\">\r\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\r\n                                    <a-input v-model:value=\"formState.chat_secret\" placeholder=\"请输入会话存档密钥\"/>\r\n                                </a-form-item>\r\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\r\n                                    <a-input-number\r\n                                        style=\"width: 100%;\"\r\n                                        :precision=\"0\"\r\n                                        v-model:value=\"formState.chat_public_key_version\"\r\n                                        placeholder=\"请输入公钥版本号\"/>\r\n                                </a-form-item>\r\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\r\n                                    <a-button class=\"mr8\" @click=\"editSessionInfoCancel\">取 消</a-button>\r\n                                    <a-button type=\"primary\" @click=\"editSessionInfo\" :loading=\"sessionSaving\">保 存\r\n                                    </a-button>\r\n                                </a-form-item>\r\n                            </template>\r\n                            <template v-else>\r\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\r\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.chat_secret) }}</div>\r\n                                </a-form-item>\r\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\r\n                                    <div class=\"c595959\">{{ formState.chat_public_key_version }}</div>\r\n                                </a-form-item>\r\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\r\n                                    <a-button type=\"primary\" @click=\"sessionInfoEdit = true\">修 改</a-button>\r\n                                </a-form-item>\r\n                            </template>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </a-form>\r\n        </div>\r\n    </MainLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {onMounted, ref} from 'vue';\r\nimport {message} from 'ant-design-vue';\r\nimport MainLayout from \"@/components/mainLayout.vue\";\r\nimport {getCurrentCorp, setCurrentCorp} from \"@/api/auth-login\";\r\nimport {copyObj, copyText, maskStringByPercentage} from \"@/utils/tools\";\r\nimport LoadingBox from \"@/components/loadingBox.vue\";\r\n\r\nconst loading = ref(true)\r\nconst baseInfoEdit = ref(false)\r\nconst sessionInfoEdit = ref(false)\r\nconst baseSaving = ref(false)\r\nconst sessionSaving = ref(false)\r\nconst formStateDefault = ref({})\r\nconst formState = ref({\r\n    id: '',\r\n    agent_id: '',\r\n    agent_secret: '',\r\n    chat_public_key: '',\r\n    chat_private_key: '',\r\n    chat_public_key_version: '',\r\n    chat_secret: '',\r\n})\r\n\r\nonMounted(() => {\r\n    loadCorpInfo()\r\n})\r\n\r\nconst loadCorpInfo = () => {\r\n    loading.value = true\r\n    getCurrentCorp({\r\n        show_config: true\r\n    }).then(res => {\r\n        formState.value = res.data || {}\r\n        formStateDefault.value = copyObj(formState.value)\r\n    }).finally(() => {\r\n        loading.value = false\r\n    })\r\n}\r\n\r\nconst editBaseInfo = () => {\r\n    if (baseInfoEdit.value) {\r\n        try {\r\n            baseSaving.value = true\r\n            formState.value.agent_secret = formState.value.agent_secret.trim()\r\n            if (!formState.value.agent_secret) {\r\n                throw '请输入自建应用密钥'\r\n            }\r\n            setCurrentCorp({\r\n                agent_secret: formState.value.agent_secret,\r\n            }).then(() => {\r\n                message.success('已保存')\r\n                baseInfoEdit.value = !baseInfoEdit.value\r\n                formStateDefault.value.agent_secret = formState.value.agent_secret\r\n            }).finally(() => {\r\n                baseSaving.value = false\r\n            })\r\n        } catch (e) {\r\n            baseSaving.value = false\r\n            message.error(e)\r\n        }\r\n    }\r\n}\r\n\r\nconst editBaseInfoCancel = () => {\r\n    baseInfoEdit.value = false\r\n    formState.value = copyObj(formStateDefault.value)\r\n}\r\n\r\nconst editSessionInfo = () => {\r\n    if (sessionInfoEdit.value) {\r\n        try {\r\n            sessionSaving.value = true\r\n            formState.value.chat_secret = formState.value.chat_secret.trim()\r\n            if (!formState.value.chat_secret) {\r\n                throw '请输入会话存档密钥'\r\n            }\r\n            if (!formState.value.chat_public_key_version) {\r\n                throw '请输入公钥版本号'\r\n            }\r\n            setCurrentCorp({\r\n                chat_secret: formState.value.chat_secret,\r\n                chat_public_key_version: formState.value.chat_public_key_version\r\n            }).then(() => {\r\n                message.success('已保存')\r\n                sessionInfoEdit.value = !sessionInfoEdit.value\r\n                formStateDefault.value.chat_secret = formState.value.chat_secret\r\n                formStateDefault.value.chat_public_key_version = formState.value.chat_public_key_version\r\n            }).finally(() => {\r\n                sessionSaving.value = false\r\n            })\r\n        } catch (e) {\r\n            sessionSaving.value = false\r\n            message.error(e)\r\n        }\r\n    }\r\n}\r\n\r\nconst editSessionInfoCancel = () => {\r\n    sessionInfoEdit.value = false\r\n    formState.value = copyObj(formStateDefault.value)\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.zm-main-box {\r\n    background: #FFF;\r\n    padding-bottom: 40px;\r\n    min-height: calc(100vh - 120px);\r\n\r\n    :deep(.label-height-unset .ant-form-item-label >label ) {\r\n        height: unset;\r\n    }\r\n\r\n    .form-block {\r\n        .form-block-title {\r\n            color: #262626;\r\n            font-size: 14px;\r\n            font-weight: 600;\r\n            padding: 12px 24px;\r\n            border-bottom: 1px solid #F0F0F0;\r\n            margin-bottom: 16px;\r\n        }\r\n    }\r\n\r\n    .c595959 {\r\n        color: #595959;\r\n        word-break: break-all;\r\n    }\r\n}\r\n</style>\r\n","import script from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./authConfig.vue?vue&type=style&index=0&id=77c1c744&scoped=true&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-77c1c744\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_a_spin","script","__exports__","render","loading","ref","baseInfoEdit","sessionInfoEdit","baseSaving","sessionSaving","formStateDefault","formState","id","agent_id","agent_secret","chat_public_key","chat_private_key","chat_public_key_version","chat_secret","onMounted","loadCorpInfo","value","getCurrentCorp","show_config","then","res","data","copyObj","finally","editBaseInfo","trim","setCurrentCorp","message","success","e","error","editBaseInfoCancel","editSessionInfo","editSessionInfoCancel"],"sourceRoot":""}