"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[58],{8292:function(e,a,n){n.d(a,{A:function(){return d}});var i=n(56768);const t={class:"loading-box"};function l(e,a){const n=(0,i.g2)("a-spin");return(0,i.uX)(),(0,i.CE)("div",t,[(0,i.bF)(n)])}var o=n(71241);const _={},r=(0,o.A)(_,[["render",l],["__scopeId","data-v-3d53ffb8"]]);var d=r},87815:function(e,a,n){n.r(a),n.d(a,{default:function(){return F}});n(44114);var i=n(56768),t=n(90144),l=n(81387),o=n(43834),_=n(15374),r=n(7403),d=n(41824);const s={class:"main-content"},c={class:"mt24"},m={key:0,class:"mt4 zm-flex-center"},f={class:"text-center"};var u={__name:"corpBaseFrom",setup(e){const a=(0,l.rd)(),{proxy:n}=(0,i.nI)(),o=(0,t.KR)(!1),_=(0,t.KR)(!1),u=(0,t.KR)(!1),v=(0,t.Kh)({corp_id:"",agent_id:"",secret:"",verify_domain_file_name:"",verify_domain_file_content:""}),p=(0,t.Kh)({verify_domain_file_name:"",verify_domain_file_content:""}),b={corp_id:"请输入企业ID",agent_id:"请输入应用AgentId",secret:"请输入应用密钥",verify_domain_file_name:"请上传验证文件",verify_domain_file_content:"请上传验证文件"},y=()=>{if(v.verify_domain_file_name=v.verify_domain_file_name.trim(),v.verify_domain_file_content=v.verify_domain_file_content.trim(),!v.verify_domain_file_name)return n.$message.error("请输入文件名");const e=/^[\w,\s-]+\.txt$/;return e.test(v.verify_domain_file_name)?v.verify_domain_file_content?(p.verify_domain_file_name=v.verify_domain_file_name,p.verify_domain_file_content=v.verify_domain_file_content,u.value=!0,void(o.value=!1)):n.$message.error("请输入文件内容"):n.$message.error("请输入正确的txt文件名")},k=()=>{v.verify_domain_file_name=p.verify_domain_file_name,v.verify_domain_file_content=p.verify_domain_file_content,o.value=!1},g=()=>{try{_.value=!0;for(let a in v)if(v[a]=v[a].trim(),!v[a])throw b[a];let e=Number(v.agent_id);(0,d.C9)({...v,agent_id:e}).then((e=>{n.$message.success("保存完成，请登录！"),setTimeout((()=>{a.push({path:"/login"})}),1200)})).finally((()=>{_.value=!1}))}catch(e){_.value=!1,n.$message.error(e)}};return(e,a)=>{const n=(0,i.g2)("a-input"),l=(0,i.g2)("a-form-item"),d=(0,i.g2)("a-button"),p=(0,i.g2)("a-form"),b=(0,i.g2)("a-modal");return(0,i.uX)(),(0,i.CE)("div",s,[a[13]||(a[13]=(0,i.Lk)("div",{class:"title"},[(0,i.eW)("请先按照步骤完成自建应用的创建与配置并获取对应的信息填写到此处 "),(0,i.Lk)("a",{class:"ml16",href:"http://zhimahuihua.com/docs/integration/",target:"_blank"},"如何配置?")],-1)),(0,i.Lk)("div",c,[(0,i.bF)(p,{model:v,name:"basic","label-col":{span:6},"wrapper-col":{span:14},autocomplete:"off"},{default:(0,i.k6)((()=>[(0,i.bF)(l,{label:"企业ID",name:"corp_id"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{value:v.corp_id,"onUpdate:value":a[0]||(a[0]=e=>v.corp_id=e),placeholder:"请输入企业ID"},null,8,["value"])])),_:1}),(0,i.bF)(l,{label:"自建应用AgentId",name:"agent_id"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{value:v.agent_id,"onUpdate:value":a[1]||(a[1]=e=>v.agent_id=e),placeholder:"请输入应用AgentId"},null,8,["value"])])),_:1}),(0,i.bF)(l,{label:"自建应用密钥",name:"secret"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{value:v.secret,"onUpdate:value":a[2]||(a[2]=e=>v.secret=e),placeholder:"请输入应用密钥"},null,8,["value"])])),_:1}),(0,i.bF)(l,{label:"可信域名文件验证",name:"corp_id"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{type:"dashed",onClick:a[3]||(a[3]=e=>o.value=!0)},{default:(0,i.k6)((()=>a[7]||(a[7]=[(0,i.eW)("上传验证文件")]))),_:1}),u.value?((0,i.uX)(),(0,i.CE)("div",m,[a[8]||(a[8]=(0,i.eW)("已上传 ")),(0,i.bF)((0,t.R1)(r.A),{class:"ml4",style:{color:"#2EC77C"}})])):(0,i.Q3)("",!0),a[9]||(a[9]=(0,i.Lk)("div",{class:"zm-tip-info mt4"}," 配置自建应用网页授权及JS—SDK的可信域名需完成域名归属认证，验证文件上传成功后，请在企微后台添加可信域名。 ",-1))])),_:1}),(0,i.Lk)("div",f,[(0,i.bF)(d,{type:"primary",class:"main-btn",loading:_.value,onClick:g},{default:(0,i.k6)((()=>a[10]||(a[10]=[(0,i.eW)("确 认")]))),_:1},8,["loading"])])])),_:1},8,["model"])]),(0,i.bF)(b,{open:o.value,"onUpdate:open":a[6]||(a[6]=e=>o.value=e),onOk:y,onCancel:k,width:"600px"},{title:(0,i.k6)((()=>a[11]||(a[11]=[(0,i.eW)(" 上传验证文件"),(0,i.Lk)("span",{class:"zm-tip-info ml4"},"辅助信息",-1)]))),default:(0,i.k6)((()=>[(0,i.bF)(p,{model:v,name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off"},{default:(0,i.k6)((()=>[(0,i.bF)(l,{label:"文件名",name:"file_name"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{value:v.verify_domain_file_name,"onUpdate:value":a[4]||(a[4]=e=>v.verify_domain_file_name=e),placeholder:"请输入文件名"},null,8,["value"]),a[12]||(a[12]=(0,i.Lk)("div",{class:"zm-tip-info mt4"},"文件名WW_verify_开头，如：WW_verify_LSAreRXXX.txt（含文件后缀）",-1))])),_:1}),(0,i.bF)(l,{label:"文件内容",name:"corp_id"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{value:v.verify_domain_file_content,"onUpdate:value":a[5]||(a[5]=e=>v.verify_domain_file_content=e),placeholder:"请输入文件内容"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["open"])])}}},v=n(71241);const p=(0,v.A)(u,[["__scopeId","data-v-17117208"]]);var b=p,y=n(8292);const k={class:"_main-container"};var g={__name:"index",setup(e){const{proxy:a}=(0,i.nI)(),n=(0,l.rd)(),r=(0,t.KR)(!0);return(0,i.sV)((()=>{(0,d.hY)().then((e=>{e?.data?.init&&(a.$message.success("已有企业，去登陆"),setTimeout((()=>{n.push({path:"/login"})}),1e3)),r.value=!1})).catch((()=>{r.value=!1}))})),(e,a)=>((0,i.uX)(),(0,i.CE)("div",k,[(0,i.bF)(o.A),r.value?((0,i.uX)(),(0,i.Wv)(y.A,{key:0})):((0,i.uX)(),(0,i.Wv)(b,{key:1})),(0,i.bF)(_.A)]))}};const h=(0,v.A)(g,[["__scopeId","data-v-63d13fcb"]]);var F=h}}]);