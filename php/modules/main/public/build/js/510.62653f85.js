"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[510],{69448:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44114),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vue__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(56768),vue__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(24232),vue__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(90144),_assets_default_avatar_png__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17767),ant_design_vue__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(17694),dayjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1576),dayjs__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(dayjs__WEBPACK_IMPORTED_MODULE_2__),vue_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(81387),_statistic_vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(76504),_components_select_staff_new_index__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(87606),_api_sensitive__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(67644),_api_company__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(17875);const _hoisted_1={class:"zm-main-content"},_hoisted_2={class:"statistic-box"},_hoisted_3={class:"detail-header mt16"},_hoisted_4={class:"trigger-personnel"},_hoisted_5={class:"inline-block ml-8 mr-24 mb-8"},_hoisted_6={class:"inline-block"},_hoisted_7={key:0,class:"msg-type-box"},_hoisted_8={class:"zm-line-clamp2",style:{"max-height":"40px"}},_hoisted_9={key:1,class:"msg-type-box"},_hoisted_10={class:"zm-line-clamp2",style:{"max-height":"40px"}},_hoisted_11={key:0,class:"user-box"},_hoisted_12=["src"],_hoisted_13={class:"user-name"},_hoisted_14={key:1,class:"user-box"},_hoisted_15={class:"user-name"},_hoisted_16={key:2,class:"user-box"},_hoisted_17={class:"user-name"},_hoisted_18={key:3,class:"msg-type-box"},_hoisted_19={class:"zm-line-clamp2",style:{"max-height":"40px"}},_hoisted_20={key:0,class:"msg-type-box"},_hoisted_21={class:"zm-line-clamp2",style:{"max-height":"40px"}},_hoisted_22={key:1,class:"msg-type-box"},_hoisted_23={key:5,class:"msg-type-box"},_hoisted_24=["innerHTML"],_hoisted_25=["onClick"];__webpack_exports__.A={__name:"detail",setup(__props){const router=(0,vue_router__WEBPACK_IMPORTED_MODULE_7__.rd)(),route=(0,vue_router__WEBPACK_IMPORTED_MODULE_7__.lq)(),selectList=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([]),columns=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([{dataIndex:"from_user_info",title:"触发人员",width:200},{dataIndex:"msg_time",title:"触发时间",width:120},{dataIndex:"hint_type",title:"类型",width:120},{dataIndex:"target_msg_type",title:"触发条件",width:120},{dataIndex:"msg_content",title:"消息内容",width:222},{dataIndex:"conversation_type",title:"触发场景",width:120},{dataIndex:"group_info",title:"群聊名称",width:120},{title:"操作",dataIndex:"operate",width:88,fixed:"right"}]),rule_list=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([]),hint_type_list=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([{label:"敏感词",value:"1"},{label:"敏感行为",value:"2"}]),sensitive_behavior=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(["link","weapp","card","qr_code","link_text"]),target_msg_type_list=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([{label:"发送敏感词",value:"text"},{label:"发送链接",value:"link"},{label:"发送小程序",value:"weapp"},{label:"发送名片",value:"card"},{label:"发送二维码图片",value:"qr_code"},{label:"发送包含链接的文本",value:"link_text"}]),dateList=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([{label:"全部",value:"all"},{label:"今",value:"today"},{label:"昨",value:"yesterday"},{label:"自定义",value:"custom"}]),form=(0,vue__WEBPACK_IMPORTED_MODULE_8__.Kh)({dateTab:"all",search_type:1}),loading=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(!1),list=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([]),pagination=(0,vue__WEBPACK_IMPORTED_MODULE_8__.Kh)({total:0,current:1,pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}),filterData=(0,vue__WEBPACK_IMPORTED_MODULE_8__.Kh)({hint_type:void 0,target_msg_type:void 0,keyword:"",staff_userid:[],external_username:"",rule_id:void 0,dates:[]}),selectedStaff=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([]),setStaff=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(null),staffChange=e=>{let _=[];selectedStaff.value.map((t=>{e.map((e=>{t.userid===e&&_.push(t)}))})),selectedStaff.value=_,filterData.staff_userid=_.map((e=>e.userid)),searchData()},dropdownVisibleChange=()=>{getStaffList(),setStaff.value.show(selectedStaff.value)},staffUpdate=e=>{e&&(selectedStaff.value=e,filterData.staff_userid=e.map((e=>e.userid)),searchData())},searchData=()=>{list.value=[],pagination.current=1,pagination.total=0,loadData()},onTriggerType=()=>{1==filterData.hint_type?filterData.target_msg_type="text":2==filterData.hint_type?filterData.target_msg_type="link":filterData.target_msg_type=void 0,searchData()},disabledDate=e=>e&&e>dayjs__WEBPACK_IMPORTED_MODULE_2___default()().endOf("day"),filterDateChange=()=>{if(filterData.dates&&filterData.dates.length>0){let e=filterData.dates[1]-filterData.dates[0];e/864e5>30&&(filterData.dates=[],ant_design_vue__WEBPACK_IMPORTED_MODULE_9__.Ay.warning("发送时间跨度不得超过30天"))}searchData()};function formatMsgType(e){let _="";return"text"===e?_="发送敏感词":"link"===e?_="发送链接":"weapp"===e?_="发送小程序":"card"===e?_="发送名片":"link_text"===e?_="发送包含链接的文本":"qr_code"===e&&(_="发送二维码图片"),_}function formatHintType(e){let _="";return"1"==e?_="敏感词":"2"==e&&(_="敏感行为"),_}function formatConversationType(e){let _="";return"1"==e?_="单聊":"2"==e?_="群聊":"3"==e&&(_="同事会话"),_}const loadData=async()=>{loading.value=!0;let e={page:pagination.current,size:pagination.pageSize};filterData.hint_type?e.hint_type=filterData.hint_type:e.hint_type="",filterData.target_msg_type?e.target_msg_type=filterData.target_msg_type:e.target_msg_type="",filterData.keyword=filterData.keyword.trim(),filterData.keyword&&(e.keyword=filterData.keyword),filterData.staff_userid?e.staff_userid=filterData.staff_userid[0]:e.staff_userid="",filterData.external_username?e.external_username=filterData.external_username:e.external_username="",filterData.rule_id?e.rule_id=filterData.rule_id:e.rule_id="",filterData.dates&&filterData.dates.length&&(e.start_time=dayjs__WEBPACK_IMPORTED_MODULE_2___default()(filterData.dates[0]).format("YYYY-MM-DD 00:00:00"),e.end_time=dayjs__WEBPACK_IMPORTED_MODULE_2___default()(filterData.dates[1]).format("YYYY-MM-DD 23:59:59")),await(0,_api_sensitive__WEBPACK_IMPORTED_MODULE_5__.Kl)(e).then((e=>{list.value=e.data.items||[],pagination.total=Number(e.data?.total)})).finally((()=>{loading.value=!1})).catch((e=>{}))},edit=e=>{let _={};e.group_info?_.group_chat_id=e.group_info.chat_id:(_.conversation_id=e.conversation_id,_.sender=e.from_user_id,_.receiver=e.to_user_id||"",_.sender_type=e.from_role,_.receiver_type=e.to_role,_.conversation_type=e.conversation_type);let t=router.resolve({path:"/sessionArchive/index",query:_}).href;window.open(t)},resetData=()=>{pagination.current=1,list.value=[],filterData.hint_type=void 0,filterData.target_msg_type=void 0,filterData.keyword="",filterData.staff_userid=[],filterData.external_username="",filterData.rule_id=void 0,filterData.dates=[],loadData()},changeTab=()=>{switch(form.dateTab){case"all":filterData.dates=[];break;case"today":filterData.dates=[dayjs__WEBPACK_IMPORTED_MODULE_2___default()().startOf("day").format("YYYY-MM-DD"),dayjs__WEBPACK_IMPORTED_MODULE_2___default()().endOf("day").format("YYYY-MM-DD")];break;case"yesterday":filterData.dates=[dayjs__WEBPACK_IMPORTED_MODULE_2___default()().subtract(1,"day").startOf("day").format("YYYY-MM-DD"),dayjs__WEBPACK_IMPORTED_MODULE_2___default()().subtract(1,"day").endOf("day").format("YYYY-MM-DD")];break;default:break}return"custom"!==form.dateTab&&searchData()},tableChange=e=>{pagination.current=e.current,pagination.pageSize=e.pageSize,loadData()},staffListData=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)([]),getStaffList=async()=>{try{let e=await(0,_api_company__WEBPACK_IMPORTED_MODULE_6__.Xj)({page:1,size:999});if("success"!==e.status)return;staffListData.value=e.data.items,selectList.value=staffListData.value.map((e=>({_id:e.userid,...e})))}catch(e){}},getRuleList=async()=>{loading.value=!0;let e={page:1,size:1e3};await(0,_api_sensitive__WEBPACK_IMPORTED_MODULE_5__.z8)(e).then((e=>{rule_list.value=e.data.items||[]})).finally((()=>{}))},init=async()=>{await loadData()},forMatText=(str,keyWord)=>{var substr="/"+keyWord+"/g",replaceStr=str.replace(eval(substr),"<span style='color: #fb363f;'>"+keyWord+"</span>");return replaceStr};return(0,vue__WEBPACK_IMPORTED_MODULE_10__.sV)((async()=>{route.query.rule_id&&(filterData.rule_id=parseInt(route.query.rule_id)),route.query.date_type&&(1==route.query.date_type?(form.dateTab="today",changeTab()):2==route.query.date_type?(form.dateTab="yesterday",changeTab()):(form.dateTab="all",changeTab())),await getRuleList(),route.query.date_type||await init()})),(e,_)=>{const t=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-alert"),a=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-select-option"),l=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-select"),s=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-form-item"),i=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-col"),u=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-input"),n=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-row"),o=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-radio-button"),d=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-radio-group"),r=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-range-picker"),c=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-button"),v=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-form"),E=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-tooltip"),D=(0,vue__WEBPACK_IMPORTED_MODULE_10__.g2)("a-table");return(0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_1,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(t,{"show-icon":"",message:"设置的敏感词和敏感行为被触发后,可在列表中查看对应的触发记录以及会话记录"}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_2,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(_statistic_vue__WEBPACK_IMPORTED_MODULE_3__.A)]),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_3,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(v,{model:form,name:"basic",autocomplete:"off"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(n,{type:"flex",justify:"space-around",align:"middle"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:6,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"敏感词规则"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(l,{placeholder:"全部",value:filterData.rule_id,"onUpdate:value":_[0]||(_[0]=e=>filterData.rule_id=e),getPopupContainer:e=>e.parentNode,onChange:searchData,allowClear:""},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_10__.pI)(rule_list.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{key:e.id,value:e.id},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)((0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(e.rule_name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","getPopupContainer"])])),_:1})])),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:6,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"触发类型"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(l,{placeholder:"全部",value:filterData.hint_type,"onUpdate:value":_[1]||(_[1]=e=>filterData.hint_type=e),getPopupContainer:e=>e.parentNode,onChange:onTriggerType,allowClear:""},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_10__.pI)(hint_type_list.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{key:e.value,value:e.value},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)((0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","getPopupContainer"])])),_:1})])),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:6,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"触发条件"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(l,{placeholder:"全部",value:filterData.target_msg_type,"onUpdate:value":_[2]||(_[2]=e=>filterData.target_msg_type=e),getPopupContainer:e=>e.parentNode,onChange:searchData,allowClear:""},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_10__.pI)(target_msg_type_list.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{disabled:sensitive_behavior.value.includes(e.value)&&1==filterData.hint_type||"text"==e.value&&2==filterData.hint_type,key:e.value,value:e.value},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)((0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(e.label),1)])),_:2},1032,["disabled","value"])))),128))])),_:1},8,["value","getPopupContainer"])])),_:1})])),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:6,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"消息内容"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(u,{value:filterData.keyword,"onUpdate:value":_[3]||(_[3]=e=>filterData.keyword=e),allowClear:"",placeholder:"请输入消息内容搜索"},null,8,["value"])])),_:1})])),_:1})])),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(n,{type:"flex",justify:"space-around",align:"middle"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:7,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"触发人员"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_4,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(l,{class:"default-label",value:form.search_type,"onUpdate:value":_[4]||(_[4]=e=>form.search_type=e)},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{key:1,value:1},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>_[10]||(_[10]=[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)("员工")]))),_:1})),((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{key:2,value:2},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>_[11]||(_[11]=[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)("客户")]))),_:1}))])),_:1},8,["value"]),1===form.search_type?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(l,{key:0,class:"default-input",mode:"multiple",size:"default",placeholder:"请选择员工",value:filterData.staff_userid,"onUpdate:value":_[5]||(_[5]=e=>filterData.staff_userid=e),open:!1,onChange:staffChange,onDropdownVisibleChange:dropdownVisibleChange},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_10__.pI)(selectList.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(a,{key:e._id,label:e.name},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)((0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["value"])):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0),2===form.search_type?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(u,{key:1,value:filterData.external_username,"onUpdate:value":_[6]||(_[6]=e=>filterData.external_username=e),allowClear:"",class:"default-input",placeholder:"请输入客户昵称搜索"},null,8,["value"])):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0)])])),_:1})])),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(i,{span:17,style:{"padding-right":"24px"}},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(s,{label:"触发时间"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(d,{value:form.dateTab,"onUpdate:value":_[7]||(_[7]=e=>form.dateTab=e),onChange:changeTab},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_10__.pI)(dateList.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Wv)(o,{value:e.value,key:e.value},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)((0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"]),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_5,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(r,{value:filterData.dates,"onUpdate:value":_[8]||(_[8]=e=>filterData.dates=e),"value-format":"YYYY-MM-DD",class:"w-256",onChange:filterDateChange,"disabled-date":disabledDate},null,8,["value"])]),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_6,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(c,{onClick:searchData,type:"primary"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>_[12]||(_[12]=[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)("搜索")]))),_:1}),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(c,{onClick:resetData,class:"ml8"},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>_[13]||(_[13]=[(0,vue__WEBPACK_IMPORTED_MODULE_10__.eW)("重置")]))),_:1})])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])]),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(D,{class:"mt16 detail-table",loading:loading.value,"data-source":list.value,columns:columns.value,scroll:{x:1500},pagination:pagination,onChange:tableChange},{bodyCell:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((({column:e,text:t,record:a})=>["target_msg_type"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_7,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(E,{title:formatMsgType(t)},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_8,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(formatMsgType(t)),1)])),_:2},1032,["title"])])):"hint_type"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_9,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_10,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(formatHintType(t)),1)])):"from_user_info"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,{key:2},[1==a.from_role?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_11,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("img",{src:t.avatar,class:"avatar"},null,8,_hoisted_12),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_13,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(t.external_name||"-"),1),_[14]||(_[14]=(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",{class:"user-type employee"},"客户",-1))])):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0),2==a.from_role?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_14,[_[15]||(_[15]=(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("img",{src:_assets_default_avatar_png__WEBPACK_IMPORTED_MODULE_1__,class:"avatar"},null,-1)),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_15,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(t.name||"-"),1),_[16]||(_[16]=(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",{class:"user-type client"},"员工",-1))])):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0),3==a.from_role?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_16,[_[17]||(_[17]=(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("img",{src:_assets_default_avatar_png__WEBPACK_IMPORTED_MODULE_1__,class:"avatar"},null,-1)),(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_17,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(t.name||"-"),1),_[18]||(_[18]=(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",{class:"user-type group"},"群成员",-1))])):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0)],64)):"conversation_type"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_18,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_19,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(formatConversationType(t)),1)])):"group_info"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)(vue__WEBPACK_IMPORTED_MODULE_10__.FK,{key:4},[t?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_20,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",_hoisted_21,(0,vue__WEBPACK_IMPORTED_MODULE_11__.v_)(t.name||"-"),1)])):((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_22,_[19]||(_[19]=[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",{class:"zm-line-clamp2",style:{"max-height":"40px"}},"-",-1)])))],64)):"msg_content"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("div",_hoisted_23,[(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)(E,{overlayClassName:"msg-content-tip",title:t},{default:(0,vue__WEBPACK_IMPORTED_MODULE_10__.k6)((()=>[(0,vue__WEBPACK_IMPORTED_MODULE_10__.Lk)("div",{class:"nodestr",innerHTML:forMatText(t,a.hint_keyword)},null,8,_hoisted_24)])),_:2},1032,["title"])])):"operate"===e.dataIndex?((0,vue__WEBPACK_IMPORTED_MODULE_10__.uX)(),(0,vue__WEBPACK_IMPORTED_MODULE_10__.CE)("a",{key:6,class:"operate-content",onClick:e=>edit(a)},"聊天明细",8,_hoisted_25)):(0,vue__WEBPACK_IMPORTED_MODULE_10__.Q3)("",!0)])),_:1},8,["loading","data-source","columns","pagination"]),(0,vue__WEBPACK_IMPORTED_MODULE_10__.bF)((0,vue__WEBPACK_IMPORTED_MODULE_8__.R1)(_components_select_staff_new_index__WEBPACK_IMPORTED_MODULE_4__.A),{selectType:"single",ref_key:"setStaff",ref:setStaff,onChange:_[9]||(_[9]=e=>staffUpdate(e))},null,512)])}}}},67644:function(e,_,t){t.d(_,{GC:function(){return u},KP:function(){return E},Kl:function(){return i},OC:function(){return s},R8:function(){return v},eu:function(){return o},ir:function(){return l},kL:function(){return D},pY:function(){return n},vO:function(){return r},z8:function(){return c},zQ:function(){return d}});var a=t(7277);const l=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/delete",e),s=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/rule/delete",e),i=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/rule/detail",{params:e}),u=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/rule/statistics",{params:e}),n=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/notice/info",{params:e}),o=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/notice/save",e),d=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/rule/change/status",e),r=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/rule/info",{params:e}),c=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/rule/list",{params:e}),v=e=>a.Ay.get("/modules/hint_keywords/api/hint/keywords/list",{params:e}),E=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/rule/save",e),D=e=>a.Ay.post("/modules/hint_keywords/api/hint/keywords/save",e)},15103:function(e,_,t){t.d(_,{A:function(){return D}});var a=t(56768),l=t(24232),s=t(90144),i=t(63536),u=t(87606),n=t(17767);const o={key:0,style:{display:"flex","flex-wrap":"wrap"}},d={key:0,class:"fx-ac",style:{flex:"1"}},r={key:0,class:"fx-ac",style:{flex:"1"}};var c={__name:"select-staff-box-normal",props:{title:{type:String,default:"选择员工"},btnText:{type:String,default:"添加员工"},btnType:{type:String,default:"dashed"},btnStyle:{type:String,default:"margin-right: 16px;"},showSelectStaff:{type:Boolean,default:!0},showClearSelectStaff:{type:Boolean,default:!1},selectType:{default:"multiple"},showStaffApproveTip:{default:!1},selectedStaffs:{type:Array,default(){return[]}},isTag:{type:Boolean,default:!0},showSeatTip:{type:Boolean,default:!1},maxShowWidth:{}},emits:"change",setup(e,{emit:_}){const t=_,c=e,v=(0,s.KR)(null),E=(0,a.EW)((()=>c.selectedStaffs)),D=e=>{E.value=e,t("change",e||[])},p=e=>{E.value.splice(e,1),t("change",E.value)},M=()=>{c.showClearSelectStaff?v.value.show([]):v.value.show(E.value)};return(0,a.sV)((()=>{})),(_,t)=>{const c=(0,a.g2)("a-button"),O=(0,a.g2)("a-avatar"),P=(0,a.g2)("a-tooltip"),f=(0,a.g2)("a-tag");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(c,{type:e.btnType,style:(0,l.Tr)(e.btnStyle),onClick:M},{default:(0,a.k6)((()=>[(0,a.bF)((0,s.R1)(i.A)),(0,a.eW)(" "+(0,l.v_)(e.btnText),1)])),_:1},8,["type","style"]),e.showSelectStaff?((0,a.uX)(),(0,a.CE)("div",o,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,((_,t)=>((0,a.uX)(),(0,a.Wv)(f,{key:_.userid,closable:"",onClose:e=>p(t),style:{"margin-top":"6px"},class:(0,l.C4)(["fx-ac tag",{"red-tip":e.showSeatTip&&!_.is_bind_license}])},{default:(0,a.k6)((()=>[(0,a.bF)(P,null,{default:(0,a.k6)((()=>[e.showSeatTip?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bF)(O,{size:20,src:(0,s.R1)(n),style:{"margin-right":"4px"}},null,8,["src"]),(0,a.Lk)("span",null,(0,l.v_)(_.name),1)])):(0,a.Q3)("",!0)])),_:2},1024),e.showSeatTip?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(O,{size:20,src:(0,s.R1)(n),style:{"margin-right":"4px"}},null,8,["src"]),(0,a.Lk)("span",null,(0,l.v_)(_.name),1)]))])),_:2},1032,["onClose","class"])))),128))])):(0,a.Q3)("",!0),(0,a.bF)((0,s.R1)(u.A),{selectType:"multiple",ref_key:"setStaff",ref:v,onChange:t[0]||(t[0]=e=>D(e))},null,512)])}}},v=t(71241);const E=(0,v.A)(c,[["__scopeId","data-v-123a009c"]]);var D=E},8292:function(e,_,t){t.d(_,{A:function(){return o}});var a=t(56768);const l={class:"loading-box"};function s(e,_){const t=(0,a.g2)("a-spin");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(t)])}var i=t(71241);const u={},n=(0,i.A)(u,[["render",s],["__scopeId","data-v-3d53ffb8"]]);var o=n},76504:function(e,_,t){t.d(_,{A:function(){return w}});var a=t(56768),l=t(24232),s=t.p+"img/statistic-client.a7265cda.png",i=t.p+"img/statistic-employee.c79ba29a.png",u=t(90144),n=t(67644);const o={class:"statistic-box"},d={class:"statistic-item"},r={class:"statistic-content-box"},c={class:"statistic-content-item"},v={class:"statistic-content-item-info"},E={class:"statistic-content-item-info-num"},D={class:"statistic-content-item-info"},p={class:"statistic-content-item-info-num"},M={class:"statistic-content-item"},O={class:"statistic-content-item-info"},P={class:"statistic-content-item-info-num"},f={class:"statistic-content-item-info"},k={class:"statistic-content-item-info-num"},h={class:"statistic-item"},y={class:"statistic-content-box"},L={class:"statistic-content-item"},m={class:"statistic-content-item-info"},C={class:"statistic-content-item-info-num"},g={class:"statistic-content-item-info"},A={class:"statistic-content-item-info-num"},I={class:"statistic-content-item"},K={class:"statistic-content-item-info"},R={class:"statistic-content-item-info-num"},W={class:"statistic-content-item-info"},T={class:"statistic-content-item-info-num"};var b={__name:"statistic",setup(e){const _=(0,u.KR)(!1),t=(0,u.KR)({totalData:{statistic_staff_keywords:0,statistic_staff_msg:0,statistic_cst_keywords:0,statistic_cst_msg:0},dayTotalData:{statistic_staff_keywords:0,statistic_staff_msg:0,statistic_cst_keywords:0,statistic_cst_msg:0}}),b=()=>{_.value=!0;let e={};(0,n.GC)(e).then((e=>{t.value=e.data})).finally((()=>{_.value=!1}))};return(0,a.sV)((()=>{b()})),(e,_)=>((0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",d,[_[6]||(_[6]=(0,a.Lk)("div",{class:"statistic-item-title"},"今日数据",-1)),(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[_[2]||(_[2]=(0,a.Lk)("img",{class:"statistic-content-item-icon",src:s},null,-1)),(0,a.Lk)("div",v,[(0,a.Lk)("div",E,(0,l.v_)(t.value.dayTotalData.statistic_staff_keywords),1),_[0]||(_[0]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感词",-1))]),(0,a.Lk)("div",D,[(0,a.Lk)("div",p,(0,l.v_)(t.value.dayTotalData.statistic_staff_msg),1),_[1]||(_[1]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感行为",-1))])]),(0,a.Lk)("div",M,[_[5]||(_[5]=(0,a.Lk)("img",{class:"statistic-content-item-icon",src:i},null,-1)),(0,a.Lk)("div",O,[(0,a.Lk)("div",P,(0,l.v_)(t.value.dayTotalData.statistic_cst_keywords),1),_[3]||(_[3]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感词",-1))]),(0,a.Lk)("div",f,[(0,a.Lk)("div",k,(0,l.v_)(t.value.dayTotalData.statistic_cst_msg),1),_[4]||(_[4]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感行为",-1))])])])]),(0,a.Lk)("div",h,[_[13]||(_[13]=(0,a.Lk)("div",{class:"statistic-item-title"},"累计数据",-1)),(0,a.Lk)("div",y,[(0,a.Lk)("div",L,[_[9]||(_[9]=(0,a.Lk)("img",{class:"statistic-content-item-icon",src:s},null,-1)),(0,a.Lk)("div",m,[(0,a.Lk)("div",C,(0,l.v_)(t.value.totalData.statistic_staff_keywords),1),_[7]||(_[7]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感词",-1))]),(0,a.Lk)("div",g,[(0,a.Lk)("div",A,(0,l.v_)(t.value.totalData.statistic_staff_msg),1),_[8]||(_[8]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感行为",-1))])]),(0,a.Lk)("div",I,[_[12]||(_[12]=(0,a.Lk)("img",{class:"statistic-content-item-icon",src:i},null,-1)),(0,a.Lk)("div",K,[(0,a.Lk)("div",R,(0,l.v_)(t.value.totalData.statistic_cst_keywords),1),_[10]||(_[10]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感词",-1))]),(0,a.Lk)("div",W,[(0,a.Lk)("div",T,(0,l.v_)(t.value.totalData.statistic_cst_msg),1),_[11]||(_[11]=(0,a.Lk)("div",{class:"statistic-content-item-info-label"},"敏感行为",-1))])])])])]))}},U=t(71241);const B=(0,U.A)(b,[["__scopeId","data-v-2d9622de"]]);var w=B},22663:function(e,_,t){t.r(_),t.d(_,{default:function(){return ge}});var a=t(56768),l=t(90144),s=t(81387),i=t(8292),u=(t(44114),t(24232)),n=t(63536),o=t(51644),d=t(87606),r=t(15103),c=t(17694),v=t(67644);const E={class:"remind"},D={class:"fx-ac item"},p={class:"right"},M={class:"fx-ac item align-start"},O={class:"right"},P={class:"checkbox-item"},f={key:0,class:"notify-block pt8"},k={key:0,class:"mt8"},h={class:"checkbox-item"},y={key:0,class:"notify-block"},L={class:"fx-ac item align-baseline"},m={class:"right"},C={class:"fx-ac item align-baseline"},g={class:"right"},A={class:"checkbox-item"},I={key:0,class:"notify-block"},K={class:"fx-ac item"},R={class:"right"},W={class:"fx-ac item align-baseline"},T={class:"right"},b={class:"fx-ac item align-baseline"},U={class:"right"},B={class:"mt8"},w={class:"mt8 phone-box"};var x={__name:"remind",emits:"update",setup(e,{expose:_,emit:t}){const s=t,i=(0,l.KR)(!1),x=(0,l.KR)(!1),F=(0,l.KR)(""),X=(0,l.KR)(!1),S=(0,l.KR)([]),z=(0,l.KR)(!1),q=(0,l.KR)([]),Y=(0,l.KR)(0),j=(0,l.KR)(""),Q=(0,l.KR)([]),N=(0,l.KR)(0),H=(0,l.KR)(""),V=(0,l.KR)(""),Z=(0,l.KR)([]),G=(0,l.KR)(null),J=(0,l.KR)(!1),$=(0,l.KR)(""),ee=(0,l.KR)(""),_e=(0,l.KR)(""),te=(0,l.KR)(void 0),ae=()=>{i.value=!0},le=()=>{G.value.show(S.value)},se=(e,_)=>{const t=new Map,a=[];return e.forEach((e=>t.set(e.userid,e))),_.forEach((e=>{const _=t.get(e);_&&a.push(_)})),a},ie=async()=>{try{let e=await(0,v.pY)();if("success"!==e.status)return;let _=e.data||{};if(te.value=_.id,z.value=1==_.notice_switch,Y.value=Number(_.wechat_notice_type||0),N.value=Number(_.dingtalk_notice_type||0),_.app_notice_switch&&q.value.push(1),_.wechat_notice_switch&&q.value.push(2),_.dingtalk_notice_switch&&q.value.push(3),q.value.includes(1)&&_.app_notice_userid.length&&_.staff_user_info.length){let e=se(_.staff_user_info,_.app_notice_userid);S.value=e}if(q.value.includes(2)&&(j.value=_.wechat_notice_hook||"",_.wechat_notice_user.length&&_.staff_user_info.length)){let e=se(_.staff_user_info,_.wechat_notice_user);Q.value=e}q.value.includes(3)&&(H.value=_.dingtalk_notice_hook||"",V.value=_.dingtalk_notice_secret||"",Z.value=_.dingtalk_notice_user),_e.value=e.data.id||""}catch(e){}},ue=async()=>{try{let e={id:te.value,notice_switch:Number(z.value)};if(z.value&&!q.value.length)throw"请选择至少一种推送方式";if(z.value&&q.value.includes(1)){if(!S.value||0===S.value.length)throw"请选择接收通知管理员";let _=S.value.map((e=>e.userid));e.app_notice_switch=1,e.app_notice_userid=_}if(q.value.includes(2)){if(j.value=j.value.trim(),z.value&&""==j.value)throw"请输入企微Webhook地址";if(z.value&&2==Y.value&&Q.value.length<1)throw"请选择指定企微群成员";e.wechat_notice_switch=1,e.wechat_notice_type=Y.value,e.wechat_notice_hook=j.value,e.wechat_notice_user=Q.value.map((e=>e.userid))}if(q.value.includes(3)){if(H.value=H.value.trim(),V.value=V.value.trim(),z.value&&""==H.value)throw"请输入钉钉群Webhook地址";if(z.value&&""==V.value)throw"请输入钉钉群加签secret";if(z.value&&2==N.value&&Z.value.length<1)throw"请选择指定钉钉群成员";e.dingtalk_notice_switch=1,e.dingtalk_notice_hook=H.value,e.dingtalk_notice_type=N.value,e.dingtalk_notice_secret=V.value,e.dingtalk_notice_user=Z.value}switch(J.value){case 1:if(z.value&&""===$.value)throw"请输入限制时间";e.msg_send_frequency=$.value;break;case 2:if(z.value&&""===ee.value)throw"请输入限制时间";e.msg_send_frequency=ee.value;break}_e.value&&(e.id=_e.value);await(0,v.eu)(e);c.Ay.success("已保存"),s("update",{notice_switch:z.value}),await ie(),i.value=!1}catch(e){"string"===typeof e&&c.Ay.error(e)}},ne=e=>{S.value=e},oe=e=>{S.value.splice(e,1)},de=()=>{F.value="",x.value=!0},re=()=>{F.value=F.value.replace(/，/g,",")},ce=()=>{if(F.value=F.value.trim(),""==F.value)return c.Ay.error("请输入群成员手机号");let e=F.value.split(",");for(let _ of e)Z.value.includes(_)||Z.value.push(_);F.value="",x.value=!1},ve=(e,_)=>{e.preventDefault(),Z.value.splice(_,1)},Ee=e=>{Q.value=e};return(0,a.sV)((()=>{ie()})),_({show:ae}),(e,_)=>{const t=(0,a.g2)("a-alert"),s=(0,a.g2)("a-switch"),c=(0,a.g2)("a-tooltip"),v=(0,a.g2)("a-checkbox"),J=(0,a.g2)("a-button"),$=(0,a.g2)("a-tag"),ee=(0,a.g2)("a-input"),_e=(0,a.g2)("a-radio"),te=(0,a.g2)("a-radio-group"),ae=(0,a.g2)("a-checkbox-group"),se=(0,a.g2)("a-modal");return(0,a.uX)(),(0,a.CE)("div",E,[(0,a.bF)(se,{width:800,title:"提醒设置",open:i.value,"onUpdate:open":_[7]||(_[7]=e=>i.value=e),closable:!1,confirmLoading:X.value,onCancel:_[8]||(_[8]=e=>i.value=!1),onOk:ue},{default:(0,a.k6)((()=>[(0,a.bF)(t,{type:"info","show-icon":"",message:"开启后，可选择设置应用通知、企微群通知、钉钉群通知"}),(0,a.Lk)("div",D,[_[12]||(_[12]=(0,a.Lk)("span",{class:"property"},"当前状态：",-1)),(0,a.Lk)("div",p,[(0,a.bF)(s,{checked:z.value,"onUpdate:checked":_[0]||(_[0]=e=>z.value=e),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])])]),(0,a.Lk)("div",M,[_[33]||(_[33]=(0,a.Lk)("span",{class:"property"},"推送方式：",-1)),(0,a.Lk)("div",O,[(0,a.bF)(ae,{value:q.value,"onUpdate:value":_[6]||(_[6]=e=>q.value=e)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",P,[(0,a.bF)(v,{value:1},{default:(0,a.k6)((()=>[_[13]||(_[13]=(0,a.eW)("应用推送 ")),(0,a.bF)(c,{title:"将通过接入的自建应用推送消息"},{default:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(o.A))])),_:1})])),_:1}),q.value.includes(1)?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(J,{class:"add",type:"dashed",onClick:le},{default:(0,a.k6)((()=>_[14]||(_[14]=[(0,a.eW)("选择员工")]))),_:1}),S.value.length>0?((0,a.uX)(),(0,a.CE)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(S.value,((e,_)=>((0,a.uX)(),(0,a.Wv)($,{class:"zm-customize-tag",closable:"",onClose:e=>oe(_),key:_},{default:(0,a.k6)((()=>[(0,a.eW)((0,u.v_)(e.name),1)])),_:2},1032,["onClose"])))),128))])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",h,[(0,a.bF)(v,{value:2},{default:(0,a.k6)((()=>[_[15]||(_[15]=(0,a.eW)("企微群通知 ")),(0,a.bF)(c,{title:"当达到触发条件时，消息将推送到已配置的企微群聊中"},{default:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(o.A))])),_:1})])),_:1}),q.value.includes(2)?((0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("div",L,[_[17]||(_[17]=(0,a.Lk)("span",{class:"property required"},"Webhook 地址：",-1)),(0,a.Lk)("div",m,[(0,a.bF)(ee,{value:j.value,"onUpdate:value":_[1]||(_[1]=e=>j.value=e),placeholder:"请输入webhook地址",style:{width:"382px"}},null,8,["value"]),_[16]||(_[16]=(0,a.Lk)("div",{class:"mt2"},[(0,a.Lk)("a",{href:"https://www.kancloud.cn/wikizhima/zmwk/3071448",target:"_blank"},"如何获取？")],-1))])]),(0,a.Lk)("div",C,[_[22]||(_[22]=(0,a.Lk)("span",{class:"property required"},"@人：",-1)),(0,a.Lk)("div",g,[(0,a.bF)(te,{value:Y.value,"onUpdate:value":_[2]||(_[2]=e=>Y.value=e)},{default:(0,a.k6)((()=>[(0,a.bF)(_e,{value:0},{default:(0,a.k6)((()=>_[18]||(_[18]=[(0,a.eW)("无需@群成员")]))),_:1}),(0,a.bF)(_e,{value:1},{default:(0,a.k6)((()=>_[19]||(_[19]=[(0,a.eW)("@所有人")]))),_:1}),(0,a.bF)(_e,{value:2},{default:(0,a.k6)((()=>_[20]||(_[20]=[(0,a.eW)("@指定群成员")]))),_:1})])),_:1},8,["value"]),2==Y.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[_[21]||(_[21]=(0,a.Lk)("div",{class:"tip-message mt2"}," 请填写要@的员工的企微账号。可以在企微通讯录中查看员工账号 ",-1)),(0,a.bF)(r.A,{onChange:Ee,selectedStaffs:Q.value,maxShowWidth:"600px",class:"mt8"},null,8,["selectedStaffs"])],64)):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",A,[(0,a.bF)(v,{value:3},{default:(0,a.k6)((()=>[_[23]||(_[23]=(0,a.eW)("钉钉群通知 ")),(0,a.bF)(c,{title:"当达到触发条件时，消息将推送到已配置的钉钉群聊中"},{default:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(o.A))])),_:1})])),_:1}),q.value.includes(3)?((0,a.uX)(),(0,a.CE)("div",I,[(0,a.Lk)("div",K,[_[24]||(_[24]=(0,a.Lk)("span",{class:"property required"},"Webhook 地址：",-1)),(0,a.Lk)("div",R,[(0,a.bF)(ee,{value:H.value,"onUpdate:value":_[3]||(_[3]=e=>H.value=e),placeholder:"请输入webhook地址",style:{width:"382px"}},null,8,["value"])])]),(0,a.Lk)("div",W,[_[26]||(_[26]=(0,a.Lk)("span",{class:"property required"},"加签secret：",-1)),(0,a.Lk)("div",T,[(0,a.bF)(ee,{value:V.value,"onUpdate:value":_[4]||(_[4]=e=>V.value=e),placeholder:"请输入加签secret",style:{width:"382px"}},null,8,["value"]),_[25]||(_[25]=(0,a.Lk)("div",{class:"mt2"},[(0,a.Lk)("a",{href:"https://www.kancloud.cn/wikizhima/shipinhaoxiaodian/3162861",target:"_blank"},"如何获取？")],-1))])]),(0,a.Lk)("div",b,[_[32]||(_[32]=(0,a.Lk)("span",{class:"property required"},"@人：",-1)),(0,a.Lk)("div",U,[(0,a.bF)(te,{value:N.value,"onUpdate:value":_[5]||(_[5]=e=>N.value=e)},{default:(0,a.k6)((()=>[(0,a.bF)(_e,{value:0},{default:(0,a.k6)((()=>_[27]||(_[27]=[(0,a.eW)("无需@群成员")]))),_:1}),(0,a.bF)(_e,{value:1},{default:(0,a.k6)((()=>_[28]||(_[28]=[(0,a.eW)("@所有人")]))),_:1}),(0,a.bF)(_e,{value:2},{default:(0,a.k6)((()=>_[29]||(_[29]=[(0,a.eW)("@指定群成员")]))),_:1})])),_:1},8,["value"]),2==N.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[_[31]||(_[31]=(0,a.Lk)("div",{class:"tip-message mt2"},"请填写要@群成员手机号",-1)),(0,a.Lk)("div",B,[(0,a.bF)(J,{type:"dashed",onClick:de},{default:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(n.A)),_[30]||(_[30]=(0,a.eW)(" 添加群成员 "))])),_:1}),(0,a.Lk)("div",w,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.value,((e,_)=>((0,a.uX)(),(0,a.Wv)($,{key:_,closable:"",onClose:e=>ve(e,_),class:"zm-customize-tag"},{default:(0,a.k6)((()=>[(0,a.eW)((0,u.v_)(e),1)])),_:2},1032,["onClose"])))),128))])])],64)):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0)])])),_:1},8,["value"])])])])),_:1},8,["open","confirmLoading"]),(0,a.bF)((0,l.R1)(d.A),{selectType:"multiple",ref_key:"setStaff",ref:G,onChange:_[9]||(_[9]=e=>ne(e))},null,512),(0,a.bF)(se,{open:x.value,"onUpdate:open":_[11]||(_[11]=e=>x.value=e),centered:"",mask:!1,title:"添加群成员",onOk:ce,"ok-text":"确定"},{default:(0,a.k6)((()=>[(0,a.bF)(ee,{value:F.value,"onUpdate:value":_[10]||(_[10]=e=>F.value=e),onInput:re,placeholder:"请输入要@的群成员钉钉绑定的手机号，可输入多个逗号分割"},null,8,["value"])])),_:1},8,["open"])])}}},F=t(71241);const X=(0,F.A)(x,[["__scopeId","data-v-58dcf713"]]);var S=X,z=t(59804),q=(t(1576),t(76504));const Y={class:"zm-main-content"},j={class:"statistic-box"},Q={class:"header mt16"},N={class:"operate-box"},H={class:"flex"},V={class:"zm-line-clamp2",style:{"max-height":"40px"}},Z={key:1},G={key:2},J={key:3,class:"msg-type-box"},$={class:"zm-line-clamp2",style:{"max-height":"40px"}},ee=["onClick"],_e=["onClick"],te=["onClick"],ae=["onClick"],le=["onClick"];var se={__name:"rule",setup(e){const _=(0,s.rd)(),t=(0,l.KR)(null),i=(0,l.KR)(!1),d=(0,l.KR)([{title:"规则名称",dataIndex:"rule_name",width:140},{dataIndex:"chat_type",title:"聊天场景",width:120},{dataIndex:"check_user_type",title:"触发对象",width:120},{dataIndex:"target_msg_type",title:"触发条件",width:160},{dataIndex:"total",width:180},{dataIndex:"create_user_name",title:"创建人",width:88},{title:"是否启用",dataIndex:"switch_status",width:160},{dataIndex:"created_at",title:"创建时间",width:200},{title:"操作",dataIndex:"operate",width:160,fixed:"right"}]),r=(0,l.KR)(!1),E=(0,l.KR)([]),D=(0,l.Kh)({total:0,current:1,pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]});function p(e,_){let t=[];(_.hint_keywords.length||_.hint_group_ids.length)&&t.push("发送敏感词");for(let a=0;a<e.length;a++){const _=e[a];"text"===_&&t.push("发送文本"),"link"===_&&t.push("发送链接"),"weapp"===_&&t.push("发送小程序"),"card"===_&&t.push("发送名片"),"link_text"===_&&t.push("发送包含链接的文本"),"qr_code"===_&&t.push("发送二维码图片")}return t.join("、")}const M=()=>{r.value=!0;let e={page:D.current,size:D.pageSize};(0,v.z8)(e).then((e=>{let _=e.data.items||[];_.map((e=>{e.status_switch_bool=1==e.switch_status})),E.value=_,D.total=Number(e.data?.total)})).finally((()=>{r.value=!1}))},O=e=>{i.value=Boolean(e.notice_switch)},P=()=>{t.value&&t.value.show()},f=e=>{_.push({path:"/module/hint_keywords/ruleStore",query:{task_id:e.id}})},k=e=>{z.A.confirm({title:"提示",content:"确定删除此规则吗？规则删除后，已经触发该规则的统计记录不会被删除",okText:"确定",cancelText:"取消",onOk:()=>{const _=c.Ay.loading("正在删除");e.switching=!0,(0,v.OC)({id:e.id}).then((()=>{c.Ay.success("已删除"),M()})).finally((()=>{e.switching=!1,_()}))}})},h=e=>{D.current=e.current,D.pageSize=e.pageSize,M()},y=()=>{_.push("/module/hint_keywords/ruleStore")},L=e=>{let _=e.status_switch_bool?"开启":"关闭";const t=()=>{e.status_switch_bool=!e.status_switch_bool};z.A.confirm({title:"提示",content:`确认${_}该规则？`,okText:"确定",cancelText:"取消",onOk:()=>{const a=c.Ay.loading(`正在${_}`);(0,v.zQ)({id:e.id,switch_status:e.switch_status?0:1}).then((()=>{c.Ay.success("操作完成"),M()})).finally((()=>{a()})).catch((()=>t()))},onCancel:t})},m=(e,t)=>{let a={rule_id:e.id,date_type:t,tab:"LOAD_BY_DETAIL"},l=_.resolve({path:"/module/hint_keywords/index",query:a}).href;window.open(l)},C=async()=>{try{let e=await(0,v.pY)();if("success"!==e.status)return;O(e.data)}catch(e){}};return(0,a.sV)((()=>{M(),C()})),(e,_)=>{const s=(0,a.g2)("a-alert"),c=(0,a.g2)("a-button"),v=(0,a.g2)("a-switch"),M=(0,a.g2)("a-tooltip"),C=(0,a.g2)("a-divider"),g=(0,a.g2)("a-table");return(0,a.uX)(),(0,a.CE)("div",Y,[(0,a.bF)(s,{"show-icon":"",message:"设置敏感词，会话内容中包含所设置的敏感词时，将触发提醒，实时质检服务质量和客户行为"}),(0,a.Lk)("div",j,[(0,a.bF)(q.A)]),(0,a.Lk)("div",Q,[(0,a.bF)(c,{type:"primary",onClick:y},{icon:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(n.A))])),default:(0,a.k6)((()=>[_[2]||(_[2]=(0,a.eW)(" 新建规则 "))])),_:1}),(0,a.Lk)("div",N,[(0,a.bF)(c,{class:"ml24",onClick:P},{default:(0,a.k6)((()=>[(0,a.Lk)("div",H,[_[3]||(_[3]=(0,a.eW)(" 触发提醒 ")),(0,a.bF)(v,{checked:i.value,"onUpdate:checked":_[0]||(_[0]=e=>i.value=e),onChange:_[1]||(_[1]=e=>i.value=!i.value),"checked-children":"开","un-checked-children":"关",class:"ml4"},null,8,["checked"])])])),_:1})])]),(0,a.bF)(g,{class:"mt16 rule-table",loading:r.value,"data-source":E.value,columns:d.value,scroll:{x:1500},pagination:D,onChange:h},{headerCell:(0,a.k6)((({column:e})=>["total"===e.dataIndex?((0,a.uX)(),(0,a.Wv)(M,{key:0},{title:(0,a.k6)((()=>_[4]||(_[4]=[(0,a.Lk)("div",null,"今日：今日触发规则的次数",-1),(0,a.Lk)("div",null,"昨天：昨日触发规则的次数",-1),(0,a.Lk)("div",null,"总触发次数：该监控总的触发次数",-1)]))),default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[_[5]||(_[5]=(0,a.eW)(" 今日/昨日/总触发数 ")),(0,a.bF)((0,l.R1)(o.A))])])),_:1})):(0,a.Q3)("",!0)])),bodyCell:(0,a.k6)((({column:e,text:_,record:t})=>["rule_name"===e.dataIndex?((0,a.uX)(),(0,a.Wv)(M,{key:0,title:_},{default:(0,a.k6)((()=>[(0,a.Lk)("div",V,(0,u.v_)(_),1)])),_:2},1032,["title"])):"chat_type"===e.dataIndex?((0,a.uX)(),(0,a.CE)("div",Z,(0,u.v_)(0==_?"全部":1==_?"单聊":"群聊"),1)):"check_user_type"===e.dataIndex?((0,a.uX)(),(0,a.CE)("div",G,(0,u.v_)(0==_?"全部":1==_?"仅客户":"仅员工"),1)):"target_msg_type"===e.dataIndex?((0,a.uX)(),(0,a.CE)("div",J,[(0,a.bF)(M,{title:p(_,t)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",$,(0,u.v_)(p(_,t)),1)])),_:2},1032,["title"])])):"switch_status"===e.dataIndex?((0,a.uX)(),(0,a.Wv)(v,{key:4,checked:t.status_switch_bool,"onUpdate:checked":e=>t.status_switch_bool=e,loading:t.switching,"checked-children":"开","un-checked-children":"关",onChange:e=>L(t)},null,8,["checked","onUpdate:checked","loading","onChange"])):"total"===e.dataIndex?((0,a.uX)(),(0,a.CE)(a.FK,{key:5},[(0,a.Lk)("a",{onClick:e=>m(t,1)},(0,u.v_)(t.statistic_today),9,ee),(0,a.bF)(C,{type:"vertical"}),(0,a.Lk)("a",{onClick:e=>m(t,2)},(0,u.v_)(t.statistic_yesterday),9,_e),(0,a.bF)(C,{type:"vertical"}),(0,a.Lk)("a",{onClick:e=>m(t,0)},(0,u.v_)(t.statistic_total),9,te)],64)):"operate"===e.dataIndex?((0,a.uX)(),(0,a.CE)(a.FK,{key:6},[(0,a.Lk)("a",{class:"operate-content",onClick:e=>f(t)},"编辑",8,ae),(0,a.Lk)("a",{class:"operate-content ml16",onClick:e=>k(t)},"删除",8,le)],64)):(0,a.Q3)("",!0)])),_:1},8,["loading","data-source","columns","pagination"]),(0,a.bF)(S,{ref_key:"remind",ref:t,onUpdate:O},null,512)])}}};const ie=(0,F.A)(se,[["__scopeId","data-v-ef6fd2ac"]]);var ue=ie,ne=t(69448);const oe=(0,F.A)(ne.A,[["__scopeId","data-v-165a30fc"]]);var de=oe;const re={class:"zm-main-content lexicon-box"},ce={class:"header mt16"},ve={class:"zm-line-clamp2"},Ee={key:1,class:"tages_wid"},De={key:2},pe={key:2,class:"default-content"},Me={key:3,class:"default-content"},Oe=["onClick"],Pe=["onClick"];var fe={__name:"lexicon",setup(e){const _=(0,l.KR)(!1),t=(0,l.KR)(null),s=(0,l.KR)(!1),i=(0,l.Kh)({id:void 0,group_name:"",keywords:[]}),d=(0,l.KR)(""),r=(0,l.KR)([{title:"敏感词组名称",dataIndex:"group_name",width:180},{dataIndex:"keywords",title:"敏感词",width:740},{dataIndex:"create_user_name",title:"创建人",width:160},{dataIndex:"created_at",title:"创建时间",width:200},{title:"操作",dataIndex:"operate",width:160,fixed:"right"}]),E=(0,l.KR)(!1),D=(0,l.KR)([]),p=(0,l.Kh)({total:0,current:1,pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}),M=(0,l.KR)(!1);function O(){i.id=void 0,i.group_name="",i.keywords=[],d.value=""}const P=e=>{if(i.keywords.length&&i.keywords.length>100)return c.Ay.error("最多100个敏感词"),!1;let _={id:i.id,group_name:i.group_name,keywords:i.keywords};const t=c.Ay.loading("正在保存");(0,v.kL)(_).then((e=>{"success"===e.status&&(M.value=!1,c.Ay.success("操作成功"),O(),k())})).finally((()=>{t()})).catch((e=>{}))},f=()=>{if(i.keywords=[],d.value=d.value.trim(),d.value){let e;e=d.value.split("\n");for(let _ of e)i.keywords.includes(_)||i.keywords&&i.keywords.push(_)}},k=()=>{E.value=!0;let e={page:p.current,size:p.pageSize};(0,v.R8)(e).then((e=>{let _=e.data.items||[];D.value=_,p.total=Number(e.data?.total)})).finally((()=>{E.value=!1}))},h=e=>{s.value=e.notice_switch},y=e=>{_.value=!0,M.value=!0,i.id=e.id,i.group_name=e.group_name,i.keywords=e.keywords,d.value=e.keywords.join("\n")},L=e=>{z.A.confirm({title:"提示",content:"确认删除该敏感词组，删除后，之前已选择该词组的规则不再包含对应的敏感词",okText:"确定",cancelText:"取消",onOk:()=>{const _=c.Ay.loading("正在删除");e.switching=!0,(0,v.ir)({id:e.id}).then((()=>{c.Ay.success("已删除"),k()})).finally((()=>{e.switching=!1,_()}))}})},m=e=>{p.current=e.current,p.pageSize=e.pageSize,k()},C=()=>{_.value=!1,O(),M.value=!0};return(0,a.sV)((()=>{k()})),(e,s)=>{const c=(0,a.g2)("a-alert"),v=(0,a.g2)("a-button"),O=(0,a.g2)("a-tooltip"),k=(0,a.g2)("a-tag"),g=(0,a.g2)("a-table"),A=(0,a.g2)("a-input"),I=(0,a.g2)("a-form-item"),K=(0,a.g2)("a-textarea"),R=(0,a.g2)("a-form"),W=(0,a.g2)("a-modal");return(0,a.uX)(),(0,a.CE)("div",re,[(0,a.bF)(c,{"show-icon":"",message:"提前预设敏感词组和敏感词，方便管理和选择"}),(0,a.Lk)("div",ce,[(0,a.bF)(v,{type:"primary",onClick:C},{icon:(0,a.k6)((()=>[(0,a.bF)((0,l.R1)(n.A))])),default:(0,a.k6)((()=>[s[3]||(s[3]=(0,a.eW)(" 新建敏感词组 "))])),_:1})]),(0,a.bF)(g,{class:"mt16 lexicon-table",loading:E.value,"data-source":D.value,columns:r.value,pagination:p,onChange:m},{headerCell:(0,a.k6)((({column:e})=>["total"===e.dataIndex?((0,a.uX)(),(0,a.Wv)(O,{key:0},{title:(0,a.k6)((()=>s[4]||(s[4]=[(0,a.Lk)("div",null,"今日：今日触发规则的次数",-1),(0,a.Lk)("div",null,"昨天：昨日触发规则的次数",-1),(0,a.Lk)("div",null,"总触发次数：该监控总的触发次数",-1)]))),default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[s[5]||(s[5]=(0,a.eW)(" 今日/昨日/总触发数 ")),(0,a.bF)((0,l.R1)(o.A))])])),_:1})):(0,a.Q3)("",!0)])),bodyCell:(0,a.k6)((({column:e,text:_,record:t})=>["group_name"===e.dataIndex?((0,a.uX)(),(0,a.Wv)(O,{key:0,title:_},{default:(0,a.k6)((()=>[(0,a.Lk)("div",ve,(0,u.v_)(_),1)])),_:2},1032,["title"])):"keywords"===e.dataIndex?((0,a.uX)(),(0,a.CE)("span",Ee,[t.keywords.length>1?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(t.keywords,((e,_)=>((0,a.uX)(),(0,a.Wv)(k,{class:"tag-names",key:_},{default:(0,a.k6)((()=>[(0,a.eW)((0,u.v_)(e),1)])),_:2},1024)))),128)):1==t.keywords.length?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[t.keywords.length?((0,a.uX)(),(0,a.Wv)(k,{key:0,class:"tag-name"},{default:(0,a.k6)((()=>[(0,a.eW)((0,u.v_)(t.keywords[0]&&t.keywords[0].length>10?t.keywords[0].substring(0,10)+"...":t.keywords[0]),1)])),_:2},1024)):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.CE)("div",De," - "))])):"create_user_name"===e.dataIndex?((0,a.uX)(),(0,a.CE)("div",pe,(0,u.v_)(_),1)):"created_at"===e.dataIndex?((0,a.uX)(),(0,a.CE)("div",Me,(0,u.v_)(_),1)):"operate"===e.dataIndex?((0,a.uX)(),(0,a.CE)(a.FK,{key:4},[(0,a.Lk)("a",{class:"operate-content",onClick:e=>y(t)},"编辑",8,Oe),(0,a.Lk)("a",{class:"operate-content ml16",onClick:e=>L(t)},"删除",8,Pe)],64)):(0,a.Q3)("",!0)])),_:1},8,["loading","data-source","columns","pagination"]),(0,a.bF)(S,{ref_key:"remind",ref:t,onUpdate:h},null,512),(0,a.bF)(W,{open:M.value,"onUpdate:open":s[2]||(s[2]=e=>M.value=e),title:(_.value?"编辑":"新建")+"敏感词组",onOk:P},{default:(0,a.k6)((()=>[(0,a.bF)(R,{class:"login-form",model:i,name:"lexicon",autocomplete:"off",onFinish:P,"label-col":{span:4}},{default:(0,a.k6)((()=>[(0,a.bF)(I,{label:"敏感词组："},{default:(0,a.k6)((()=>[(0,a.bF)(A,{placeholder:"请输入敏感词组名称",value:i.group_name,"onUpdate:value":s[0]||(s[0]=e=>i.group_name=e)},null,8,["value"])])),_:1}),(0,a.bF)(I,{label:"敏感词："},{default:(0,a.k6)((()=>[(0,a.bF)(K,{placeholder:"请输入敏感词，一次可添加100个，换行表示多个",value:d.value,"onUpdate:value":s[1]||(s[1]=e=>d.value=e),onBlur:f,rows:4},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["open","title"])])}}};const ke=(0,F.A)(fe,[["__scopeId","data-v-1464ac2d"]]);var he=ke,ye=t(8298);const Le={class:"sensitive-panel"};var me={__name:"index",setup(e){const _=(0,s.rd)(),t=(0,s.lq)(),u=(0,l.KR)("LOAD_BY_RULE"),n=["LOAD_BY_RULE","LOAD_BY_DETAIL","LOAD_BY_LEXICON"],o=(0,l.KR)(null),d=(0,a.EW)((()=>{switch(u.value){case"LOAD_BY_RULE":return ue;case"LOAD_BY_DETAIL":return de;case"LOAD_BY_LEXICON":return he;default:return ue}})),r=(0,l.KR)(!1),c=()=>{v({...t.query,tab:u.value})},v=e=>{_.replace({path:t.path,query:e})};return(0,a.sV)((()=>{let e=(0,ye.t0)(t.query);if(t.query.sender&&t.query.sender_type&&t.query.conversation_id){switch(t.query.sender_type){case"Customer":u.value="LOAD_BY_CUSTOMER";break;case"Staff":u.value="LOAD_BY_STAFF";break}o.value={sender:e.sender,receiver:e.receiver,sender_type:e.sender_type,receiver_type:e.receiver_type,conversation_id:e.conversation_id},delete e.sender,delete e.sender_type,delete e.receiver,delete e.receiver_type,delete e.conversation_id}t.query.tab&&n.includes(t.query.tab)&&(u.value=t.query.tab)})),(e,_)=>{const t=(0,a.g2)("a-tab-pane"),l=(0,a.g2)("a-tabs");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(l,{activeKey:u.value,"onUpdate:activeKey":_[0]||(_[0]=e=>u.value=e),onChange:c,class:"nav-tabs"},{default:(0,a.k6)((()=>[(0,a.bF)(t,{key:"LOAD_BY_RULE",tab:"敏感词规则","force-render":""}),(0,a.bF)(t,{key:"LOAD_BY_DETAIL",tab:"触发明细"}),(0,a.bF)(t,{key:"LOAD_BY_LEXICON",tab:"敏感词库"})])),_:1},8,["activeKey"]),(0,a.Lk)("div",Le,[r.value?((0,a.uX)(),(0,a.Wv)(i.A,{key:0})):((0,a.uX)(),(0,a.Wv)((0,a.$y)(d.value),{key:1,defaultParams:o.value},null,8,["defaultParams"]))])])}}};const Ce=(0,F.A)(me,[["__scopeId","data-v-78b991ea"]]);var ge=Ce},17767:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA/tJREFUaEPtmk9slEUUwH/v6y5tFVpNgVBppSghYsVIqBFMTIxWapp4oD0RNfHmSSIHT8YT9mRiI568mZhIPLQk1aBgSbyBAmIIBaKEFi1UKaZxqdDt7n7PvG9dUpXdnV1m20/jO33ZfTPzfvNm5r35IyyQfQe1/rccz4qGPUAv0A7UL9RZgu8sMClwgCA8tCJIfLW7V9IFO6TwMfCFtobpcI8IrwJNS2CoS5PTqnwYZIPBN/tlygpEAJHx8zok6HaXWpZaR5GjQUb6DUKiYZMJ94rwxlIbVkn7qrzTnAzekoHPMj0aBh8BqyqpIAa6KZVglwyM5N5V2BMDg6oxYZ+8PZIbBzqqKR2DMhcMIAMkYmBMNSakDUCrKRmXMv8DFPPEsgQ0JPP/zmdhzgZqDcS7B+oTsOk+4aHWvwKcnoRzV5Rc6JfCK0BTA+zsCmi79/ZGTs7AgZMhqZv+ILwB3LUMujuFzW230qvbWjl2WRk9q8zO+YHwBrC1Q3iuU6gLShsWKhw5q3xz0c/i5w1g1zbhgVWle7+ANn5N+fhozABe6w5oanQbFjfSMHjYz2z25oHXdwTc7bj1sUn8/mjMAF7cLnSsdBtCF6eV/cdiNoSeeFB4ZpMQlGHIhjA6ppyciBnA8gbofljoXFua4Myk8uWYcmPebb6U0/I2B6whC2R9XQFriwSyyzMwHNdAVugpiwMb1wiPtkNjMr/pvpmB81P5VCJtZwwexasHFtqVrPsTQPIAltDVQmoGYNmoecM8YAmc754vdIY3AFt91jQTLaUrV4DlRhGA5AEs95n5HS5cVaav53/zIXcM0HoPbFgtPLZOoknsIqk5ODWhfP+LcjXlUqK4TtUANsYt739qo9DcmO/pSsSSOvPI8XHlux+r3ydUBWA9/cKWgPtbKBu4XKAu/Qojp6rbJ1QMYMZb3m+971POTWkUoSvd7FQEYJPypSeL77juFMg88cnXIZmce00VAdim5fnNfnv+76Z+fjrk20s1AFjdBH1bA1qWu1dejea1WRg+EUZLrYs4e+Dx9RKN/XLZpkujpXQsPthcOOGYrToD9HfZUUlth08B7PzPytBxt3TbGWDHI4J5YTHEYsPhM54BbPncsk5ob6kdgipcmckHt9lbt2Cl23P2gFVj479wXFgLDAOwpM+itKtUBOBa6WLq/ScA7JDP8UBkMfvWqa2seeAHYIOTevyUJgzgPWB3/Gwrb5HAoOz9VHtFw/0xvp0vRjItQfjyv/+i2/AGhrRVk7lhkG3lHRcHDT0mmbq+6KlBwRyDCBPRY49XYnxrn1Llg3889ihA2LuJ6/PZpwmCHoWdQFsM7pAtqfgJwoMqiUPNdRxZ+NzmD26ItxWYaSgLAAAAAElFTkSuQmCC"}}]);