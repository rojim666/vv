"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[450],{8292:function(e,l,a){a.d(l,{A:function(){return i}});var t=a(56768);const c={class:"loading-box"};function u(e,l){const a=(0,t.g2)("a-spin");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(a)])}var s=a(71241);const v={},n=(0,s.A)(v,[["render",u],["__scopeId","data-v-3d53ffb8"]]);var i=n},19895:function(e,l,a){a.r(l),a.d(l,{default:function(){return A}});var t=a(56768),c=a(24232),u=a(90144),s=a(60782),v=a(17694),n=a(79907),i=a(41824),k=a(8298),_=a(8292);const o={class:"zm-main-box"},r={class:"form-block"},d={class:"form-block-item"},b={class:"form-block-content"},f={class:"c595959"},p={class:"c595959"},h={class:"c595959"},y={class:"form-block-item"},m={class:"form-block-content"},g={class:"form-block-item"},L={class:"form-block-content"},F={class:"form-block-item"},C={class:"form-block-content"},w={class:"c595959"},R={class:"c595959"};var W={__name:"authConfig",setup(e){const l=(0,s.Pj)(),a=(0,u.KR)(!0),W=(0,u.KR)(!1),X=(0,u.KR)(!1),K=(0,u.KR)(!1),A=(0,u.KR)(!1),z=(0,u.KR)({}),D=(0,u.KR)({id:"",agent_id:"",agent_secret:"",chat_public_key:"",chat_private_key:"",chat_public_key_version:"",chat_secret:"",callback_event_token:"",callback_event_aes_key:"",url:""}),E=(0,t.EW)((()=>l.getters.getCorpId));(0,t.sV)((()=>{I()}));const I=async()=>{a.value=!0;try{await U()}catch(e){}a.value=!1},U=async()=>{const{data:e}=await(0,i.Gu)({show_config:!0});D.value=e||{},D.value.url=window.location.origin+"/openpush/qw/"+E.value,z.value=(0,k.t0)(D.value)},x=()=>{if(W.value)try{if(K.value=!0,D.value.agent_secret=D.value.agent_secret.trim(),!D.value.agent_secret)throw"请输入自建应用密钥";(0,i.s3)({agent_secret:D.value.agent_secret}).then((()=>{v.Ay.success("已保存"),W.value=!W.value,z.value.agent_secret=D.value.agent_secret})).finally((()=>{K.value=!1}))}catch(e){K.value=!1,v.Ay.error(e)}},S=()=>{W.value=!1,D.value=(0,k.t0)(z.value)},j=()=>{if(X.value)try{if(A.value=!0,D.value.chat_secret=D.value.chat_secret.trim(),!D.value.chat_secret)throw"请输入会话存档密钥";if(!D.value.chat_public_key_version)throw"请输入公钥版本号";(0,i.s3)({chat_secret:D.value.chat_secret,chat_public_key_version:D.value.chat_public_key_version}).then((()=>{v.Ay.success("已保存"),X.value=!X.value,z.value.chat_secret=D.value.chat_secret,z.value.chat_public_key_version=D.value.chat_public_key_version})).finally((()=>{A.value=!1}))}catch(e){A.value=!1,v.Ay.error(e)}},q=()=>{X.value=!1,D.value=(0,k.t0)(z.value)};return(e,l)=>{const s=(0,t.g2)("a-form-item"),v=(0,t.g2)("a-input"),i=(0,t.g2)("a-button"),z=(0,t.g2)("a-input-number"),E=(0,t.g2)("a-form");return(0,t.uX)(),(0,t.Wv)(n.A,{title:"会话存档配置信息"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",o,[a.value?((0,t.uX)(),(0,t.Wv)(_.A,{key:0})):((0,t.uX)(),(0,t.Wv)(E,{key:1,"label-col":{span:6},"wrapper-col":{span:10},autocomplete:"off"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",r,[(0,t.Lk)("div",d,[l[13]||(l[13]=(0,t.Lk)("div",{class:"form-block-title"},"基础信息",-1)),(0,t.Lk)("div",b,[(0,t.bF)(s,{label:"企业ID"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",f,(0,c.v_)(D.value.id),1)])),_:1}),(0,t.bF)(s,{label:"自建应用ID"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",p,(0,c.v_)(D.value.agent_id),1)])),_:1}),W.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(s,{label:"自建应用密钥"},{default:(0,t.k6)((()=>[(0,t.bF)(v,{value:D.value.agent_secret,"onUpdate:value":l[0]||(l[0]=e=>D.value.agent_secret=e),placeholder:"请输入自建应用密钥"},null,8,["value"])])),_:1}),(0,t.bF)(s,{"wrapper-col":{span:10,offset:6}},{default:(0,t.k6)((()=>[(0,t.bF)(i,{class:"mr8",onClick:S},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("取 消")]))),_:1}),(0,t.bF)(i,{type:"primary",onClick:x,loading:K.value},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("保 存 ")]))),_:1},8,["loading"])])),_:1})],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(s,{label:"自建应用密钥"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",h,(0,c.v_)((0,u.R1)(k.Xl)(D.value.agent_secret)),1)])),_:1}),(0,t.bF)(s,{"wrapper-col":{span:10,offset:6}},{default:(0,t.k6)((()=>[(0,t.bF)(i,{type:"primary",onClick:l[1]||(l[1]=e=>W.value=!0)},{default:(0,t.k6)((()=>l[12]||(l[12]=[(0,t.eW)("修 改")]))),_:1})])),_:1})],64))])]),(0,t.Lk)("div",y,[l[16]||(l[16]=(0,t.Lk)("div",{class:"form-block-title"},"将以下信息复制并填入到企业微信后台",-1)),(0,t.Lk)("div",m,[(0,t.bF)(s,{label:"加密公钥",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"c595959 zm-pointer",onClick:l[2]||(l[2]=e=>(0,u.R1)(k.Dk)(D.value.chat_public_key))},[l[14]||(l[14]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,c.v_)((0,u.R1)(k.Xl)(D.value.chat_public_key)),1)])])),_:1}),(0,t.bF)(s,{label:"加密私钥",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"c595959 zm-pointer",onClick:l[3]||(l[3]=e=>(0,u.R1)(k.Dk)(D.value.chat_private_key))},[l[15]||(l[15]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,c.v_)((0,u.R1)(k.Xl)(D.value.chat_private_key,80)),1)])])),_:1})])]),(0,t.Lk)("div",g,[l[20]||(l[20]=(0,t.Lk)("div",{class:"form-block-title"},"将以下信息复制到企微后台-应用管理-接收消息服务器中",-1)),(0,t.Lk)("div",L,[(0,t.bF)(s,{label:"URL",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:l[4]||(l[4]=e=>(0,u.R1)(k.Dk)(D.value.url))},[l[17]||(l[17]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,c.v_)(D.value.url),1)])])),_:1}),(0,t.bF)(s,{label:"token",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:l[5]||(l[5]=e=>(0,u.R1)(k.Dk)(D.value.callback_event_token))},[l[18]||(l[18]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,c.v_)((0,u.R1)(k.Xl)(D.value.callback_event_token)),1)])])),_:1}),(0,t.bF)(s,{label:"encodingAESSKey",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:l[6]||(l[6]=e=>(0,u.R1)(k.Dk)(D.value.callback_event_aes_key))},[l[19]||(l[19]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,c.v_)((0,u.R1)(k.Xl)(D.value.callback_event_aes_key)),1)])])),_:1})])]),(0,t.Lk)("div",F,[l[24]||(l[24]=(0,t.Lk)("div",{class:"form-block-title"},"将企业微信后台会话存档配置页面的信息复制粘贴到下框中",-1)),(0,t.Lk)("div",C,[X.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(s,{label:"会话存档密钥",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.bF)(v,{value:D.value.chat_secret,"onUpdate:value":l[7]||(l[7]=e=>D.value.chat_secret=e),placeholder:"请输入会话存档密钥"},null,8,["value"])])),_:1}),(0,t.bF)(s,{label:"公钥版本号",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.bF)(z,{style:{width:"100%"},precision:0,value:D.value.chat_public_key_version,"onUpdate:value":l[8]||(l[8]=e=>D.value.chat_public_key_version=e),placeholder:"请输入公钥版本号"},null,8,["value"])])),_:1}),(0,t.bF)(s,{"wrapper-col":{span:10,offset:6}},{default:(0,t.k6)((()=>[(0,t.bF)(i,{class:"mr8",onClick:q},{default:(0,t.k6)((()=>l[21]||(l[21]=[(0,t.eW)("取 消")]))),_:1}),(0,t.bF)(i,{type:"primary",onClick:j,loading:A.value},{default:(0,t.k6)((()=>l[22]||(l[22]=[(0,t.eW)("保 存 ")]))),_:1},8,["loading"])])),_:1})],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(s,{label:"会话存档密钥",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",w,(0,c.v_)((0,u.R1)(k.Xl)(D.value.chat_secret)),1)])),_:1}),(0,t.bF)(s,{label:"公钥版本号",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",R,(0,c.v_)(D.value.chat_public_key_version),1)])),_:1}),(0,t.bF)(s,{"wrapper-col":{span:10,offset:6}},{default:(0,t.k6)((()=>[(0,t.bF)(i,{type:"primary",onClick:l[9]||(l[9]=e=>X.value=!0)},{default:(0,t.k6)((()=>l[23]||(l[23]=[(0,t.eW)("修 改")]))),_:1})])),_:1})],64))])])])])),_:1}))])])),_:1})}}},X=a(71241);const K=(0,X.A)(W,[["__scopeId","data-v-ceeaae8a"]]);var A=K}}]);