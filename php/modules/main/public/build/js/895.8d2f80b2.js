"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[895],{44686:function(e,t,a){a.d(t,{A:function(){return u}});var l=a(56768),i=a(24232);const n={class:"_main-nav"},s={key:1,class:"title"};var o={__name:"mainNavbar",props:{title:{type:[Array,String]}},setup(e){return(t,a)=>{const o=(0,l.g2)("router-link"),c=(0,l.g2)("a-breadcrumb-item"),r=(0,l.g2)("a-breadcrumb");return(0,l.uX)(),(0,l.CE)("div",n,[Array.isArray(e.title)?((0,l.uX)(),(0,l.Wv)(r,{key:0},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.title,((e,t)=>((0,l.uX)(),(0,l.Wv)(c,{key:t},{default:(0,l.k6)((()=>[e.route?((0,l.uX)(),(0,l.Wv)(o,{key:0,to:e.route},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.name),1)])),_:2},1032,["to"])):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,i.v_)(e.name),1)],64))])),_:2},1024)))),128))])),_:1})):((0,l.uX)(),(0,l.CE)("div",s,(0,i.v_)(e.title),1))])}}},c=a(71241);const r=(0,c.A)(o,[["__scopeId","data-v-b8774510"]]);var u=r},5895:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});a(44114);var l=a(56768),i=a(24232),n=a(90144),s=a(2033),o=a(59084),c=a(43510),r=a(79853),u=a(34251),d=a(29042),g=a(12911),v=a(49054),k=a(63536),p=a(17694),m=a(59804),_=a(8298),y=a(17875),f=a(44686);const b={class:"zm-main-content lexicon-box"},h={class:"statistic-box"},x={class:"statistic-item"},C={class:"statistic-num"},L={class:"statistic-item"},w={class:"statistic-num"},A={class:"header mt16"},F={class:"tag-main"},X={class:"tag-label-box"},K={class:"tag-label-title"},E={class:"tag-label-info"},R={class:"tag-content-box"},W={class:"tag-options-box"},I=["onClick"],O=["onClick"],T={class:"tag-icon-box"},U={class:"tag-icon-add"},z=["onClick"],Q={class:"tag-icon-delete"},$=["onClick"],H=["onClick"];var M={__name:"index",setup(e){(0,n.KR)(""),(0,n.KR)(!1);const t=(0,n.KR)(!1),a=(0,n.KR)(0),M=(0,n.Kh)({group_name:"",keyword_list:[{id:"",name:"",order:1}],group_id:void 0,order:1}),N=(0,n.KR)(!1),S=(0,n.KR)([]),V=(0,n.KR)(!1);function Y(e){let t=[];for(let a=0;a<e.length;a++){const l=e[a];t.push({id:l.id,name:l.name,order:l.order})}return t}function Z(e){return e.filter((e=>e.name&&""!==e.name.trim()))}const j=e=>{Z(M.keyword_list).length===M.keyword_list.length?M.keyword_list.push({id:"",name:"",order:e+2}):p.Ay.error("请输入标签名称")},q=()=>{if(Z(M.keyword_list).length===M.keyword_list.length-1)return p.Ay.error("请输入标签名称"),!1;let e=t.value?"编辑":"新建";const a=p.Ay.loading(`正在${e}`);let l={group_name:M.group_name,tag:M.keyword_list,order:M.order};t.value&&(l.group_id=M.group_id,l.tag=Y(M.keyword_list)),(0,y.Zg)(l).then((t=>{"success"===t.status&&(p.Ay.success(`${e}完成`),D(),V.value=!1,P())})).finally((()=>{a()})).catch((e=>{D()}))},B=(0,_.sg)(q,500),D=async()=>{N.value=!0;let e={};await(0,y.g0)(e).then((e=>{"success"===e.status&&(S.value=e.data||[],a.value=e.data.reduce(((e,t)=>e+t.tag.length),0))})).finally((()=>{N.value=!1}))},G=e=>{M.group_name=e.group_name,M.keyword_list=e.tag,M.group_id=e.group_id,M.order=e.order,t.value=!0,V.value=!0};function J(e){return e.reduce(((e,t)=>Math.max(e,t.order)),0)}function P(){M.group_name="",M.keyword_list=[{id:"",name:"",order:1}],M.group_id=void 0,M.order=1}const ee=()=>{P(),t.value=!1,M.order=J(S.value)+1,V.value=!0};(0,n.KR)(0);const te=e=>{m.A.confirm({content:"删除后，已添加到客户信息的标签也一起删除",okText:"确定",cancelText:"取消",onOk:()=>{const t=p.Ay.loading("正在删除");(0,y.mY)({group_id:e.group_id}).then((()=>{p.Ay.success("操作完成"),D()})).finally((()=>{t()}))}})},ae=(e,t)=>{1!==M.keyword_list.length?m.A.confirm({content:(0,l.h)("div",null,[(0,l.h)("span",{style:"display: inline-block; margin-top: 22px;"},"删除后，已添加到客户信息的标签也一起删除"),(0,l.h)("span",{style:"color: red; display: block; margin-top: 4px;"},"（若标签组内只有1个标签时，删除标签会连带标签组一起删除）")]),okText:"确定",style:"width: 520px;",cancelText:"取消",onOk:()=>{const a=p.Ay.loading("正在删除");if(!e.id)return M.keyword_list.splice(t,1),a(),!1;(0,y.dH)({tag_id:e.id}).then((()=>{p.Ay.success("操作完成"),M.keyword_list.splice(t,1)})).finally((()=>{a()})).catch((e=>{}))}}):p.Ay.error("请至少保留一个")};return(0,l.sV)((()=>{D()})),(e,p)=>{const m=(0,l.g2)("a-button"),_=(0,l.g2)("a-input"),y=(0,l.g2)("a-form-item"),N=(0,l.g2)("a-input-group"),Y=(0,l.g2)("a-form"),Z=(0,l.g2)("a-modal");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(f.A,{title:"标签管理"}),(0,l.Lk)("div",b,[(0,l.Lk)("div",h,[(0,l.Lk)("div",x,[p[2]||(p[2]=(0,l.Lk)("div",{class:"statistic-title"},"企微标签数",-1)),(0,l.Lk)("div",C,(0,i.v_)(a.value),1)]),(0,l.Lk)("div",L,[p[3]||(p[3]=(0,l.Lk)("div",{class:"statistic-title"},"企微标签组",-1)),(0,l.Lk)("div",w,(0,i.v_)(S.value.length),1)])]),(0,l.Lk)("div",A,[(0,l.bF)(m,{type:"primary",onClick:ee},{icon:(0,l.k6)((()=>[(0,l.bF)((0,n.R1)(k.A))])),default:(0,l.k6)((()=>[p[4]||(p[4]=(0,l.eW)(" 新建标签组 "))])),_:1})]),(0,l.Lk)("div",F,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(S.value,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"tag-item",key:e.group_id},[(0,l.Lk)("div",X,[(0,l.Lk)("div",K,(0,i.v_)(e.group_name),1),(0,l.Lk)("div",E,"标签数："+(0,i.v_)(e.tag.length),1)]),(0,l.Lk)("div",R,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.tag,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"tag"},(0,i.v_)(e.name),1)))),128))]),(0,l.Lk)("div",W,[(0,l.Lk)("div",{class:"tag-options",onClick:t=>G(e)},p[5]||(p[5]=[(0,l.Lk)("img",{class:"options-icon",src:s,alt:""},null,-1),(0,l.Lk)("img",{class:"options-icon active",src:o,alt:""},null,-1),(0,l.eW)(" 编辑 ")]),8,I),(0,l.Lk)("div",{class:"tag-options tag-options-delete",onClick:t=>te(e)},p[6]||(p[6]=[(0,l.Lk)("img",{class:"options-icon",src:c,alt:""},null,-1),(0,l.Lk)("img",{class:"options-icon active",src:r,alt:""},null,-1),(0,l.eW)(" 删除 ")]),8,O)])])))),128))]),(0,l.bF)(Z,{open:V.value,"onUpdate:open":p[1]||(p[1]=e=>V.value=e),title:(t.value?"编辑":"新建")+"标签组",onOk:(0,n.R1)(B)},{default:(0,l.k6)((()=>[(0,l.bF)(Y,{class:"login-form",model:M,name:"lexicon",autocomplete:"off",onFinish:(0,n.R1)(B),"label-col":{span:4}},{default:(0,l.k6)((()=>[(0,l.bF)(y,{label:"标签组："},{default:(0,l.k6)((()=>[(0,l.bF)(_,{placeholder:"请输入标签组名称",value:M.group_name,"onUpdate:value":p[0]||(p[0]=e=>M.group_name=e)},null,8,["value"])])),_:1}),(0,l.bF)(y,{label:"标签：",style:{"max-height":"300px",overflow:"auto"}},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(M.keyword_list,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:"list-item",key:t},[(0,l.bF)(N,{compact:""},{default:(0,l.k6)((()=>[(0,l.bF)(_,{placeholder:"请输入标签名称",value:e.name,"onUpdate:value":t=>e.name=t},null,8,["value","onUpdate:value"])])),_:2},1024),(0,l.Lk)("div",T,[(0,l.Lk)("div",U,[p[7]||(p[7]=(0,l.Lk)("img",{class:"tag-icon",src:u,alt:""},null,-1)),(0,l.Lk)("img",{onClick:e=>j(t),class:"tag-icon tag-icon-active",src:d,alt:""},null,8,z)]),(0,l.Lk)("div",Q,[M.keyword_list.length>1?((0,l.uX)(),(0,l.CE)("img",{key:0,onClick:a=>ae(e,t),class:"tag-icon",src:g,alt:""},null,8,$)):(0,l.Q3)("",!0),M.keyword_list.length>1?((0,l.uX)(),(0,l.CE)("img",{key:1,onClick:a=>ae(e,t),class:"tag-icon tag-icon-active",src:v,alt:""},null,8,H)):(0,l.Q3)("",!0)])])])))),128))])),_:1})])),_:1},8,["model","onFinish"])])),_:1},8,["open","title","onOk"])])])}}},N=a(71241);const S=(0,N.A)(M,[["__scopeId","data-v-c13763be"]]);var V=S},79853:function(e,t,a){e.exports=a.p+"img/delete-active.cccebfd3.svg"},43510:function(e,t,a){e.exports=a.p+"img/delete.82fa8e7c.svg"},59084:function(e,t,a){e.exports=a.p+"img/set-active.0eade707.svg"},2033:function(e,t,a){e.exports=a.p+"img/set.825d09c9.svg"},29042:function(e,t,a){e.exports=a.p+"img/tag-add-active.a416ca7b.svg"},34251:function(e,t,a){e.exports=a.p+"img/tag-add.452f27ee.svg"},49054:function(e,t,a){e.exports=a.p+"img/tag-delete-active.1ff7d2c1.svg"},12911:function(e,t,a){e.exports=a.p+"img/tag-delete.bb5149a3.svg"}}]);