"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[606],{87606:function(e,t,s){s.d(t,{A:function(){return at}});var a=s(56768),i=s(24232),l=s(17767),r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA5FJREFUaEPtmr1r1VAYxp/3fLSVoiAqKmixoqibdBesdHBwE1xE0FKcOihiKx1arOggCIKDi6jopFBB6CAo+B8UHQRFUfC66SQU25uccyS5SZom596bhARzpdnycXOf3/udwyF4x3PDh5awhSn0b5Ig/1pNjxVAK43m9xH8xhlS5IkffoftAwCrqWarLA/k21H8oqFrZusgw0AviQ+1Lmus0PCM2dlr1g8B/jgwdGTG7O5F64eaNwD+tfc2PPDfesBo9LtKTcFACcHvEMNqFbCVhFBLvPsQoNFA9FvB+XgVEKUDWMSHhq8EolSAlHiDhq+esLcqT5QGYBPPBD/tCdeuWqgKojQAx/Fj/qRvaYOGJ54z/PBOlcaeBMQrKfl4GUldIoD6DGCwFTJ0Vwp2Oy7QcfUUjLkUXFuRku+vF4Crz8OYW9GMQjQrBHvgnbuunjDGzEf3QNNCsqe1AvCFNvWEoZhQolk/ouLiDc2KvhZYGUehEAoS9j5Ax0E0LwV7HIpJQsRFUkK844KTUceY5B8Y8LMIUG4AW52nWLjYPOGnRUJ84j0NxteSPg9ILoAOTQqdILqID/UWgsgMYG1SjBZilSUF4WgcMsod6JPifajSYgQXgAju54bIBNCuSXl13pa4YfVJhoL1PWTOauB6bG7KBZEJwGmqGRAmbU3KWn0YTgnOl+IAnYxg8UpmiPwAQOrlyToPzkclw6f1jUyNweBJcM1lMCe4FF/WhZarXoNwILj2TEp+uVtCZwLoZKFUk2pT53UTOxTUYruZKGUE0KSU7EUpAH4zSs/4DVAiiRPiXaVGDPHl0BuWmcgfsZXW54o2u0we6FBBIgMlS2XcovESm4YwHwE6HI0ZOTt1LoA2nkg1qXQ4ePPd2mxk8YSvP2mEbuHj/6bIwlbwvXsPwBhgbkgpHkWjRGJwWzdKdIAoIr4wQDvL2BLa91piwAv7hO8JpaaJ6I0Q7GUWiyefKeQB2x85jnsBoJu2WE41uzqO046jvgLBKnf3D5plKfnBIhav0gNrn5SJZheEygIQfdwvSskv1gqgXbPzRGql4uJLXV4pLQfaNruWmeu/rJKh2ZVq+ahYFOkD3WK3p5cW13nCVVe8855b3O3moTLvl5rEZQrL+q4NgKyWquq53vfAvqtmV933R7TznrfdoPe3GmDOiGEH23ptu0G02cN3z5wRQ6vYzBn66g7i7Y/QHKvhdpu/jwqKiOCsWFkAAAAASUVORK5CYII=",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA0lJREFUaEPtms9rFDEUx79vkmxXRaGoaEVLV4QqBSt6EISKF6GghYJgbxUFQfTgSZAeLPgPeBJFQVDRg6dCexAUFXuQKhULeisordSDgiBUt5tJnsw4o0vdH9m225mFndMw85J8P+8leS8QQvA8YtH+Fhs8g5Y1ChR+S+mTB6yxKMzsxw+cJEOB+Nw7bMoCXko1l5QVgHzch2/Ufplb13nINpL4WOu8RZ5yQ7yl0bwfA/zSYNozxG2N6P1YcxMg6eg1I9CMwDI9UNMU0oxWMuZgtTE9KSY94Gs1u5X47wzga3OEgTuAU9KbBWy/UurLSois1IczgNZmAsAOd0H8Wgo5QB4W3NvUblkLwFzU/SQRrpcbii1dBHF3+J8woqQ4X7ss9xZLAXislDhTbgit0QbYUYC3/bGhG0T8xkUSA76QYqqW9bPiAIFQbbAX1ow4rpfFbHl4OKWEGHeBrgtACKHNMQC3XUT8Z8OYVhlx2KVt3QBCCItOsibnIiSwYcYFAAeCd6VENAUrt64rgKvw2E5rE2zTvU2AUp7T2sTbaOVdiP0OMrS7VB/kiffCw+fyO1jCEdAFvwNEzyrsPvNgcVRl8KmMk5KbQlpjLWCfAFx50TKmkRW9yuLnYohE14DW5haA45Go50S4XyzQMp8mUE/0reQ0TBpgBoAMcy/hhJTiVTFAVAw+jL7llRI7UxYBew7gK1H5MAeYvrgaNRbbrbEjReXFVaW8m6kCiLLvNQADoTCmKSm9/uDVN/4YQF2R4HtKicupW8ShZosW3zcPQDgUCRwDWAIUJicGjyshB8uV2ImugdijtoDNBmYMtOjswJgFiX6lUPaQkwqAcMoU/C4mGi3KB3li7pMZ+aFSeZEagGg9/KtGCYNKiqfVaqNUAYQQFp1s/GxGyalq4iPo5DKxi8BqNqmLQDXBSeWBiof6WkUX29f3QFMwL0HYtRyBzm3rcqQ0pgcWd5d4UHfWDmCeIM5KhRcujZyPlEFnYZLyTDdFRZvLALXasBATivDdtV1NAK6drqZdE2A1vV1qrGYEmhFYpgeo4xJvTfv9iHKMwXWDxr9qgGGWOY2NjXbd4O9ljzA8wyzbF7BeeMikHSS4H2EFFuLrNr8BWArnee8fSGwAAAAASUVORK5CYII=",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAArdJREFUaEPtmj9oFEEUxr+3M+OdhAhCAgYkRLFQUBDTCSkEOzsDFooIoqWlIBYG0gUsIhYWikg6xVYQLFIIgk0QtLMQjCiIWESid+7OPJlN7ojh7vbf2+QWdstj3sz3e+/Nm9nbR/DPM1aTK9gXWDT2GlD825A+LcBZh7+fT2ENF8iSF3/oHcaaQDCkmnvK8iCfTuIHTd7i/SMBmlUS39G67tCiqZt8YNjTpp9z/4RgOnabJ6ro/Y7mGmC3o1dHoI5AQQ/UKVTQgYXNM0cgDO19EGYzrtwCaN7o4ElGu8Th2QEi+zVx1j4DCHRH6+BRXvtedkUAvgNYSSGmAeBM9+QUhigC8NJodTUFAKLIXWPwfBkQOwLghZcFsWMAZUGIAliHg87ZozpQrylAu1d6SUdCDMAB4zZybwFugrFsjLrUb39IQogBhJE9C2BpU3TLaHV40AaXghADYIdGaKOHBJoB0aLRwb2kCiUBIQaQJLasdNp1gF7VCYzrxqgXaZxSBGDZ6P4bNc3iW8f8l06MVZA6bTRs0jx5AD4CGPETS99twtDeBeFiLJrVtDH4Jg4Qhe4yEy9IXwt8EYisfQ7CdDw32eNG7fkpDlDGiRqLd/bxlkvfK6PVlSTxMWfe/4UkSmCcKdvFM1YDpWZVgC+lAkhEoqj4QhHoeCdvJCTEiwD4ScLQnQfxIgCdpjpJiRcD2ICw50B4kAQhKV4UIA2EtHhxgEEQZYgvBaAXBICnYBzpHlIZS+Wgcpr7HEiq0dv3RHe8oPjSItAR619yGFggoPMR5Q1Y3Uhzx0lyUPcqk/ckTrvARkphQhHWA421LHZpxpaWQmkWlxhTA0h4scgcdQSKeE/CttIfun27QaVbDbRvNcAc66nfGKtau4EC3Aff7BHn4RzrE22M/qpAu43vjxhVaL/fbLf5B0ryz4je82TlAAAAAElFTkSuQmCC";const n={class:"fx-ac"},c={class:"add-people flex"},f={class:"add-left"},h={class:"add-right"},p={class:"top-btn flex"},_={class:"active fir"},g=["onDragstart","onDragenter","onDragend"],u={key:0,class:"staff flex"},m={class:"left flex"},A={class:"img-wra"},y={class:"name fx-ac"},v={class:"icon"},k={key:1,class:"staff flex"},b={class:"icon"},S={key:2,class:"staff flex"},w={class:"left flex"},C={class:"name"},L={class:"icon"},D={key:3,class:"staff flex"},T={class:"left flex"},E={class:"name"},x={class:"icon"};function K(e,t,s,K,Q,F){const I=(0,a.g2)("a-button"),U=(0,a.g2)("allStaff"),R=(0,a.g2)("a-tab-pane"),B=(0,a.g2)("a-tabs"),X=(0,a.g2)("a-empty"),N=(0,a.g2)("cu-scroll"),O=(0,a.g2)("a-spin"),W=(0,a.g2)("addTag"),Y=(0,a.g2)("a-modal");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(Y,{width:"820px",open:F.dialogShow,"onUpdate:open":t[4]||(t[4]=e=>F.dialogShow=e),centered:"",confirmLoading:s.addConfirmLoading,onOk:F.addPeopleHandleOk,onCancel:F.addPeopleHandleCancel,class:"select-staff-new-dialog"},{title:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.Lk)("div",null,(0,i.v_)(s.title||"选择员工"),1),s.group_chat?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"modal_a_title ml10",onClick:t[0]||(t[0]=(...e)=>F.modalATitle&&F.modalATitle(...e))},"刷新员工数据")):(0,a.Q3)("",!0)])])),footer:(0,a.k6)((()=>[(0,a.bF)(I,{onClick:F.addPeopleHandleCancel,disabled:s.addConfirmLoading},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("取消")]))),_:1},8,["onClick","disabled"]),(0,a.bF)(I,{type:"primary",loading:s.addConfirmLoading,onClick:F.addPeopleHandleOk},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)(" 确定 ")]))),_:1},8,["loading","onClick"])])),default:(0,a.k6)((()=>[(0,a.RG)(e.$slots,"alert",{},void 0,!0),(0,a.bF)(O,{spinning:Q.big_spinning},{default:(0,a.k6)((()=>[(0,a.Lk)("div",c,[(0,a.Lk)("div",f,[(0,a.bF)(B,{activeKey:Q.tabAcitive,"onUpdate:activeKey":t[1]||(t[1]=e=>Q.tabAcitive=e)},{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.Wv)(R,{key:1,tab:"员工"},{default:(0,a.k6)((()=>[(0,a.bF)(U,{selectData:Q.selectDataAll,onSetSelect:F.setSelect,isSession:s.isSession,isAuthMode:s.isAuthMode,excludeRole:s.excludeRole,bind_type:s.bind_type,"filter-staff":s.filterStaff,group_chat:s.group_chat,ref:"tabRef_1",selectType:s.selectType,viewAppointPermissions:s.viewAppointPermissions},null,8,["selectData","onSetSelect","isSession","isAuthMode","excludeRole","bind_type","filter-staff","group_chat","selectType","viewAppointPermissions"])])),_:1}))])),_:1},8,["activeKey"])]),(0,a.Lk)("div",h,[(0,a.Lk)("div",p,[(0,a.Lk)("div",_,[t[7]||(t[7]=(0,a.eW)(" 已选择")),(0,a.Lk)("span",null,"("+(0,i.v_)(Q.selectDataAll.length)+")",1)]),Q.selectDataAll.length?((0,a.uX)(),(0,a.Wv)(I,{key:0,type:"link",onClick:F.deleteAll},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)("一键移除")]))),_:1},8,["onClick"])):(0,a.Q3)("",!0)]),(0,a.bF)(N,{class:"scroll-box",ref:"scrollbarRef"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{class:"test_wrapper",onDragover:t[3]||(t[3]=e=>F.dragover(e))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Q.selectData,(e=>((0,a.uX)(),(0,a.CE)("div",{class:"all-select fx-ac",key:e.id,draggable:!0,onDragstart:t=>F.dragstart(e),onDragenter:t=>F.dragenter(e,t),onDragend:t=>F.dragend(e,t),onDragover:t[2]||(t[2]=e=>F.dragover(e))},[t[16]||(t[16]=(0,a.Lk)("div",{class:"drag"},null,-1)),1===e.data_type?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",A,[(0,a.Lk)("img",{src:l,class:(0,i.C4)({"img-c":"/static/image/default-avatar.svg"==e.avatar}),alt:""},null,2)]),(0,a.Lk)("span",y,(0,i.v_)(e.name),1)]),(0,a.Lk)("div",v,[(0,a.bF)(I,{type:"link",onClick:t=>F.selectDelete(e,e.data_type)},{default:(0,a.k6)((()=>t[9]||(t[9]=[(0,a.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,a.Q3)("",!0),2===e.data_type?((0,a.uX)(),(0,a.CE)("div",k,[t[11]||(t[11]=(0,a.Lk)("div",{class:"left flex"},[(0,a.Lk)("img",{src:r,alt:"",style:{width:"36px",height:"36px"}})],-1)),(0,a.Lk)("div",b,[(0,a.bF)(I,{type:"link",onClick:t=>F.selectDelete(e,e.data_type)},{default:(0,a.k6)((()=>t[10]||(t[10]=[(0,a.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,a.Q3)("",!0),3===e.data_type?((0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("div",w,[t[12]||(t[12]=(0,a.Lk)("img",{src:d,style:{width:"36px",height:"36px"},alt:""},null,-1)),(0,a.Lk)("div",C,(0,i.v_)(e.name),1)]),(0,a.Lk)("div",L,[(0,a.bF)(I,{type:"link",onClick:t=>F.selectDelete(e,e.data_type)},{default:(0,a.k6)((()=>t[13]||(t[13]=[(0,a.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,a.Q3)("",!0),4===e.data_type?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.Lk)("div",T,[t[14]||(t[14]=(0,a.Lk)("img",{src:o,alt:"",style:{width:"36px",height:"36px"}},null,-1)),(0,a.Lk)("div",E,(0,i.v_)(e.tag_name),1)]),(0,a.Lk)("div",x,[(0,a.bF)(I,{type:"link",onClick:t=>F.selectDelete(e,e.data_type)},{default:(0,a.k6)((()=>t[15]||(t[15]=[(0,a.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,a.Q3)("",!0)],40,g)))),128))],32),Q.selectDataAll.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(X,{key:0}))])),_:1},512)])])])),_:1},8,["spinning"]),(0,a.bF)(W,{ref:"addTagRef",onInitFunc:F.initMemberTag},null,8,["onInitFunc"])])),_:3},8,["open","confirmLoading","onOk","onCancel"])])}s(44114);var Q=s(45130),F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAVdJREFUSEu9lc1tgzAYhvOaAxInRghHG5DCBmGDdoI2E0TdoN2ADcoG7QbJBlTYgisjsAC4cgVSRQEbEOWKv+fB3x847PxgZ/5hkaAoiisAl1L6ZvphxoKyLM9t294UuG3bOAzDu4nESFCW5bGDHzto5ThO5HlerZMYCYQQKYCn3zAACWPsZbNACPEM4H0MBOCRMfY5J5m9wUhqhqyaEBJRSqspyaxgLDVDEIA7YyxeLBBCnABkuhyr91LKKAiCr9E0zgE452edAEA9BVexRl2kk6wu8hZwH6sr8smyLFcnopROTvWk4F+KXBTFTUqpK3Tq+/5lcZuqADVoTdNkaoNOTHIFIF49aAqa5/mDZVkfYwIp5SUIgnRzF3HOE0LIdQCaTY1RF/WHsixzbdvOpJQ/6xqANjWLBOqwmmpCyD4/nP5rOOev3WpIdLOx+AamwD/bdm2gadw3I4Z9GVXUaNYAAAAASUVORK5CYII=",I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXxJREFUSEvFlc1twjAYhvN+keDKCFyjGIlsQDZoJ2iZAEUJSNzaE1LIgQ3KBu0GsEGqGMGVEXJH5KuMhIRQEjv8qL7afh5/P7ZhPXngyXyrkSBJkhGAThiGn6YHMxbM5/MBgJUCM7M/Ho/XJhIjwWw267ZarRUzdxUUwJ6IvCAIcp3ESJAkydKyrLdLGIBFGIbB3YI4jt+J6KsC9BpF0U+dpDaC69SUgPLD4eBNp9N9laRWUJaaEtA6iiK/sSCO4z4Rpbocq/miKLzJZPJbtrY2AtWaOgEz51XwU8fpAPfO/69gs9n0bdvu6KJwHKfyVldGoOAAjIrMzJ4QonmRt9uteh50hV66rjts3KZqw2636x6Px1S9oKUtCOwB+I7j3HbRFDTLshfbtr/LBMw8FEKod6pyGHWRlHJBRKMrSm1qzmuNBGmadtrtdnr5XOtS00igFkspB0R0+nCKovB7vd7jPpzzaaSUHwByIcRCdzcaR2AKvF5nVINb4WrfH349gBkc1ySJAAAAAElFTkSuQmCC",U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXlJREFUSEvVlUFuwjAQRf0jZcMqR4BlLCI1NyA3aE/QcgJUoURi166QiCW4QXOD9gblBlSKRbYcIWsW48oIJBoljkPEot7a85/nz3gMdueFO+uzToD9fj8D4Pm+/257MWtAURQTIvrWwkQUBUGwtYFYAYqiGJ7Fh2fRw2AwCEejUdkGsQJIKTMAz9diADac89feACnlC4CPOiEAT5zzLxPEmEGNNVWt0nGc0Pf9QxPECKizpioEYMs5jzoDpJQPAHZtHut9pVQ4Ho9/am00CeR5PmkDACibxHWsVRe1QW4uch/hS6wxg9VqpevgtYHiOG581Y0ALe44jlWRiShMkqR7kYUQevYYCw0gm8/n085tqgOWy+XQdV2dRa1NAA7H4zFaLBa3PTQNEUI8MsY+625IRNMkSbLeXSSE2DDGZpVhZ7TGqosuh9brtUdEO6XUaVzbWNMJoA+naToBcPpwlFKRqTX/ZNrW49f7aZq+McbKOI61ZVbr/4+KXzY7gBlfd6c0AAAAAElFTkSuQmCC";const R={class:"all-staff"},B={class:"sess-check fx-ac"},X={class:"sel-radio-type fx-ac",style:{"margin-top":"4px"}},N={class:"sess-check-pro-title"},O={class:"title fx-ac"},W={class:"nums fx-ac"},Y={class:"num"},P={class:"fir"},G={class:"num sc-num"},M={class:"fir"},z={class:"sec fx-ac"},H={key:0,src:F,alt:""},V={key:1,src:I,alt:""},J={key:2,src:U,alt:""},q=["onClick"],j={class:"i-left fx-ac"},Z=["onUpdate:modelValue","onChange"],$={class:"i-right flex"},ee={class:"ri-top fx-ac"},te={class:"name eliOne fx-ac"},se={class:"eliOne"},ae={class:"nums fx-ac"},ie={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},le={style:{"text-align":"center",height:"18px"}},re={key:1};function de(e,t,s,r,d,o){const n=(0,a.g2)("a-input-search"),c=(0,a.g2)("a-button"),f=(0,a.g2)("a-popover"),h=(0,a.g2)("a-empty"),p=(0,a.g2)("ZmScroll"),_=(0,a.g2)("a-spin");return(0,a.uX)(),(0,a.CE)("div",R,[(0,a.bF)(n,{placeholder:"请输入员工名称进行搜索",onSearch:o.addPeopleSearch,style:{"margin-top":"-8px"},value:d.staff_list_params.keyword,"onUpdate:value":t[0]||(t[0]=e=>d.staff_list_params.keyword=e),valueModifiers:{trim:!0}},null,8,["onSearch","value"]),(0,a.Lk)("div",B,[(0,a.Lk)("div",X,[(0,a.bF)(f,{placement:"bottom"},{content:(0,a.k6)((()=>[(0,a.Lk)("div",N,[(0,a.Lk)("div",O,[t[3]||(t[3]=(0,a.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,a.bF)(c,{type:"link",style:{"margin-left":"20px"},onClick:o.openSeat},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,a.Lk)("div",W,[(0,a.Lk)("div",Y,[(0,a.Lk)("div",P,(0,i.v_)(o.bind_num),1),t[4]||(t[4]=(0,a.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,a.Lk)("div",G,[(0,a.Lk)("div",M,(0,i.v_)(o.unbind_num),1),t[5]||(t[5]=(0,a.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,a.Lk)("div",{class:"fx-ac tit",onClick:t[1]||(t[1]=(...e)=>o.sortTap&&o.sortTap(...e))},[(0,a.Lk)("div",z,[t[6]||(t[6]=(0,a.Lk)("div",null,"客户数",-1)),0==d.sortType?((0,a.uX)(),(0,a.CE)("img",H)):(0,a.Q3)("",!0),1==d.sortType?((0,a.uX)(),(0,a.CE)("img",V)):(0,a.Q3)("",!0),2==d.sortType?((0,a.uX)(),(0,a.CE)("img",J)):(0,a.Q3)("",!0)])])]),(0,a.bF)(p,{class:"datas-item",onLoad:o.peopleListLoad,finished:d.staff_list_nomore,loading:d.loading},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.staff_list,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{class:"all-memeber fx-ac",key:e.id,onClick:(0,Q.D$)((t=>o.wraperTap(e,s)),["stop"])},[(0,a.Lk)("div",j,[(0,a.bo)((0,a.Lk)("input",{class:"check-input",type:"checkbox","onUpdate:modelValue":t=>e.checked=t,onChange:t=>o.checkChange(e,t,s)},null,40,Z),[[Q.lH,e.checked]]),(0,a.Lk)("img",{src:l,alt:"",class:(0,i.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==e.avatar}])},null,2)]),(0,a.Lk)("div",$,[(0,a.Lk)("div",ee,[(0,a.Lk)("div",te,[(0,a.Lk)("span",se,(0,i.v_)(e.name),1)]),(0,a.Lk)("div",ae,[t[7]||(t[7]=(0,a.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,a.Lk)("div",ie,(0,i.v_)(e.cst_total),1)])])])],8,q)))),128)),d.staff_list.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(h,{key:0}))])),_:1},8,["onLoad","finished","loading"]),(0,a.Lk)("div",le,[d.staff_list_Loading?((0,a.uX)(),(0,a.Wv)(_,{key:0,size:"small"})):(0,a.Q3)("",!0),!d.staff_list_Loading&&d.staff_list.length?((0,a.uX)(),(0,a.CE)("div",re,(0,i.v_)(d.staff_list_nomore?"":"下滑加载更多"),1)):(0,a.Q3)("",!0)])])}var oe=s(14379),ne=s(17875),ce={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{loading:!1,staff_list:[],staff_list_params:{page:1,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,oldSelect:[],sortType:1,searchTimer:""}},components:{ZmScroll:oe.A},computed:{showStatus(){let e=!0;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},created(){this.staff_list.length||(this.loading=!1,this.getUser_get_staff_list()),this.getOldData()},watch:{selectData(){let e=this.selectData.map((e=>e.userid));for(let t=0;t<this.staff_list.length;t++){let s=this.staff_list[t];e.includes(s.userid)?s.checked=!0:s.checked=!1,this.staff_list[t]=s}},"staff_list_params.keyword"(){clearInterval(this.searchTimer),this.searchTimer=setTimeout((()=>{this.addPeopleSearch()}),500)}},methods:{addPeopleSearch(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},getUser_get_staff_list(){this.loading||this.staff_list_nomore||this.staff_list_Loading||(this.loading=!0,this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.chat_status=this.isSession),this.isAuthMode&&(this.staff_list_params.is_auth_mode=1),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.sortType?this.staff_list_params.order_by=1==this.sortType?"DESC":"ASC":this.staff_list_params.order_by="",this.staff_list_params.order_fields="cst_total",this.viewAppointPermissions&&(this.staff_list_params.permission_userids=this.viewAppointPermissions),(0,ne.Xj)(this.staff_list_params).then((e=>{if(this.staff_list_Loading=!1,!e.data.items.length)return this.staff_list_nomore=!0,this.loading=!1,!1;if(e.data&&e.data.items&&e.data.items.length){e.data.items.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.items=e.data.items.filter((e=>e[this.filterStaff.key]==this.filterStaff.value))),this.staff_list=this.staff_list.concat(e.data.items);let t=e=>{this.staff_list.forEach(((t,s)=>{e.includes(t.userid)&&(t.checked=!0)}))};t(this.selectData.map((e=>e.userid)))}this.loading=!1})))},peopleListLoad(){this.staff_list_Loading||(this.staff_list_params.page++,this.loading=!1,this.getUser_get_staff_list())},getGroup(e){return e&&e.length?e.map((e=>e.name)).join(","):"--"},setCheck(e,t){let s=this.staff_list.map((e=>e.userid)),a=s.indexOf(e.userid);this.staff_list[a]&&(this.staff_list[a].checked=!1,this.staff_list[a]=this.staff_list[a])},wraperTap(e,t){this.checkChange(e,!e.checked,t)},checkChange(e,t,s){let a=JSON.parse(JSON.stringify(this.selectData));if(e.data_type=1,e.checked=t,this.staff_list[s]=e,"multiple"!==this.selectType)this.staff_list.forEach(((t,s)=>{this.staff_list[s].checked=!1,t.userid===e.userid&&(this.staff_list[s].checked=!0)})),a=[e];else{let s=a.filter((e=>1===e.data_type)).map((e=>e.userid));if(t&&!s.includes(e.userid))a.push(e);else if(!t&&s.includes(e.userid)){let t;a.forEach(((s,a)=>{s.userid===e.userid&&(t=a)})),a.splice(t,1)}}this.$emit("setSelect",a)},sortTap(){this.staff_list_Loading||(this.sortType++,this.sortType>2&&(this.sortType=0),this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list())},getOldData(){let e={is_archive:this.isSession};this.isAuthMode&&(e.is_auth_mode=1)},oldSelectTap(e,t){e.checked=!e.checked,this.oldSelect[t]=e;let s=JSON.parse(JSON.stringify(this.selectData)),a=s.filter((e=>1===e.data_type)).map((e=>e.userid));if(a.includes(e.userid)){let t=a.indexOf(e.userid);-1!==t&&s.splice(t,1)}else e.data_type=1,"multiple"!==this.selectType?s=[e]:s.push(e);this.$emit("setSelect",s)},sessionCheck(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},openSeat(){window.open("/manage/index#/seatManage")}}},fe=s(71241);const he=(0,fe.A)(ce,[["render",de],["__scopeId","data-v-b29d2868"]]);var pe=he;const _e={class:"framework"},ge={style:{"margin-top":"12px"}},ue={class:"sess-check-pro-title"},me={class:"title fx-ac"},Ae={class:"nums fx-ac"},ye={class:"num"},ve={class:"fir"},ke={class:"num sc-num"},be={class:"fir"},Se={class:"tree-wraper"},we={key:0,style:{"justify-content":"center","margin-top":"20px"},class:"fx-ac"},Ce=["onClick"],Le=["onClick"],De={class:"staff-list fx-ac"},Te={class:"i-left fx-ac"},Ee=["src"],xe={class:"i-right flex"},Ke={class:"ri-top fx-ac"},Qe={class:"nums fx-ac"},Fe={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},Ie={class:"ri-bot fx-ac"},Ue={class:"seat-bind-box mr5"},Re={key:0,class:"bind-no"},Be={key:1,class:"interflow-bind"},Xe={key:2,class:"foundation-bind"},Ne={class:"bm eliOne"},Oe={key:0,class:"c-j flex"},We={key:1,class:"p-t flex"},Ye={key:0,class:"loading-btn"};function Pe(e,t,s,l,r,d){const o=(0,a.g2)("a-input-search"),n=(0,a.g2)("a-button"),c=(0,a.g2)("a-popover"),f=(0,a.g2)("a-spin"),h=(0,a.g2)("a-tree");return(0,a.uX)(),(0,a.CE)("div",_e,[(0,a.bF)(o,{placeholder:"请输入组织架构进行搜索",modelValue:r.searchParams.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchParams.keyword=e),modelModifiers:{trim:!0},style:{"margin-top":"-8px"}},null,8,["modelValue"]),(0,a.Lk)("div",ge,[(0,a.bF)(c,{placement:"bottom"},{content:(0,a.k6)((()=>[(0,a.Lk)("div",ue,[(0,a.Lk)("div",me,[t[3]||(t[3]=(0,a.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,a.bF)(n,{type:"link",style:{"margin-left":"20px"},onClick:d.openSeat},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,a.Lk)("div",Ae,[(0,a.Lk)("div",ye,[(0,a.Lk)("div",ve,(0,i.v_)(d.bind_num),1),t[4]||(t[4]=(0,a.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,a.Lk)("div",ke,[(0,a.Lk)("div",be,(0,i.v_)(d.unbind_num),1),t[5]||(t[5]=(0,a.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,a.Lk)("div",Se,[r.showTree?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",we,[(0,a.bF)(f)])),(0,a.bF)(f,{spinning:r.spinning},{default:(0,a.k6)((()=>[r.showTree?((0,a.uX)(),(0,a.Wv)(h,{key:0,checkable:"",props:r.props,checkStrictly:"",ref:"elTreeRef","load-data":d.loadNode,"tree-data":r.treeData,checkedKey:d.checkChange,"onUpdate:checkedKey":t[1]||(t[1]=e=>d.checkChange=e),"filter-tree-node":d.filterNode},{title:(0,a.k6)((({node:e,data:s})=>[(0,a.Lk)("div",{class:(0,i.C4)(["custom-tree-node",{"tree-node-30":s.show_more}])},[s.is_staff?((0,a.uX)(),(0,a.CE)("div",{key:1,class:(0,i.C4)(["staff-wrape",{"padd-b-30":s.show_more}]),onClick:t=>d.itemTap(e,s)},[(0,a.Lk)("div",De,[(0,a.Lk)("div",Te,[(0,a.Lk)("img",{src:s.avatar,alt:"",class:(0,i.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==s.avatar}])},null,10,Ee)]),(0,a.Lk)("div",xe,[(0,a.Lk)("div",Ke,[t[7]||(t[7]=(0,a.Lk)("div",{class:"name eliOne fx-ac",style:{"white-space":"normal"}},null,-1)),(0,a.Lk)("div",Qe,[t[6]||(t[6]=(0,a.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,a.Lk)("div",Fe,(0,i.v_)(s.external_total),1)])]),(0,a.Lk)("div",Ie,[(0,a.Lk)("div",Ue,[s.is_bind_license?2==s.license_type?((0,a.uX)(),(0,a.CE)("div",Be)):1==s.license_type?((0,a.uX)(),(0,a.CE)("div",Xe)):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Re))]),(0,a.Lk)("div",Ne,(0,i.v_)(s.alias?s.alias:""),1),1==s.role?((0,a.uX)(),(0,a.CE)("div",Oe,"超级管理员")):(0,a.Q3)("",!0),2==s.role?((0,a.uX)(),(0,a.CE)("div",We,"普通员工")):(0,a.Q3)("",!0)])])]),s.show_more?((0,a.uX)(),(0,a.CE)("div",Ye,[(0,a.bF)(n,{type:"dashed",ref:"loading_id"+s.loading_id,icon:"redo",onClick:(0,Q.D$)((t=>d.loadMoreTap(e,s)),["stop"])},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)(" 点击加载更多 ")]))),_:2},1032,["onClick"])])):(0,a.Q3)("",!0)],10,Le)):((0,a.uX)(),(0,a.CE)("div",{key:0,onClick:t=>d.itemTap(e,s)},(0,i.v_)(s.department_name)+" ("+(0,i.v_)(s.staff_count)+")",9,Ce))],2)])),_:1},8,["props","load-data","tree-data","checkedKey","filter-tree-node"])):(0,a.Q3)("",!0)])),_:1},8,["spinning"])])])}var Ge={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{treeData:[],searchParams:{keyword:""},props:{children:"child",isLeaf:function(e,t){return e.child&&0===e.child.length}},staff_list_params:{page:0,size:20,department_type:1},staff_list_Loading:!1,staff_list_nomore:!0,textures_list:[],currTotal:0,currSelectKeys:[],department_ids:[],spinning:!1,showTree:!0}},computed:{showStatus(){let e=0==this.$store.state.user.active_corp.setting_status||3==this.$store.state.user.active_corp.setting_status;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},components:{},watch:{"searchParams.keyword"(){this.$refs.elTreeRef.filter(this.searchParams.keyword)},selectData(){let e=this.selectData.filter((e=>1===e.data_type)).map((e=>e.staff_id));e.forEach((e=>{this.currSelectKeys.includes(e)||(this.currSelectKeys.push(e),this.setTreeKeys())}))}},created(){this.initNode()},methods:{clearCheck(){this.currSelectKeys=[],this.setTreeKeys()},clearParKey(){this.currSelectKeys=this.currSelectKeys.filter((e=>-1!=e.indexOf("_"))),setTimeout((()=>{this.setTreeKeys()}),500)},setCheck(e,t,s){if(1===s)this.department_ids.forEach((t=>{let s=this.currSelectKeys.findIndex((s=>s===t+"_"+e.staff_id));-1!==s&&this.currSelectKeys.splice(s,1)})),this.setTreeKeys();else if(2===s){let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&(this.currSelectKeys.splice(t,1),this.setTreeKeys())}},filterNode(e){return e.department_name?e.department_name:e.name?e.name:void 0},itemTap(e,t){if(t.disabled)return;let{department_id:s}=t;if("multiple"!==this.selectType)this.currSelectKeys=[s],this.setTreeKeys();else if(this.currSelectKeys.includes(s)){let e=this.currSelectKeys.findIndex((e=>e===s));-1!==e&&(this.currSelectKeys.splice(e,1),this.setTreeKeys())}else this.currSelectKeys.push(s),this.setTreeKeys()},checkChange(e,t){if(t)this.currSelectKeys.includes(e.department_id)||this.currSelectKeys.push(e.department_id);else{let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&this.currSelectKeys.splice(t,1)}let s=JSON.parse(JSON.stringify(this.selectData)),{is_staff:a}=e;if(a){if(e.data_type=1,"multiple"!==this.selectType)s=[e];else{let a=s.filter((e=>1===e.data_type)).map((e=>e.staff_id));t&&!a.includes(e.staff_id)?s.push(e):!t&&a.includes(e.staff_id)&&s.splice(s.findIndex((t=>t.staff_id==e.staff_id)),1)}this.$emit("setSelect",s)}else{e.data_type=2;let a=s.filter((e=>2===e.data_type)).map((e=>e.department_id));if(t&&!a.includes(e.department_id))this.$emit("setLoading",!0),this.getCurrStaffList(e).then((t=>{e.staff_list=t,s.push(e),this.$emit("setLoading",!1),this.$emit("setSelect",s)}));else if(!t&&a.includes(e.department_id)){let t;s.forEach(((s,a)=>{s.department_id===e.department_id&&(t=a)})),s.splice(t,1),this.$emit("setSelect",s)}}},setTreeKeys(){this.$refs.elTreeRef.setCheckedKeys(this.currSelectKeys)},getFrameWorkList(){this.spinning=!0;let e={};this.isSession&&(e.is_session=this.isSession),this.isAuthMode&&(e.is_auth_mode=1);let t={msg:"成功",res:0,data:{list:[{department_id:"1",department_order:"100000000",department_parent_id:"0",department_name:"武汉铁杵磨针网络科技有限公司",staff_count:26,child:[{department_id:"2",department_order:"100000000",department_parent_id:"1",department_name:"测试",child:[{department_id:"4",department_order:"100000000",department_parent_id:"2",department_name:"测试1",child:[{department_id:"5",department_order:"100000000",department_parent_id:"4",department_name:"测试11",child:[],staff_count:1}],staff_count:2}],staff_count:4},{department_id:"3",department_order:"99999000",department_parent_id:"1",department_name:"开发",child:[],staff_count:9}]}]}};if(this.spinning=!1,t&&t.data&&t.data.list){this.textures_list=t.data.list;let e=[],s=t=>{t.forEach((t=>{t.disabled=1*t.staff_count>500||"multiple"!==this.selectType,e.push(t.department_id),t.child&&t.child.length?s(t.child):delete t.child}))};return s(t.data.list),this.department_ids=e,Promise.resolve(t.data.list)}},setNodeSty(){this.$nextTick((()=>{let e=document.querySelectorAll(".a-tree-node__content");e.forEach((e=>{e.getElementsByTagName("label")[0].style.marginTop=0}));let t=document.querySelectorAll(".tree-node-30");t.forEach((e=>{let t=e.parentNode.getElementsByTagName("label");t[0].style.marginTop="-40px"}))}))},async loadMoreTap(e,t){this.$refs["loading_id"+t.loading_id].$el.__vue__.sLoading=!0;let s=e.parent.childNodes.map((e=>e.data));s.forEach((e=>e.show_more=!1)),this.staff_list_nomore=!1,this.staff_list_params.department_id=t.par_department_id,this.staff_list_params.page=t.cur_page+1;let a=await this.getUser_get_staff_list();a.forEach(((e,s)=>{e.child=[],e.is_staff=!0,e.par_department_id=t.par_department_id,e.cur_page=t.cur_page+1,e.department_id=t.par_department_id+"_"+e.staff_id,e.loading_id=e.staff_id})),a[a.length-1]&&(a[a.length-1].show_more=!this.staff_list_nomore);let i=[...s,...a];this.$refs.elTreeRef.updateKeyChildren(t.par_department_id,i),this.setNodeSty()},async initNode(){let e=await this.getFrameWorkList();this.treeData=e},async loadNode(e,t){this.staff_list_nomore=!1,this.staff_list_params.department_id=e.department_id,this.staff_list_params.page=1;let s=await this.getUser_get_staff_list();s.forEach(((t,s)=>{t.child=[],t.is_staff=!0,t.par_department_id=e.department_id,t.cur_page=1,t.department_id=e.department_id+"_"+t.staff_id,t.loading_id=t.staff_id}));let a=e.child||[];s[s.length-1]&&(s[s.length-1].show_more=!this.staff_list_nomore),this.treeData=[...a,...s],this.setNodeSty()},getUser_get_staff_list(){if(this.staff_list_nomore)return;if(this.staff_list_Loading)return;this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.is_session=this.isSession),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.bind_type&&(this.staff_list_params.bind_type=this.bind_type),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.viewAppointPermissions&&(this.staff_list_params.permission_staff_ids=this.viewAppointPermissions);let e={msg:"成功",res:0,data:{pagination:{curPage:1,pageSize:20,total:13,totalCount:13,hasNextPage:!1},list:[{staff_id:"3587",name:"黄思龙",user_id:"woX2IKEAAAstH9Dx0LRajnJjSgmPDbyw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3451",name:"Felix余鑫",user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",external_total:"0",alias:"",is_bind_license:!0,group:[],ready_to_bind:0,license_type:"2"},{staff_id:"3450",name:"stone",user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3432",name:"彭建龙1",user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3167",name:"zhanglong",user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3149",name:"colson",user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3100",name:"sizz",user_id:"woX2IKEAAAEN39PCRL-cxrsgBhqdUmMg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"sizz",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3084",name:"fred",user_id:"woX2IKEAAAcN5qt6p6gBLbFMC0i8VFuQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3083",name:"王小鹏测试机",user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"2481",name:"钱楚",user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1893",name:"老贾",user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1889",name:"王进华",user_id:"woX2IKEAAAzc9fAQaEkE63j_g5SeXo6Q",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"Fox",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1888",name:"时光",user_id:"woX2IKEAAAe7bfgnclYNTM512bBfODtg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2}]}};if(this.staff_list_Loading=!1,e.data&&e.data.list&&e.data.list.length){e.data.list.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.list=e.data.list.filter((e=>e[this.filterStaff.key]==this.filterStaff.value)));let t=t=>{e.data.list.forEach((e=>{t.includes(e.staff_id)&&(this.department_ids.forEach((t=>{let s=t+"_"+e.staff_id;this.currSelectKeys.includes(s)||this.currSelectKeys.push(s)})),this.setTreeKeys())}))};return t(this.selectData.map((e=>e.staff_id))),this.currTotal=e.data.pagination.total,Promise.resolve(e.data.list)}return Promise.resolve([])},getCurrStaffList(e){let t={page:1,size:1e3,department_id:e.department_id};return this.isSession&&(t.is_session=this.isSession),this.excludeRole&&(t.exclude_role=this.excludeRole),this.bind_type&&(t.bind_type=this.bind_type),this.group_chat&&(t.group_chat=this.group_chat),this.viewAppointPermissions&&(t.permission_staff_ids=this.viewAppointPermissions),this.$api.user_get_staff_list(t).then((e=>Promise.resolve(e.data.list))).catch((e=>Promise.resolve([])))},sessionCheck(e){this.showTree=!1,setTimeout((e=>{this.showTree=!0}),500)},openSeat(){window.open("/manage/index#/seatManage")}}};const Me=(0,fe.A)(Ge,[["render",Pe],["__scopeId","data-v-2130d9e8"]]);var ze=Me;const He={class:"cont fx-ac",style:{"margin-top":"10px"}};function Ve(e,t,s,i,l,r){const d=(0,a.g2)("a-input"),o=(0,a.g2)("a-modal");return(0,a.uX)(),(0,a.Wv)(o,{open:l.visible,"onUpdate:open":t[1]||(t[1]=e=>l.visible=e),"confirm-loading":l.confirmLoading,onOk:r.handleOk,width:"472px",onCancel:r.handleCancel},{default:(0,a.k6)((()=>[t[3]||(t[3]=(0,a.Lk)("div",{slot:"title",class:"fx-ac"},[(0,a.Lk)("div",{class:"fir-tit"},"创建标签"),(0,a.Lk)("div",{class:"sec-tit"},"确定将当前已选员工新建标签？")],-1)),(0,a.Lk)("div",He,[t[2]||(t[2]=(0,a.Lk)("div",{class:"fir fx-ac"},[(0,a.Lk)("span",null,"*"),(0,a.eW)("标签名称：")],-1)),(0,a.bF)(d,{maxLength:32,style:{width:"262px"},modelValue:l.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.name=e),modelModifiers:{trim:!0},placeholder:"请输入标签名称"},null,8,["modelValue"])])])),_:1},8,["open","confirm-loading","onOk","onCancel"])}var Je=s(7277);const qe={user_get_corp_group_list:(e={})=>Je.Ay.post("/user/get-corp-group-list",e),user_edit_corp_group:(e={})=>Je.Ay.post("/user/edit-corp-group",e),user_add_corp_group:(e={})=>Je.Ay.post("/user/add-corp-group",e),user_del_corp_group:(e={})=>Je.Ay.post("/user/del-corp-group",e),user_get_staff_list:(e={})=>Je.Ay.get("/user/get-staff-list",{params:e}),user_get_simple_staff_list:(e={})=>Je.Ay.get("/user/get-simple-staff-list",{params:e}),user_add_group_member:(e={})=>Je.Ay.post("/user/add-group-member",e),user_remove_staff_group:(e={})=>Je.Ay.post("/user/remove-staff-group",e),user_get_group_by_staff:(e={})=>Je.Ay.post("/user/get-group-by-staff",e),user_get_corp_group_list_by_page:(e={})=>Je.Ay.post("/user/get-corp-group-list-by-page",e),getDepartmentList:(e={})=>Je.Ay.get("/user/get-department-list",{params:e}),getStaffGroupList:(e={})=>Je.Ay.get("/user/get-staff-group-list",{params:e}),bookTagGetLocalTagList:(e={})=>Je.Ay.get("/corp-address-book-tag/get-local-tag-list",{params:e}),bookTagAddTag:(e={})=>Je.Ay.post("/corp-address-book-tag/add-tag",e),bookTagDelTag:(e={})=>Je.Ay.post("/corp-address-book-tag/delete-tag",e),bookTagEditTag:(e={})=>Je.Ay.post("/corp-address-book-tag/edit-tag",e),bookTagAddStaff:(e={})=>Je.Ay.post("/corp-address-book-tag/add-staff-to-tag",e),bookTagGetTagStaff:(e={})=>Je.Ay.get("/corp-address-book-tag/get-local-staff-list-by-tag",{params:e}),bookTagDelTagStaff:(e={})=>Je.Ay.post("/corp-address-book-tag/remove-staff-from-tag",e),bookTagGetAllTagStaff:(e={})=>Je.Ay.get("/corp-address-book-tag/get-tag-staff-list",{params:e})};var je=qe,Ze={name:"",data(){return{visible:!1,name:"",confirmLoading:!1,staff:[]}},mounted(){},methods:{show(e){this.staff=e,this.name="",this.visible=!0},handleOk(){if(!this.name)return this.$message.error("请输入标签名称");this.createName().then((e=>{this.confirmLoading=!0,je.bookTagAddStaff({tag_id:e,staff_id_list:this.staff.map((e=>e.staff_id)).join(",")}).then((t=>{if(this.confirmLoading=!1,0==t.res)return this.$message.success("操作成功"),this.handleCancel(),void this.$emit("initFunc",e);this.$message.error(t.msg)})).catch((e=>{this.confirmLoading=!1}))}))},createName(){return new Promise(((e,t)=>{this.confirmLoading=!0,je.bookTagAddTag({tag_name:this.name}).then((s=>{this.confirmLoading=!1,0!=s.res?(t(),this.$message.error(s.msg)):e(s.data)})).catch((e=>{t(),this.confirmLoading=!1}))}))},handleCancel(){this.visible=!1}}};const $e=(0,fe.A)(Ze,[["render",Ve],["__scopeId","data-v-38a89d7f"]]);var et=$e,tt={name:"selectStaffNew",components:{allStaff:pe,newFramework:ze,addTag:et},props:{addPeopleShow:{type:Boolean,default:function(){return!1}},addConfirmLoading:{type:Boolean,default:function(){return!1}},title:{type:String,default:function(){return""}},selectType:{type:String,default:function(){return""}},isSession:{default:""},excludeRole:{default:""},bind_type:{default:""},filterStaff:{type:Object,default:function(){return{}}},group_chat:{default:""},emptyCanClose:{default:!1},isAuthMode:{default:!1},viewAppointPermissions:{type:Array,default:()=>[]},maxStaffNum:{type:Number,default:-1}},data(){return{staff_list:[],staff_list_params:{page:0,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,pageStaffSize:50,selectData:[],selectDataAll:[],searchSelectData:[],selectOnSearchVal:"",alreadyAddPeopeList:[],selectDataShow:!0,oldData:null,newData:null,tabAcitive:1,big_spinning:!1,funcShow:!1,hasSetEditData:!1,hideTagName:"",batchDelTime:null,staffNameMap:{}}},computed:{bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0},dialogShow(){return this.addPeopleShow||this.funcShow},showStatus(){let e=!0;return e}},watch:{tabAcitive(){localStorage.setItem("select-staff-tab",this.tabAcitive)}},created(){let e=localStorage.getItem("select-staff-tab");e&&(this.tabAcitive=isNaN(1*e)?1:1*e)},methods:{modalATitle(){console.log("刷新"),this.$refs.tabRef_1.addPeopleSearch()},async show(e){if(clearInterval(this.batchDelTime),this.pageStaffSize=50,this.funcShow=!0,e&&Array.isArray(e)){let t=Date.now();this.hasSetEditData=!0,e.forEach((e=>{e.data_type=1,e.id=t++})),this.selectDataAll=e,this.selectData=this.selectDataAll.slice(0,this.pageStaffSize)}},dragstart(e){this.oldData=e},dragenter(e,t){this.newData=e,t.preventDefault()},dragend(e,t){if(this.oldData!==this.newData){let e=this.selectData.indexOf(this.oldData),t=this.selectDataAll.indexOf(this.oldData),s=this.selectData.indexOf(this.newData),a=this.selectDataAll.indexOf(this.newData),i=[...this.selectData],l=[...this.selectDataAll];i.splice(e,1),l.splice(t,1),i.splice(s,0,this.oldData),l.splice(a,0,this.oldData),this.selectData=[...i],this.selectDataAll=[...l]}},dragover(e){e.preventDefault()},setSelect(e){let t=Date.now();if(this.maxStaffNum>-1&&e.length>this.maxStaffNum&&(e=e.slice(0,this.maxStaffNum),this.$emit("limit")),this.selectDataAll=e.map((e=>{e.id=t++})),this.selectOnSearchVal){let e=this.selectDataAll.filter((e=>-1!==e.name.indexOf(this.selectOnSearchVal)));this.searchSelectData=e}this.selectDataAll=e,this.selectData=e.slice(0,e.length>50?this.selectData.length:this.pageStaffSize)},setLoading(e){this.big_spinning=e},setScrollbarClear(){this.$nextTick((()=>{this.$refs.scrollbarRef&&this.$refs.scrollbarRef.wrap&&(this.$refs.scrollbarRef.wrap.scrollTop=0)})),this.selectDataAll=[],this.batchDelData()},batchDelData(){this.batchDelTime&&clearInterval(this.batchDelTime),this.batchDelTime=setInterval((()=>{0!=this.selectData.length?this.selectData.splice(0,100):clearInterval(this.batchDelTime)}),500)},addPeopleHandleCancel(e){this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancel"),this.$emit("cancelSelect")},selectDelete(e,t){let s=this.selectData.findIndex((t=>t.id===e.id));if(this.searchSelectData.length){this.searchSelectData.splice(s,1);let t=this.selectData.map((e=>e.userid));this.selectData.splice(t.indexOf(e.userid),1),this.selectDataAll.splice(t.indexOf(e.userid),1)}else this.selectData.splice(s,1),this.selectDataAll.splice(s,1);console.log("ss",e,t),this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,s,t)},deleteAll(){console.log("ss1",this.selectDataAll),this.selectDataAll.forEach(((e,t)=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,t,e.data_type)})),this.selectData=[],this.selectDataAll=[]},selectOnSearch(e){if(!e)return void(this.searchSelectData=[]);let t=this.selectDataAll.filter((t=>-1!==t.name.indexOf(e)));this.searchSelectData=t},addPeopleHandleOk(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],s=[];e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),s.push(e))})),this.$emit("selectStaff",s),this.$emit("change",s),this.emptyCanClose&&0==s.length||(this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancleSelect"))},setOldData(e){e.length&&this.$api.setLatelyChooseUser({user_id:e.map((e=>e.userid))}).then((e=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].getOldData()}))},createTag(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],s=[];return e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),s.push(e))})),s.length?s.some((e=>!e.userid))?this.$message.warning("选择的员工数据userid为空"):void this.$refs.addTagRef.show(s):this.$message.warning("请选择员工")},initMemberTag(e){e&&this.$emit("initFunc",e),this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].initMember(),"/staffManage"==this.$route.path&&(this.funcShow=!1)},hideTag(e){this.hideTagName=e,setTimeout((()=>{this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].$refs.elTreeRef_2.filter(e)}),500)},scrollLoad(){this.selectData.length!=this.selectDataAll.length&&(this.selectData=this.selectData.concat(this.selectDataAll.slice(this.selectData.length,this.selectData.length+this.pageStaffSize)))}},beforeUnmount(){clearInterval(this.batchDelTime)}};const st=(0,fe.A)(tt,[["render",K],["__scopeId","data-v-14ca2758"]]);var at=st},14379:function(e,t,s){s.d(t,{A:function(){return p}});var a=s(56768),i=s(24232),l=s(90144);const r=["id"],d={key:0,class:"loading-box"},o={class:"zm-list-content"},n={key:1,class:"loading-box bottom"};var c={__name:"zmScroll",props:{immediate:{type:Boolean,default:!0},loading:{type:Boolean},loadType:{type:String,default:"down"},finished:{type:Boolean},offsets:{type:Number,default:50},showLoading:{type:Boolean,default:!0},showScrollbar:{type:Boolean,default:!1}},emits:["load"],setup(e,{expose:t,emit:s}){const c=e,f=s,h=(0,l.KR)(""),p=(0,l.KR)(!1),_=(0,l.KR)(!1);(0,a.sV)((()=>{h.value="zm-scroll-"+Date.now()*Math.floor(1e4*Math.random()),c.immediate&&f("load")})),(0,a.wB)((()=>c.loading),(()=>{c.loading||c.finished||(0,a.dY)((()=>{p.value=g(),p.value||f("load")}))}));const g=()=>{const e=window.document.getElementById(h.value);return e.scrollHeight>e.offsetHeight},u=e=>{if(c.finished||c.loading||_.value)return;const{scrollTop:t,scrollHeight:s,offsetHeight:a}=e.target;"down"===c.loadType?t+a>=s-c.offsets&&f("load"):"up"===c.loadType&&t<=c.offsets&&f("load")},m=()=>window.document.getElementById(h.value),A=()=>{const e=m();_.value=!0,e.scrollTop=e.scrollHeight,setTimeout((()=>{_.value=!1}),500)},y=e=>{const t=m();_.value=!0,t.scrollTop=e,setTimeout((()=>{_.value=!1}),200)};return t({getListDom:m,scrollToBottom:A,setScrollTop:y}),(t,s)=>{const l=(0,a.g2)("a-spin");return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["zm-list-container",{"hide-scrollbar":!e.showScrollbar}]),id:h.value,onScroll:u},[e.showLoading&&"up"===e.loadType?((0,a.uX)(),(0,a.CE)("div",d,[e.loading?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(l,{size:"small"}),s[0]||(s[0]=(0,a.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)("已经到顶了")],64)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),(0,a.Lk)("div",o,[(0,a.RG)(t.$slots,"default")]),e.showLoading&&"down"===e.loadType?((0,a.uX)(),(0,a.CE)("div",n,[e.loading?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(l,{size:"small"}),s[1]||(s[1]=(0,a.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)("已经到底了")],64)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)],42,r)}}},f=s(71241);const h=(0,f.A)(c,[["__scopeId","data-v-4c97411c"]]);var p=h}}]);