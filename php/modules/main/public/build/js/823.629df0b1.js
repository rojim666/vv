"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[823],{8292:function(e,a,l){l.d(a,{A:function(){return k}});var t=l(56768);const c={class:"loading-box"};function n(e,a){const l=(0,t.g2)("a-spin");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(l)])}var s=l(71241);const i={},o=(0,s.A)(i,[["render",n],["__scopeId","data-v-3d53ffb8"]]);var k=o},49798:function(e,a,l){l.r(a),l.d(a,{default:function(){return D}});var t=l(56768),c=l(90144),n=l(43834),s=l(15374),i=l(24232),o=l(60782),k=l(7403),u=l(17694),r=l(41824),_=l(8298),v=l(8292);const b={class:"main-content"},d={class:"content mt24"},p={key:1,class:"form-block"},h={class:"form-block-item"},m={class:"form-block-content"},f={class:"form-block-item"},y={class:"form-block-content"},L={class:"text-center"},g={class:"form-block-item"},F={class:"form-block-content"},A={class:"text-center"},E={key:2,class:"text-center status-box"};var C={__name:"corpConfigForm",setup(e){const a=(0,o.Pj)(),l=(0,c.KR)(0),n=(0,c.KR)(1),s=(0,c.KR)(!1),C=(0,c.KR)(!1),w=(0,c.KR)([{title:"企业信息"},{title:"配置接收事件服务器"},{title:"完成"}]),R=(0,t.EW)((()=>a.getters.getCorpId)),K=(0,c.Kh)({chat_public_key:"",chat_private_key:"",chat_public_key_version:"",chat_secret:""}),W=(0,c.Kh)({url:"",callback_event_token:"",callback_event_aes_key:""});(0,t.sV)((()=>{s.value=!0,(0,r.lG)().then((e=>{K.chat_public_key=e.data.public_key,K.chat_private_key=e.data.private_key})).finally((()=>{s.value=!1})),(0,r.y9)().then((e=>{W.callback_event_token=e.data.token,W.callback_event_aes_key=e.data.aes_key,W.url=window.location.origin+"/openpush/qw/"+R.value}))}));const X=()=>{try{switch(C.value=!0,l.value){case 0:if(K.chat_secret=K.chat_secret.trim(),!K.chat_public_key||!K.chat_private_key)throw"缺少密钥信息";if(!K.chat_secret)throw"请输入会话存档密钥";if(!K.chat_public_key)throw"请输入公钥版本号";(0,r.ip)(K).then((()=>{l.value+=1})).finally((()=>{C.value=!1}));break;case 1:(0,r.XT)(W).then((e=>{l.value+=1,n.value=1})).finally((()=>{C.value=!1}));break}}catch(e){u.Ay.error(e),C.value=!1}};return(e,a)=>{const n=(0,t.g2)("a-steps"),o=(0,t.g2)("a-form-item"),u=(0,t.g2)("a-input"),r=(0,t.g2)("a-input-number"),R=(0,t.g2)("a-button"),z=(0,t.g2)("router-link"),D=(0,t.g2)("a-form");return(0,t.uX)(),(0,t.CE)("div",b,[a[17]||(a[17]=(0,t.Lk)("div",{class:"title"},[(0,t.eW)(" 使用前请按照步骤正确完成配置 "),(0,t.Lk)("a",{class:"ml16",href:"http://zhimahuihua.com/docs/integration/#%E4%BC%9A%E8%AF%9D%E5%AD%98%E6%A1%A3%E7%9A%84%E9%85%8D%E7%BD%AE%E6%B5%81%E7%A8%8B",target:"_blank"},"如何配置?")],-1)),(0,t.Lk)("div",d,[(0,t.bF)(n,{current:l.value,items:w.value},null,8,["current","items"]),(0,t.bF)(D,{class:"mt24",model:K,name:"basic","label-col":{span:6},"wrapper-col":{span:14},autocomplete:"off"},{default:(0,t.k6)((()=>[s.value?((0,t.uX)(),(0,t.Wv)(v.A,{key:0})):((0,t.uX)(),(0,t.CE)("div",p,[0==l.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("div",h,[a[7]||(a[7]=(0,t.Lk)("div",{class:"form-block-title"}," 复制以下信息并填入到企业微信后台 ",-1)),(0,t.Lk)("div",m,[(0,t.bF)(o,{label:"加密公钥",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"c595959 zm-pointer",onClick:a[0]||(a[0]=e=>(0,c.R1)(_.Dk)(K.chat_public_key))},[a[6]||(a[6]=(0,t.Lk)("a",null,"点击复制",-1)),(0,t.Lk)("pre",null,(0,i.v_)(K.chat_public_key),1)])])),_:1})])]),(0,t.Lk)("div",f,[a[8]||(a[8]=(0,t.Lk)("div",{class:"form-block-title"},"将企业微信后台会话存档配置页面的信息复制粘贴到下框中",-1)),(0,t.Lk)("div",y,[(0,t.bF)(o,{label:"会话存档密钥",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{value:K.chat_secret,"onUpdate:value":a[1]||(a[1]=e=>K.chat_secret=e),placeholder:"请输入会话存档密钥"},null,8,["value"])])),_:1}),(0,t.bF)(o,{label:"公钥版本号",name:"corp_id"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{style:{width:"100%"},precision:0,value:K.chat_public_key_version,"onUpdate:value":a[2]||(a[2]=e=>K.chat_public_key_version=e),placeholder:"请输入公钥版本号"},null,8,["value"])])),_:1})])]),(0,t.Lk)("div",L,[(0,t.bF)(R,{type:"primary",class:"main-btn",onClick:X,loading:C.value},{default:(0,t.k6)((()=>a[9]||(a[9]=[(0,t.eW)("验证配置信息 ")]))),_:1},8,["loading"])])],64)):1==l.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.Lk)("div",g,[a[13]||(a[13]=(0,t.Lk)("div",{class:"form-block-title"}," 将以下信息复制到企微后台-应用管理-接收消息服务器中 ",-1)),(0,t.Lk)("div",F,[(0,t.bF)(o,{label:"URL",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:a[3]||(a[3]=e=>(0,c.R1)(_.Dk)(W.url))},[a[10]||(a[10]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,i.v_)(W.url),1)])])),_:1}),(0,t.bF)(o,{label:"token",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:a[4]||(a[4]=e=>(0,c.R1)(_.Dk)(W.callback_event_token))},[a[11]||(a[11]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,i.v_)(W.callback_event_token),1)])])),_:1}),(0,t.bF)(o,{label:"encodingAESSKey",class:"label-height-unset"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"zm-pointer",onClick:a[5]||(a[5]=e=>(0,c.R1)(_.Dk)(W.callback_event_aes_key))},[a[12]||(a[12]=(0,t.Lk)("div",null,[(0,t.Lk)("a",null,"点击复制")],-1)),(0,t.eW)(" "+(0,i.v_)(W.callback_event_aes_key),1)])])),_:1})])]),(0,t.Lk)("div",A,[(0,t.bF)(R,{type:"primary",class:"main-btn",onClick:X,loading:C.value},{default:(0,t.k6)((()=>a[14]||(a[14]=[(0,t.eW)("完成")]))),_:1},8,["loading"])])],64)):2==l.value?((0,t.uX)(),(0,t.CE)("div",E,[(0,t.bF)((0,c.R1)(k.A),{style:{color:"#21A665","font-size":"60px"}}),a[16]||(a[16]=(0,t.Lk)("div",{class:"status-title mt16"},"验证成功",-1)),(0,t.bF)(z,{to:"/index"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{class:"mt32",type:"primary"},{default:(0,t.k6)((()=>a[15]||(a[15]=[(0,t.eW)("去使用")]))),_:1})])),_:1})])):(0,t.Q3)("",!0)]))])),_:1},8,["model"])])])}}},w=l(71241);const R=(0,w.A)(C,[["__scopeId","data-v-99769814"]]);var K=R;const W={class:"_main-container"};var X={__name:"auth",setup(e){(0,c.KR)(0);return(e,a)=>((0,t.uX)(),(0,t.CE)("div",W,[(0,t.bF)(n.A),(0,t.bF)(K),(0,t.bF)(s.A)]))}};const z=(0,w.A)(X,[["__scopeId","data-v-15e5cb3a"]]);var D=z}}]);