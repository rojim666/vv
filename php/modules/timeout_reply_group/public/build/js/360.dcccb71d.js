"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[360],{8812:function(e,t,n){n.d(t,{Ao:function(){return c},C6:function(){return i},EX:function(){return a},Q4:function(){return r},XP:function(){return l},ji:function(){return p},lS:function(){return o},sn:function(){return s},uM:function(){return d}});var u=n(7277);const a=e=>u.Ay.get("/modules/timeout_reply_group/api/reply-rules",{params:e}),i=e=>u.Ay.post("/modules/timeout_reply_group/api/reply-rules",e),r=e=>u.Ay.get("/modules/timeout_reply_group/api/rules",{params:e}),l=e=>u.Ay.post("/modules/timeout_reply_group/api/rules",e),o=e=>u.Ay.get(`/modules/timeout_reply_group/api/rules/${e}`),s=e=>u.Ay.delete(`/modules/timeout_reply_group/api/rules/${e}`),c=(e,t)=>u.Ay.put(`/modules/timeout_reply_group/api/rules/${e}`,t),d=e=>u.Ay.put(`/modules/timeout_reply_group/api/rules/${e}/enable`),p=e=>u.Ay.put(`/modules/timeout_reply_group/api/rules/${e}/disable`)},9660:function(e,t,n){n.d(t,{v:function(){return a},z:function(){return i}});n(4114);var u=n(8298);function a(e){return e.map((e=>{let t=e.time_period_list.map((e=>({times:[e.start,e.end]})));return{week:e.week_day_list,ranges:t}}))}function i(e){switch(Number(e.inspect_time_type.value)){case 1:return"全天";case 2:return"工作时间";case 3:let t,n,a=[];return e.custom_time_list.map((e=>{t=[],n=[],e.week_day_list.map((e=>t.push((0,u.bG)(e)))),e.time_period_list.map((e=>n.push(`${e.start}~${e.end}`))),a.push(`${t.join("、")} ${n.join(" ")}`)})),a}}},3140:function(e,t,n){n.d(t,{A:function(){return d}});var u=n(6768),a=(n(4114),n(144)),i=n(1387),r={__name:"zmNavTabs",props:{active:{type:[Number,String]},tabs:{type:Array,required:!0}},setup(e){const t=(0,i.rd)(),n=(0,a.KR)("index"),r=e;function l(){const e=r.tabs.find((e=>e.key===n.value));e.route&&t.push({path:e.route})}return(0,u.sV)((()=>{r.active?n.value=r.active:n.value=r.tabs[0]?.key})),(t,a)=>{const i=(0,u.g2)("a-tab-pane"),r=(0,u.g2)("a-tabs");return(0,u.uX)(),(0,u.Wv)(r,{"active-key":n.value,"onUpdate:activeKey":a[0]||(a[0]=e=>n.value=e),onChange:l,class:"zm-nav-tabs"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.tabs,(e=>((0,u.uX)(),(0,u.Wv)(i,{key:e.key,tab:e.title},null,8,["tab"])))),128))])),_:1},8,["active-key"])}}};const l=r;var o=l,s={__name:"mainNav",props:{active:{type:[Number,String]}},setup(e){const t=[{key:"index",title:"群聊超时",route:"/module/timeout-reply-group/index"},{key:"rule",title:"回复规则",route:"/module/timeout-reply-group/rule"}];return(n,a)=>((0,u.uX)(),(0,u.Wv)(o,{tabs:t,active:e.active},null,8,["active"]))}};const c=s;var d=c},1360:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});n(4114);var u=n(6768),a=n(144),i=n(4232),r=n(1387),l=n(7423),o=n(7694),s=n(3536),c=n(3140),d=n(8812),p=(n(8298),n(9660));const _={class:"zm-main-content"},m={class:"mt16"},v={class:"zm-line-clamp2"},k=["innerHTML"],y={key:1},g=["onClick"],f=["onClick"];var h={__name:"index",setup(e){const t=(0,r.rd)(),n=(0,a.KR)(!1),h=(0,a.KR)([{title:"规则名称",dataIndex:"name",width:160},{title:"群聊",dataIndex:"group_name",width:160},{title:"质检时间",dataIndex:"check_time_text",width:160},{title:"提醒规则",dataIndex:"notice_rule",width:160},{title:"提醒员工",dataIndex:"notice_staff",width:160},{title:"状态",dataIndex:"enabled",width:110},{title:"操作",dataIndex:"operate",width:110,fixed:"right"}]),b=(0,a.KR)([]),C=(0,a.Kh)({total:0,current:1,pageSize:50,showSizeChanger:!0,pageSizeOptions:["50","100","300","500"]});function x(){b.value=[],C.current=1,C.total=0,X()}function X(){n.value=!0,(0,d.Q4)({page:C.current,size:C.pageSize}).then((e=>{let t=e.data.items||[];t.map((e=>{e.group_name=z(e),e.check_time_text=(0,p.z)(e),e.notice_rules=E(e)})),b.value=t,C.total=Number(e.data.total)})).finally((()=>{n.value=!1}))}function w(e){Object.assign(C,e),X()}function A(){t.push({path:"/module/timeout-reply-group/store"})}function I(e){t.push({path:"/module/timeout-reply-group/store",query:{rule_id:e.id}})}function z(e){let t;switch(Number(e.group_type.value)){case 1:return t=e.group_chat_id_detail_list.map((e=>e.name||"未命名客户群")),t.toString();case 2:return t=e.group_staff_user_list.map((e=>e.name)),`当员工${t.toString()}在群内时关注该群`;case 3:return e?.group_keyword_list?.include_list?.length>0&&(t=`当群名包含关键词：”${e.group_keyword_list.include_list.toString()}“`),e?.group_keyword_list?.exclude_list.length>0&&(t+=`且不包含关键词：”${e.group_keyword_list.exclude_list.toString()}“时`),t+="关注该群",t}}function E(e){let t=[],n=[];return e.remind_rules.map((e=>{if(t=[],e.is_remind_staff_designation){let n=e.designate_remind_user_list.map((e=>e.name||"..."));t.push(n.toString())}e.is_remind_group_member&&t.push("群内员工"),n.push({rule:`超过${e.timeout_value}分钟发送提醒`,staff:t})})),n}function $(e){let t,n;e.enabled?(n=d.uM,t="开启"):(n=d.ji,t="关闭");const u=()=>e.enabled=!e.enabled;l.A.confirm({title:"提示",content:`确认${t}该规则`,onOk:()=>{n(e.id).then((e=>{o.Ay.success(`已${t}`),X()})).catch((()=>{u()}))},onCancel:()=>{u()}})}function K(e){l.A.confirm({title:"提示",content:"确认删除该规则？",onOk:()=>{(0,d.sn)(e.id).then((e=>{o.Ay.success("操作完成"),X()}))}})}return(0,u.sV)((()=>{x()})),(e,t)=>{const r=(0,u.g2)("a-alert"),l=(0,u.g2)("a-button"),o=(0,u.g2)("a-tooltip"),d=(0,u.g2)("a-switch"),p=(0,u.g2)("a-table");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(c.A,{active:"index"}),(0,u.Lk)("div",_,[(0,u.bF)(r,{class:"zm-custom-alert",type:"info","show-icon":""},{message:(0,u.k6)((()=>t[0]||(t[0]=[(0,u.Lk)("div",{class:"fw600"},"功能说明：",-1),(0,u.Lk)("div",null,"当群里的客户发送消息员工未回复时，可设置给群主，指定员工或者是群内员工发送未回复提醒，员工可及时回复并处理",-1)]))),_:1}),(0,u.Lk)("div",m,[(0,u.bF)(l,{type:"primary",icon:(0,u.h)((0,a.R1)(s.A)),onClick:A},{default:(0,u.k6)((()=>t[1]||(t[1]=[(0,u.eW)("新增规则")]))),_:1},8,["icon"]),(0,u.bF)(p,{class:"mt8",loading:n.value,"data-source":b.value,columns:h.value,pagination:C,onChange:w,scroll:{x:1400}},{bodyCell:(0,u.k6)((({column:e,text:t,record:n})=>["group_name"===e.dataIndex?((0,u.uX)(),(0,u.Wv)(o,{key:0,title:n.group_name},{default:(0,u.k6)((()=>[(0,u.Lk)("div",v,(0,i.v_)(n.group_name),1)])),_:2},1032,["title"])):"enabled"===e.dataIndex?((0,u.uX)(),(0,u.Wv)(d,{key:1,checked:n.enabled,"onUpdate:checked":e=>n.enabled=e,onChange:e=>$(n),"checked-children":"开","un-checked-children":"关"},null,8,["checked","onUpdate:checked","onChange"])):"check_time_text"===e.dataIndex?((0,u.uX)(),(0,u.CE)(u.FK,{key:2},[Array.isArray(t)?((0,u.uX)(),(0,u.Wv)(o,{key:0},{title:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(t,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t},(0,i.v_)(e),1)))),128))])),default:(0,u.k6)((()=>[(0,u.Lk)("div",{class:"zm-line-clamp1",innerHTML:t.join("<br/>")},null,8,k)])),_:2},1024)):((0,u.uX)(),(0,u.CE)("span",y,(0,i.v_)(t),1))],64)):"notice_rule"===e.dataIndex?((0,u.uX)(),(0,u.Wv)(o,{key:3},{title:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.notice_rules,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t},(0,i.v_)(e.rule),1)))),128))])),default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.notice_rules,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t,class:"zm-line-clamp1"},(0,i.v_)(e.rule),1)))),128))])),_:2},1024)):"notice_staff"===e.dataIndex?((0,u.uX)(),(0,u.Wv)(o,{key:4},{title:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.notice_rules,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t},"规则"+(0,i.v_)(t+1)+"："+(0,i.v_)(e.staff.join("、")),1)))),128))])),default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.notice_rules,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t,class:"zm-line-clamp1"},"规则"+(0,i.v_)(t+1)+"："+(0,i.v_)(e.staff.join("、")),1)))),128))])),_:2},1024)):"operate"===e.dataIndex?((0,u.uX)(),(0,u.CE)(u.FK,{key:5},[(0,u.Lk)("a",{onClick:e=>I(n)},"编辑",8,g),(0,u.Lk)("a",{class:"ml16",onClick:e=>K(n)},"删除",8,f)],64)):(0,u.Q3)("",!0)])),_:1},8,["loading","data-source","columns","pagination"])])])])}}},b=n(1241);const C=(0,b.A)(h,[["__scopeId","data-v-259953ef"]]);var x=C}}]);