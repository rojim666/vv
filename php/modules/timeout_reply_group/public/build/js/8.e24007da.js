"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[8],{8812:function(e,t,a){a.d(t,{Ao:function(){return c},C6:function(){return l},EX:function(){return i},Q4:function(){return n},XP:function(){return d},ji:function(){return u},lS:function(){return r},sn:function(){return o},uM:function(){return h}});var s=a(7277);const i=e=>s.Ay.get("/modules/timeout_reply_group/api/reply-rules",{params:e}),l=e=>s.Ay.post("/modules/timeout_reply_group/api/reply-rules",e),n=e=>s.Ay.get("/modules/timeout_reply_group/api/rules",{params:e}),d=e=>s.Ay.post("/modules/timeout_reply_group/api/rules",e),r=e=>s.Ay.get(`/modules/timeout_reply_group/api/rules/${e}`),o=e=>s.Ay.delete(`/modules/timeout_reply_group/api/rules/${e}`),c=(e,t)=>s.Ay.put(`/modules/timeout_reply_group/api/rules/${e}`,t),h=e=>s.Ay.put(`/modules/timeout_reply_group/api/rules/${e}/enable`),u=e=>s.Ay.put(`/modules/timeout_reply_group/api/rules/${e}/disable`)},9660:function(e,t,a){a.d(t,{v:function(){return i},z:function(){return l}});a(4114);var s=a(8298);function i(e){return e.map((e=>{let t=e.time_period_list.map((e=>({times:[e.start,e.end]})));return{week:e.week_day_list,ranges:t}}))}function l(e){switch(Number(e.inspect_time_type.value)){case 1:return"全天";case 2:return"工作时间";case 3:let t,a,i=[];return e.custom_time_list.map((e=>{t=[],a=[],e.week_day_list.map((e=>t.push((0,s.bG)(e)))),e.time_period_list.map((e=>a.push(`${e.start}~${e.end}`))),i.push(`${t.join("、")} ${a.join(" ")}`)})),i}}},1509:function(e,t,a){a.d(t,{A:function(){return S}});a(4114);var s=a(6768),i=a(4232),l=a(144),n=a(2281),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},r=d,o=a(4827);function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),s.forEach((function(t){h(e,t,a[t])}))}return e}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=function(e,t){var a=c({},e,t.attrs);return(0,s.bF)(o.A,c({},a,{icon:r}),null)};u.displayName="PlusCircleOutlined",u.inheritAttrs=!1;var p=u,g=a(5226),f=a(3536),_=a(8298);const m={class:"times-range-container"},k={class:"time-range-title"},v={class:"text"},A={class:"time-range-body"},y={class:"times"},b={class:"operator-box ml8"};var C={__name:"timesRange",props:{limit:{type:Number,default:5},timeLimit:{type:Number,default:5},disabled:{type:Boolean,default:!1},showAddBtn:{type:Boolean,default:!0}},emits:["change"],setup(e,{expose:t,emit:a}){const d=a,r=e,o={times:[]},c={week:[],ranges:[(0,_.t0)(o)]},h=(0,l.KR)([{...c}]);function u(){h.value.length>=r.limit||(h.value.push((0,_.t0)(c)),E())}function C(e){r.disabled||1===h.value.length||(h.value.splice(e,1),E())}function L(e){r.disabled||e.ranges.length>=r.timeLimit||(e.ranges.push((0,_.t0)(o)),E())}function w(e,t){r.disabled||1===e.ranges.length||(e.ranges.splice(t,1),E())}function S(e,t){let a;for(let s=0;s<h.value.length;s++)if(a=h.value[s],s!==e&&a.week.includes(t.value))return!0;return!1}function x(){let e=(0,_.t0)(h.value);if(e=e.filter((e=>(e.times=e.ranges.filter((e=>e.times.length>0)),e.week.length>0&&e.times.length>0))),!e.length)return{ok:!1,error:"请至少完善一条时段规则"};for(let t of e){let e=t.ranges.map((e=>[(0,_.EF)(e.times[0]),(0,_.EF)(e.times[1])]));if((0,_.dj)(...e))return{ok:!1,error:"工作时间段存在重叠，请检查后重新选择"}}return{ok:!0}}function T(){let e=(0,_.t0)(h.value);return e=e.filter((e=>(e.times=e.ranges.filter((e=>e.times.length>0)),e.week=e.week.sort(),e.week.length>0&&e.times.length>0))),e}function I(e){e.length&&(h.value=e)}function E(){d("change")}return t({input:I,output:T,verify:x}),(t,a)=>{const d=(0,s.g2)("a-checkbox"),r=(0,s.g2)("a-checkbox-group"),o=(0,s.g2)("a-time-range-picker"),c=(0,s.g2)("a-button");return(0,s.uX)(),(0,s.CE)("div",m,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(h.value,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"time-range-item",key:a},[(0,s.Lk)("div",k,[(0,s.Lk)("span",v,"时间段"+(0,i.v_)(a+1),1),(0,s.bF)((0,l.R1)(n.A),{class:(0,i.C4)(["del",{disabled:e.disabled||h.value.length<2}]),onClick:e=>C(a)},null,8,["class","onClick"])]),(0,s.Lk)("div",A,[(0,s.bF)(r,{value:t.week,"onUpdate:value":e=>t.week=e,disabled:e.disabled,onChange:E},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,l.R1)(_.QM),(e=>((0,s.uX)(),(0,s.Wv)(d,{key:e.value,value:e.value,disabled:S(a,e)},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(e.label),1)])),_:2},1032,["value","disabled"])))),128))])),_:2},1032,["value","onUpdate:value","disabled"]),(0,s.Lk)("div",y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.ranges,((a,n)=>((0,s.uX)(),(0,s.CE)("div",{class:"time-item",key:n},[(0,s.bF)(o,{value:a.times,"onUpdate:value":e=>a.times=e,disabled:e.disabled,onChange:E,style:{width:"300px"},format:"HH:mm","value-format":"HH:mm","show-time":{format:"HH:mm"},placeholder:["开始时间","结束时间"]},null,8,["value","onUpdate:value","disabled"]),(0,s.Lk)("div",b,[(0,s.bF)((0,l.R1)(p),{class:(0,i.C4)(["add",{disabled:e.disabled||t.ranges.length>=e.timeLimit}]),onClick:e=>L(t)},null,8,["class","onClick"]),(0,s.bF)((0,l.R1)(g.A),{class:(0,i.C4)(["remove ml8",{disabled:e.disabled||t.ranges.length<2}]),onClick:e=>w(t,n)},null,8,["class","onClick"])])])))),128))])])])))),128)),e.showAddBtn?((0,s.uX)(),(0,s.Wv)(c,{key:0,disabled:e.disabled||h.value.length>=e.limit,type:"dashed",icon:(0,s.h)((0,l.R1)(f.A)),onClick:u,style:{width:"100%"}},{default:(0,s.k6)((()=>a[0]||(a[0]=[(0,s.eW)("添加时间段 ")]))),_:1},8,["disabled","icon"])):(0,s.Q3)("",!0)])}}},L=a(1241);const w=(0,L.A)(C,[["__scopeId","data-v-676c50b6"]]);var S=w},4379:function(e,t,a){a.d(t,{A:function(){return p}});var s=a(6768),i=a(4232),l=a(144);const n=["id"],d={key:0,class:"loading-box"},r={class:"zm-list-content"},o={key:1,class:"loading-box bottom"};var c={__name:"zmScroll",props:{immediate:{type:Boolean,default:!0},loading:{type:Boolean},loadType:{type:String,default:"down"},finished:{type:Boolean},offsets:{type:Number,default:50},showLoading:{type:Boolean,default:!0},showScrollbar:{type:Boolean,default:!1}},emits:["load"],setup(e,{expose:t,emit:a}){const c=e,h=a,u=(0,l.KR)(""),p=(0,l.KR)(!1),g=(0,l.KR)(!1);(0,s.sV)((()=>{u.value="zm-scroll-"+Date.now()*Math.floor(1e4*Math.random()),c.immediate&&h("load")})),(0,s.wB)((()=>c.loading),(()=>{c.loading||c.finished||(0,s.dY)((()=>{p.value=f(),p.value||h("load")}))}));const f=()=>{const e=window.document.getElementById(u.value);return e.scrollHeight>e.offsetHeight},_=e=>{if(c.finished||c.loading||g.value)return;const{scrollTop:t,scrollHeight:a,offsetHeight:s}=e.target;"down"===c.loadType?t+s>=a-c.offsets&&h("load"):"up"===c.loadType&&t<=c.offsets&&h("load")},m=()=>window.document.getElementById(u.value),k=()=>{const e=m();g.value=!0,e.scrollTop=e.scrollHeight,setTimeout((()=>{g.value=!1}),500)},v=e=>{const t=m();g.value=!0,t.scrollTop=e,setTimeout((()=>{g.value=!1}),200)};return t({getListDom:m,scrollToBottom:k,setScrollTop:v}),(t,a)=>{const l=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",{class:(0,i.C4)(["zm-list-container",{"hide-scrollbar":!e.showScrollbar}]),id:u.value,onScroll:_},[e.showLoading&&"up"===e.loadType?((0,s.uX)(),(0,s.CE)("div",d,[e.loading?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(l,{size:"small"}),a[0]||(a[0]=(0,s.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)("已经到顶了")],64)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),(0,s.Lk)("div",r,[(0,s.RG)(t.$slots,"default")]),e.showLoading&&"down"===e.loadType?((0,s.uX)(),(0,s.CE)("div",o,[e.loading?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(l,{size:"small"}),a[1]||(a[1]=(0,s.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)("已经到底了")],64)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)],42,n)}}},h=a(1241);const u=(0,h.A)(c,[["__scopeId","data-v-4c97411c"]]);var p=u},5548:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ks}});a(4114);var s=a(6768),i=a(144),l=a(5130),n=a(4232),d=a(1387),r=a(7694),o=a(5046),c=a(2281),h=a(3536);const u={class:"loading-box"};function p(e,t){const a=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",u,[(0,s.bF)(a)])}var g=a(1241);const f={},_=(0,g.A)(f,[["render",p],["__scopeId","data-v-3d53ffb8"]]);var m=_;const k={class:"_main-nav"},v={key:1,class:"title"};var A={__name:"mainNavbar",props:{title:{type:[Array,String]}},setup(e){return(t,a)=>{const i=(0,s.g2)("router-link"),l=(0,s.g2)("a-breadcrumb-item"),d=(0,s.g2)("a-breadcrumb");return(0,s.uX)(),(0,s.CE)("div",k,[Array.isArray(e.title)?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.title,((e,t)=>((0,s.uX)(),(0,s.Wv)(l,{key:t},{default:(0,s.k6)((()=>[e.route?((0,s.uX)(),(0,s.Wv)(i,{key:0,to:e.route},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.name),1)])),_:2},1032,["to"])):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)((0,n.v_)(e.name),1)],64))])),_:2},1024)))),128))])),_:1})):((0,s.uX)(),(0,s.CE)("div",v,(0,n.v_)(e.title),1))])}}};const y=(0,g.A)(A,[["__scopeId","data-v-b8774510"]]);var b=y,C=a(1509);const L={class:"fl-jsb-ac"},w={class:"main flex"},S={class:"left-box"},x={class:"list-header fx-ac-be"},T={class:"list-total"},I={key:1},E={class:"screen fx-ac"},F={key:0,class:"list",style:{"text-align":"center"}},D={key:1,class:"list"},K={class:"group-name"},X={class:"group-name"},G={class:"fx-ac"},B={class:"fx-ac"},W={class:"name omit"},R={class:"member"},U={class:"leader-num"},O={class:"group-name"},Q={class:"group-name"},N={class:"fx-ac"},M={class:"fx-ac"},P={class:"name omit"},z={class:"member"},H={class:"leader-num"},V={class:"group-page"},Y={class:"right-box flex1"},j={class:"right-header fx-ac-be"},J={class:"title"},q={class:"right-list"},$=["onDragstart","onDragenter","onDragend"],Z={class:"item-left fx-ac"},ee={key:0,class:"sort"},te={class:"title"},ae={class:"title"},se={class:"fx-ac"},ie={class:"fx-ac"},le={class:"name omit"},ne={class:"margin-left-18"},de={class:"leader-num"};function re(e,t,a,i,d,r){const o=(0,s.g2)("a-tab-pane"),c=(0,s.g2)("a-tabs"),h=(0,s.g2)("a-button"),u=(0,s.g2)("a-input-search"),p=(0,s.g2)("AccordingGroupManager"),g=(0,s.g2)("AccordingGroupTags"),f=(0,s.g2)("a-checkbox"),_=(0,s.g2)("a-spin"),m=(0,s.g2)("a-tooltip"),k=(0,s.g2)("a-radio"),v=(0,s.g2)("a-pagination"),A=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.Wv)(A,{open:d.visible,"onUpdate:open":t[5]||(t[5]=e=>d.visible=e),centered:"",onOk:r.handleOk,wrapClassName:"select-group-chat",destroyOnClose:!0,onCancel:r.clear,width:746},{title:(0,s.k6)((()=>[(0,s.bF)(c,{modelValue:d.active,"onUpdate:modelValue":t[0]||(t[0]=e=>d.active=e),onChange:r.tabChange},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.tabs,(e=>((0,s.uX)(),(0,s.Wv)(o,{key:e.value,tab:e.label,disabled:a.disabledTabSwitch},null,8,["tab","disabled"])))),128))])),_:1},8,["modelValue","onChange"])])),footer:(0,s.k6)((()=>[(0,s.Lk)("div",L,[(0,s.Lk)("div",null,[(0,s.eW)((0,n.v_)(a.promptTitle)+" ",1),(0,s.RG)(e.$slots,"footerLeft",{},void 0,!0)]),(0,s.Lk)("div",null,[(0,s.bF)(h,{key:"back",onClick:r.handleCancel},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)(" 取消 ")]))),_:1},8,["onClick"]),(0,s.bF)(h,{key:"submit",type:"primary",loading:d.loading,onClick:r.handleOk},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)(" 保存 ")]))),_:1},8,["loading","onClick"])])])])),default:(0,s.k6)((()=>[(0,s.RG)(e.$slots,"alert",{},void 0,!0),(0,s.Lk)("div",w,[(0,s.Lk)("div",S,[(0,s.bF)(u,{placeholder:"请输入群名称搜索",value:d.name,"onUpdate:value":t[1]||(t[1]=e=>d.name=e),onSearch:r.onSearch,allowClear:!0},null,8,["value","onSearch"]),(0,s.bo)((0,s.bF)(p,{active:d.active,getStaffList:d.staffList,disabledIds:a.disabledIds,viewAppointPermissions:a.viewAppointPermissions,onSearch:r.search},null,8,["active","getStaffList","disabledIds","viewAppointPermissions","onSearch"]),[[l.aG,"2"===d.active]]),(0,s.bo)((0,s.bF)(g,{active:d.active,getTags:d.tags,disabledIds:a.disabledIds,onSearch:r.search},null,8,["active","getTags","disabledIds","onSearch"]),[[l.aG,"3"===d.active]]),(0,s.Lk)("div",x,[(0,s.Lk)("div",T,[d.isMuti?((0,s.uX)(),(0,s.Wv)(f,{key:0,disabled:a.disabledIds.length>0,indeterminate:d.indeterminate,checked:d.checkAll,onChange:r.onCheckAllChange},{default:(0,s.k6)((()=>[t[8]||(t[8]=(0,s.eW)("共")),(0,s.Lk)("span",null,(0,n.v_)(d.total),1),t[9]||(t[9]=(0,s.eW)("个群聊 "))])),_:1},8,["disabled","indeterminate","checked","onChange"])):((0,s.uX)(),(0,s.CE)("span",I,[t[10]||(t[10]=(0,s.eW)(" 共")),(0,s.Lk)("span",null,(0,n.v_)(d.total),1),t[11]||(t[11]=(0,s.eW)("个群聊 "))]))]),(0,s.Lk)("div",E,[t[13]||(t[13]=(0,s.eW)(" 排序： ")),(0,s.Lk)("div",{class:"fx-ac margin-left-16 pointer",onClick:t[2]||(t[2]=e=>r.filtrate("buildGroupTime"))},t[12]||(t[12]=[(0,s.Lk)("span",null,"建群时间",-1)]))])]),d.dataLoading?((0,s.uX)(),(0,s.CE)("div",F,[(0,s.bF)(_,{spinning:d.dataLoading},null,8,["spinning"])])):((0,s.uX)(),(0,s.CE)("div",D,[d.isMuti?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(d.dataList,((e,i)=>((0,s.uX)(),(0,s.CE)("div",{class:"item",key:i},[(0,s.bF)(f,{value:e.chat_id,disabled:a.disabledIds.includes(e.chat_id),checked:d.selectedChatIds.includes(e.chat_id),onChange:t=>r.onChange(t,e)},{default:(0,s.k6)((()=>[(0,s.bF)(m,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",X,(0,n.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",K,(0,n.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",G,[(0,s.Lk)("div",B,[t[14]||(t[14]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",W,(0,n.v_)(e.owner_name),1)]),(0,s.Lk)("div",R,[t[15]||(t[15]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",U,(0,n.v_)(e.total_member),1)])])])),_:2},1032,["value","disabled","checked","onChange"])])))),128)):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(d.dataList,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"item",key:a},[(0,s.bF)(k,{value:e.chat_id,checked:d.selectedChatIds===e.chat_id,onChange:t=>r.onChange(t,e)},{default:(0,s.k6)((()=>[(0,s.bF)(m,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",Q,(0,n.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",O,(0,n.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",N,[(0,s.Lk)("div",M,[t[16]||(t[16]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",P,(0,n.v_)(e.owner_name),1)]),(0,s.Lk)("div",z,[t[17]||(t[17]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",H,(0,n.v_)(e.total_member),1)])])])),_:2},1032,["value","checked","onChange"])])))),128))])),(0,s.Lk)("div",V,[(0,s.bF)(v,{modelValue:d.page.page,"onUpdate:modelValue":t[3]||(t[3]=e=>d.page.page=e),"page-size-options":["20","50","100"],total:d.total,size:"small","show-less-items":"","show-size-changer":"","page-size":d.page.size,onChange:r.pageChange,onShowSizeChange:r.onShowSizeChange},null,8,["modelValue","total","page-size","onChange","onShowSizeChange"])])]),(0,s.Lk)("div",Y,[(0,s.Lk)("div",j,[(0,s.Lk)("div",J,[t[18]||(t[18]=(0,s.eW)(" 已选群聊")),(0,s.Lk)("span",null,"（"+(0,n.v_)(d.selectedGroup.length)+"）",1)]),(0,s.bF)(h,{type:"link",onClick:r.clear,disabled:d.selectedGroup.length<1||a.disabledIds.length>0},{default:(0,s.k6)((()=>t[19]||(t[19]=[(0,s.eW)(" 清空选择 ")]))),_:1},8,["onClick","disabled"])]),(0,s.Lk)("div",q,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.selectedGroup,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"fx-ac-be right-item pointer",key:e._id,draggable:!0,onDragstart:t=>r.dragstart(e),onDragenter:t=>r.dragenter(e,t),onDragend:t=>r.dragend(e,t),onDragover:t[4]||(t[4]=e=>r.dragover(e))},[(0,s.Lk)("div",Z,[d.isMuti?((0,s.uX)(),(0,s.CE)("div",ee)):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[(0,s.bF)(m,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",ae,(0,n.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",te,(0,n.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",se,[(0,s.Lk)("div",ie,[t[20]||(t[20]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",le,(0,n.v_)(e.owner_name),1)]),(0,s.Lk)("div",ne,[t[21]||(t[21]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",de,(0,n.v_)(e.total_member),1)])])])]),(0,s.bF)(h,{type:"link",onClick:t=>r.del(e.chat_id),disabled:a.disabledIds.includes(e.chat_id)},{default:(0,s.k6)((()=>t[22]||(t[22]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick","disabled"])],40,$)))),128))])])])])),_:3},8,["open","onOk","onCancel"])}const oe={class:"recent-choose"},ce={class:"flex-wrap"},he=["onClick"],ue={class:"recent-item-content omit"};function pe(e,t,a,i,l,d){const r=(0,s.g2)("a-tooltip");return(0,s.uX)(),(0,s.CE)("div",oe,[t[0]||(t[0]=(0,s.Lk)("div",{class:"label"},"最近选择",-1)),(0,s.Lk)("div",ce,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.list,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,n.C4)(["recent-item fx-ac-jc pointer",{selected:e.selected,disabled:a.disabledIds.includes(e.chat_id)}]),key:t,onClick:t=>d.selected(e)},[(0,s.bF)(r,null,{title:(0,s.k6)((()=>[(0,s.Lk)("div",null,(0,n.v_)(e.name),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("div",ue,(0,n.v_)(e.name),1)])),_:2},1024)],10,he)))),128))])])}var ge={name:"RecentChoose",props:{list:{type:Array,default:()=>[]},disabledIds:{type:Array,default:()=>[]}},data(){return{}},methods:{selected(e){this.disabledIds.includes(e.chat_id)||this.$emit("selected",e)}}};const fe=(0,g.A)(ge,[["render",pe],["__scopeId","data-v-3b5fdaaa"]]);var _e=fe;const me={class:"according-group-manager"},ke={key:0,class:"flex-wrap tag-box",ref:"tagBoxRef"},ve=["src"],Ae={class:"name omit"};function ye(e,t,a,i,l,d){const r=(0,s.g2)("a-button"),o=(0,s.g2)("a-tag"),c=(0,s.g2)("SelectStaffNew");return(0,s.uX)(),(0,s.CE)("div",me,[(0,s.bF)(r,{type:"link",class:"button",onClick:d.selectGroupManager},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)(" 选择群主 ")]))),_:1},8,["onClick"]),l.tagShow?((0,s.uX)(),(0,s.CE)("div",ke,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.staffList,((e,t)=>((0,s.uX)(),(0,s.Wv)(o,{class:(0,n.C4)(["tag fx-ac",{"tag-width":l.isWidth}]),closable:"",onClose:e=>d.delTag(t),key:t},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.avatar,alt:"",class:"img"},null,8,ve),(0,s.Lk)("div",Ae,(0,n.v_)(e.name),1)])),_:2},1032,["class","onClose"])))),128))],512)):(0,s.Q3)("",!0),(0,s.bF)(c,{ref:"selectTagGroup",selectType:"multiple",title:"选择群主",onChange:d.staffUpdate,viewAppointPermissions:a.viewAppointPermissions},null,8,["onChange","viewAppointPermissions"])])}var be=a(7767),Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA5FJREFUaEPtmr1r1VAYxp/3fLSVoiAqKmixoqibdBesdHBwE1xE0FKcOihiKx1arOggCIKDi6jopFBB6CAo+B8UHQRFUfC66SQU25uccyS5SZom596bhARzpdnycXOf3/udwyF4x3PDh5awhSn0b5Ig/1pNjxVAK43m9xH8xhlS5IkffoftAwCrqWarLA/k21H8oqFrZusgw0AviQ+1Lmus0PCM2dlr1g8B/jgwdGTG7O5F64eaNwD+tfc2PPDfesBo9LtKTcFACcHvEMNqFbCVhFBLvPsQoNFA9FvB+XgVEKUDWMSHhq8EolSAlHiDhq+esLcqT5QGYBPPBD/tCdeuWqgKojQAx/Fj/qRvaYOGJ54z/PBOlcaeBMQrKfl4GUldIoD6DGCwFTJ0Vwp2Oy7QcfUUjLkUXFuRku+vF4Crz8OYW9GMQjQrBHvgnbuunjDGzEf3QNNCsqe1AvCFNvWEoZhQolk/ouLiDc2KvhZYGUehEAoS9j5Ax0E0LwV7HIpJQsRFUkK844KTUceY5B8Y8LMIUG4AW52nWLjYPOGnRUJ84j0NxteSPg9ILoAOTQqdILqID/UWgsgMYG1SjBZilSUF4WgcMsod6JPifajSYgQXgAju54bIBNCuSXl13pa4YfVJhoL1PWTOauB6bG7KBZEJwGmqGRAmbU3KWn0YTgnOl+IAnYxg8UpmiPwAQOrlyToPzkclw6f1jUyNweBJcM1lMCe4FF/WhZarXoNwILj2TEp+uVtCZwLoZKFUk2pT53UTOxTUYruZKGUE0KSU7EUpAH4zSs/4DVAiiRPiXaVGDPHl0BuWmcgfsZXW54o2u0we6FBBIgMlS2XcovESm4YwHwE6HI0ZOTt1LoA2nkg1qXQ4ePPd2mxk8YSvP2mEbuHj/6bIwlbwvXsPwBhgbkgpHkWjRGJwWzdKdIAoIr4wQDvL2BLa91piwAv7hO8JpaaJ6I0Q7GUWiyefKeQB2x85jnsBoJu2WE41uzqO046jvgLBKnf3D5plKfnBIhav0gNrn5SJZheEygIQfdwvSskv1gqgXbPzRGql4uJLXV4pLQfaNruWmeu/rJKh2ZVq+ahYFOkD3WK3p5cW13nCVVe8855b3O3moTLvl5rEZQrL+q4NgKyWquq53vfAvqtmV933R7TznrfdoPe3GmDOiGEH23ptu0G02cN3z5wRQ6vYzBn66g7i7Y/QHKvhdpu/jwqKiOCsWFkAAAAASUVORK5CYII=",Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA0lJREFUaEPtms9rFDEUx79vkmxXRaGoaEVLV4QqBSt6EISKF6GghYJgbxUFQfTgSZAeLPgPeBJFQVDRg6dCexAUFXuQKhULeisordSDgiBUt5tJnsw4o0vdH9m225mFndMw85J8P+8leS8QQvA8YtH+Fhs8g5Y1ChR+S+mTB6yxKMzsxw+cJEOB+Nw7bMoCXko1l5QVgHzch2/Ufplb13nINpL4WOu8RZ5yQ7yl0bwfA/zSYNozxG2N6P1YcxMg6eg1I9CMwDI9UNMU0oxWMuZgtTE9KSY94Gs1u5X47wzga3OEgTuAU9KbBWy/UurLSois1IczgNZmAsAOd0H8Wgo5QB4W3NvUblkLwFzU/SQRrpcbii1dBHF3+J8woqQ4X7ss9xZLAXislDhTbgit0QbYUYC3/bGhG0T8xkUSA76QYqqW9bPiAIFQbbAX1ow4rpfFbHl4OKWEGHeBrgtACKHNMQC3XUT8Z8OYVhlx2KVt3QBCCItOsibnIiSwYcYFAAeCd6VENAUrt64rgKvw2E5rE2zTvU2AUp7T2sTbaOVdiP0OMrS7VB/kiffCw+fyO1jCEdAFvwNEzyrsPvNgcVRl8KmMk5KbQlpjLWCfAFx50TKmkRW9yuLnYohE14DW5haA45Go50S4XyzQMp8mUE/0reQ0TBpgBoAMcy/hhJTiVTFAVAw+jL7llRI7UxYBew7gK1H5MAeYvrgaNRbbrbEjReXFVaW8m6kCiLLvNQADoTCmKSm9/uDVN/4YQF2R4HtKicupW8ShZosW3zcPQDgUCRwDWAIUJicGjyshB8uV2ImugdijtoDNBmYMtOjswJgFiX6lUPaQkwqAcMoU/C4mGi3KB3li7pMZ+aFSeZEagGg9/KtGCYNKiqfVaqNUAYQQFp1s/GxGyalq4iPo5DKxi8BqNqmLQDXBSeWBiof6WkUX29f3QFMwL0HYtRyBzm3rcqQ0pgcWd5d4UHfWDmCeIM5KhRcujZyPlEFnYZLyTDdFRZvLALXasBATivDdtV1NAK6drqZdE2A1vV1qrGYEmhFYpgeo4xJvTfv9iHKMwXWDxr9qgGGWOY2NjXbd4O9ljzA8wyzbF7BeeMikHSS4H2EFFuLrNr8BWArnee8fSGwAAAAASUVORK5CYII=",we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAArdJREFUaEPtmj9oFEEUxr+3M+OdhAhCAgYkRLFQUBDTCSkEOzsDFooIoqWlIBYG0gUsIhYWikg6xVYQLFIIgk0QtLMQjCiIWESid+7OPJlN7ojh7vbf2+QWdstj3sz3e+/Nm9nbR/DPM1aTK9gXWDT2GlD825A+LcBZh7+fT2ENF8iSF3/oHcaaQDCkmnvK8iCfTuIHTd7i/SMBmlUS39G67tCiqZt8YNjTpp9z/4RgOnabJ6ro/Y7mGmC3o1dHoI5AQQ/UKVTQgYXNM0cgDO19EGYzrtwCaN7o4ElGu8Th2QEi+zVx1j4DCHRH6+BRXvtedkUAvgNYSSGmAeBM9+QUhigC8NJodTUFAKLIXWPwfBkQOwLghZcFsWMAZUGIAliHg87ZozpQrylAu1d6SUdCDMAB4zZybwFugrFsjLrUb39IQogBhJE9C2BpU3TLaHV40AaXghADYIdGaKOHBJoB0aLRwb2kCiUBIQaQJLasdNp1gF7VCYzrxqgXaZxSBGDZ6P4bNc3iW8f8l06MVZA6bTRs0jx5AD4CGPETS99twtDeBeFiLJrVtDH4Jg4Qhe4yEy9IXwt8EYisfQ7CdDw32eNG7fkpDlDGiRqLd/bxlkvfK6PVlSTxMWfe/4UkSmCcKdvFM1YDpWZVgC+lAkhEoqj4QhHoeCdvJCTEiwD4ScLQnQfxIgCdpjpJiRcD2ICw50B4kAQhKV4UIA2EtHhxgEEQZYgvBaAXBICnYBzpHlIZS+Wgcpr7HEiq0dv3RHe8oPjSItAR619yGFggoPMR5Q1Y3Uhzx0lyUPcqk/ckTrvARkphQhHWA421LHZpxpaWQmkWlxhTA0h4scgcdQSKeE/CttIfun27QaVbDbRvNcAc66nfGKtau4EC3Aff7BHn4RzrE22M/qpAu43vjxhVaL/fbLf5B0ryz4je82TlAAAAAElFTkSuQmCC";const Se={class:"fx-ac"},xe={class:"add-people flex"},Te={class:"add-left"},Ie={class:"add-right"},Ee={class:"top-btn flex"},Fe={class:"active fir"},De=["onDragstart","onDragenter","onDragend"],Ke={key:0,class:"staff flex"},Xe={class:"left flex"},Ge={class:"img-wra"},Be={class:"name fx-ac"},We={class:"icon"},Re={key:1,class:"staff flex"},Ue={class:"icon"},Oe={key:2,class:"staff flex"},Qe={class:"left flex"},Ne={class:"name"},Me={class:"icon"},Pe={key:3,class:"staff flex"},ze={class:"left flex"},He={class:"name"},Ve={class:"icon"};function Ye(e,t,a,i,l,d){const r=(0,s.g2)("a-button"),o=(0,s.g2)("allStaff"),c=(0,s.g2)("a-tab-pane"),h=(0,s.g2)("a-tabs"),u=(0,s.g2)("a-empty"),p=(0,s.g2)("cu-scroll"),g=(0,s.g2)("a-spin"),f=(0,s.g2)("addTag"),_=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(_,{width:"820px",open:d.dialogShow,"onUpdate:open":t[4]||(t[4]=e=>d.dialogShow=e),centered:"",confirmLoading:a.addConfirmLoading,onOk:d.addPeopleHandleOk,onCancel:d.addPeopleHandleCancel,class:"select-staff-new-dialog"},{title:(0,s.k6)((()=>[(0,s.Lk)("div",Se,[(0,s.Lk)("div",null,(0,n.v_)(a.title||"选择员工"),1),a.group_chat?((0,s.uX)(),(0,s.CE)("a",{key:0,class:"modal_a_title ml10",onClick:t[0]||(t[0]=(...e)=>d.modalATitle&&d.modalATitle(...e))},"刷新员工数据")):(0,s.Q3)("",!0)])])),footer:(0,s.k6)((()=>[(0,s.bF)(r,{onClick:d.addPeopleHandleCancel,disabled:a.addConfirmLoading},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("取消")]))),_:1},8,["onClick","disabled"]),(0,s.bF)(r,{type:"primary",loading:a.addConfirmLoading,onClick:d.addPeopleHandleOk},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)(" 确定 ")]))),_:1},8,["loading","onClick"])])),default:(0,s.k6)((()=>[(0,s.RG)(e.$slots,"alert",{},void 0,!0),(0,s.bF)(g,{spinning:l.big_spinning},{default:(0,s.k6)((()=>[(0,s.Lk)("div",xe,[(0,s.Lk)("div",Te,[(0,s.bF)(h,{activeKey:l.tabAcitive,"onUpdate:activeKey":t[1]||(t[1]=e=>l.tabAcitive=e)},{default:(0,s.k6)((()=>[((0,s.uX)(),(0,s.Wv)(c,{key:1,tab:"员工"},{default:(0,s.k6)((()=>[(0,s.bF)(o,{selectData:l.selectDataAll,onSetSelect:d.setSelect,isSession:a.isSession,isAuthMode:a.isAuthMode,excludeRole:a.excludeRole,bind_type:a.bind_type,"filter-staff":a.filterStaff,group_chat:a.group_chat,ref:"tabRef_1",selectType:a.selectType,viewAppointPermissions:a.viewAppointPermissions},null,8,["selectData","onSetSelect","isSession","isAuthMode","excludeRole","bind_type","filter-staff","group_chat","selectType","viewAppointPermissions"])])),_:1}))])),_:1},8,["activeKey"])]),(0,s.Lk)("div",Ie,[(0,s.Lk)("div",Ee,[(0,s.Lk)("div",Fe,[t[7]||(t[7]=(0,s.eW)(" 已选择")),(0,s.Lk)("span",null,"("+(0,n.v_)(l.selectDataAll.length)+")",1)]),l.selectDataAll.length?((0,s.uX)(),(0,s.Wv)(r,{key:0,type:"link",onClick:d.deleteAll},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("一键移除")]))),_:1},8,["onClick"])):(0,s.Q3)("",!0)]),(0,s.bF)(p,{class:"scroll-box",ref:"scrollbarRef"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:"test_wrapper",onDragover:t[3]||(t[3]=e=>d.dragover(e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.selectData,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"all-select fx-ac",key:e.id,draggable:!0,onDragstart:t=>d.dragstart(e),onDragenter:t=>d.dragenter(e,t),onDragend:t=>d.dragend(e,t),onDragover:t[2]||(t[2]=e=>d.dragover(e))},[t[16]||(t[16]=(0,s.Lk)("div",{class:"drag"},null,-1)),1===e.data_type?((0,s.uX)(),(0,s.CE)("div",Ke,[(0,s.Lk)("div",Xe,[(0,s.Lk)("div",Ge,[(0,s.Lk)("img",{src:be,class:(0,n.C4)({"img-c":"/static/image/default-avatar.svg"==e.avatar}),alt:""},null,2)]),(0,s.Lk)("span",Be,(0,n.v_)(e.name),1)]),(0,s.Lk)("div",We,[(0,s.bF)(r,{type:"link",onClick:t=>d.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),2===e.data_type?((0,s.uX)(),(0,s.CE)("div",Re,[t[11]||(t[11]=(0,s.Lk)("div",{class:"left flex"},[(0,s.Lk)("img",{src:Ce,alt:"",style:{width:"36px",height:"36px"}})],-1)),(0,s.Lk)("div",Ue,[(0,s.bF)(r,{type:"link",onClick:t=>d.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),3===e.data_type?((0,s.uX)(),(0,s.CE)("div",Oe,[(0,s.Lk)("div",Qe,[t[12]||(t[12]=(0,s.Lk)("img",{src:Le,style:{width:"36px",height:"36px"},alt:""},null,-1)),(0,s.Lk)("div",Ne,(0,n.v_)(e.name),1)]),(0,s.Lk)("div",Me,[(0,s.bF)(r,{type:"link",onClick:t=>d.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),4===e.data_type?((0,s.uX)(),(0,s.CE)("div",Pe,[(0,s.Lk)("div",ze,[t[14]||(t[14]=(0,s.Lk)("img",{src:we,alt:"",style:{width:"36px",height:"36px"}},null,-1)),(0,s.Lk)("div",He,(0,n.v_)(e.tag_name),1)]),(0,s.Lk)("div",Ve,[(0,s.bF)(r,{type:"link",onClick:t=>d.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0)],40,De)))),128))],32),l.selectDataAll.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0}))])),_:1},512)])])])),_:1},8,["spinning"]),(0,s.bF)(f,{ref:"addTagRef",onInitFunc:d.initMemberTag},null,8,["onInitFunc"])])),_:3},8,["open","confirmLoading","onOk","onCancel"])])}var je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAVdJREFUSEu9lc1tgzAYhvOaAxInRghHG5DCBmGDdoI2E0TdoN2ADcoG7QbJBlTYgisjsAC4cgVSRQEbEOWKv+fB3x847PxgZ/5hkaAoiisAl1L6ZvphxoKyLM9t294UuG3bOAzDu4nESFCW5bGDHzto5ThO5HlerZMYCYQQKYCn3zAACWPsZbNACPEM4H0MBOCRMfY5J5m9wUhqhqyaEBJRSqspyaxgLDVDEIA7YyxeLBBCnABkuhyr91LKKAiCr9E0zgE452edAEA9BVexRl2kk6wu8hZwH6sr8smyLFcnopROTvWk4F+KXBTFTUqpK3Tq+/5lcZuqADVoTdNkaoNOTHIFIF49aAqa5/mDZVkfYwIp5SUIgnRzF3HOE0LIdQCaTY1RF/WHsixzbdvOpJQ/6xqANjWLBOqwmmpCyD4/nP5rOOev3WpIdLOx+AamwD/bdm2gadw3I4Z9GVXUaNYAAAAASUVORK5CYII=",Je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXxJREFUSEvFlc1twjAYhvN+keDKCFyjGIlsQDZoJ2iZAEUJSNzaE1LIgQ3KBu0GsEGqGMGVEXJH5KuMhIRQEjv8qL7afh5/P7ZhPXngyXyrkSBJkhGAThiGn6YHMxbM5/MBgJUCM7M/Ho/XJhIjwWw267ZarRUzdxUUwJ6IvCAIcp3ESJAkydKyrLdLGIBFGIbB3YI4jt+J6KsC9BpF0U+dpDaC69SUgPLD4eBNp9N9laRWUJaaEtA6iiK/sSCO4z4Rpbocq/miKLzJZPJbtrY2AtWaOgEz51XwU8fpAPfO/69gs9n0bdvu6KJwHKfyVldGoOAAjIrMzJ4QonmRt9uteh50hV66rjts3KZqw2636x6Px1S9oKUtCOwB+I7j3HbRFDTLshfbtr/LBMw8FEKod6pyGHWRlHJBRKMrSm1qzmuNBGmadtrtdnr5XOtS00igFkspB0R0+nCKovB7vd7jPpzzaaSUHwByIcRCdzcaR2AKvF5nVINb4WrfH349gBkc1ySJAAAAAElFTkSuQmCC",qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXlJREFUSEvVlUFuwjAQRf0jZcMqR4BlLCI1NyA3aE/QcgJUoURi166QiCW4QXOD9gblBlSKRbYcIWsW48oIJBoljkPEot7a85/nz3gMdueFO+uzToD9fj8D4Pm+/257MWtAURQTIvrWwkQUBUGwtYFYAYqiGJ7Fh2fRw2AwCEejUdkGsQJIKTMAz9diADac89feACnlC4CPOiEAT5zzLxPEmEGNNVWt0nGc0Pf9QxPECKizpioEYMs5jzoDpJQPAHZtHut9pVQ4Ho9/am00CeR5PmkDACibxHWsVRe1QW4uch/hS6wxg9VqpevgtYHiOG581Y0ALe44jlWRiShMkqR7kYUQevYYCw0gm8/n085tqgOWy+XQdV2dRa1NAA7H4zFaLBa3PTQNEUI8MsY+625IRNMkSbLeXSSE2DDGZpVhZ7TGqosuh9brtUdEO6XUaVzbWNMJoA+naToBcPpwlFKRqTX/ZNrW49f7aZq+McbKOI61ZVbr/4+KXzY7gBlfd6c0AAAAAElFTkSuQmCC";const $e={class:"all-staff"},Ze={class:"sess-check fx-ac"},et={class:"sel-radio-type fx-ac",style:{"margin-top":"4px"}},tt={class:"sess-check-pro-title"},at={class:"title fx-ac"},st={class:"nums fx-ac"},it={class:"num"},lt={class:"fir"},nt={class:"num sc-num"},dt={class:"fir"},rt={class:"sec fx-ac"},ot={key:0,src:je,alt:""},ct={key:1,src:Je,alt:""},ht={key:2,src:qe,alt:""},ut=["onClick"],pt={class:"i-left fx-ac"},gt=["onUpdate:modelValue","onChange"],ft={class:"i-right flex"},_t={class:"ri-top fx-ac"},mt={class:"name eliOne fx-ac"},kt={class:"eliOne"},vt={class:"nums fx-ac"},At={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},yt={style:{"text-align":"center",height:"18px"}},bt={key:1};function Ct(e,t,a,i,d,r){const o=(0,s.g2)("a-input-search"),c=(0,s.g2)("a-button"),h=(0,s.g2)("a-popover"),u=(0,s.g2)("a-empty"),p=(0,s.g2)("ZmScroll"),g=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",$e,[(0,s.bF)(o,{placeholder:"请输入员工名称进行搜索",onSearch:r.addPeopleSearch,style:{"margin-top":"-8px"},value:d.staff_list_params.keyword,"onUpdate:value":t[0]||(t[0]=e=>d.staff_list_params.keyword=e),valueModifiers:{trim:!0}},null,8,["onSearch","value"]),(0,s.Lk)("div",Ze,[(0,s.Lk)("div",et,[(0,s.bF)(h,{placement:"bottom"},{content:(0,s.k6)((()=>[(0,s.Lk)("div",tt,[(0,s.Lk)("div",at,[t[3]||(t[3]=(0,s.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,s.bF)(c,{type:"link",style:{"margin-left":"20px"},onClick:r.openSeat},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,s.Lk)("div",st,[(0,s.Lk)("div",it,[(0,s.Lk)("div",lt,(0,n.v_)(r.bind_num),1),t[4]||(t[4]=(0,s.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,s.Lk)("div",nt,[(0,s.Lk)("div",dt,(0,n.v_)(r.unbind_num),1),t[5]||(t[5]=(0,s.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,s.Lk)("div",{class:"fx-ac tit",onClick:t[1]||(t[1]=(...e)=>r.sortTap&&r.sortTap(...e))},[(0,s.Lk)("div",rt,[t[6]||(t[6]=(0,s.Lk)("div",null,"客户数",-1)),0==d.sortType?((0,s.uX)(),(0,s.CE)("img",ot)):(0,s.Q3)("",!0),1==d.sortType?((0,s.uX)(),(0,s.CE)("img",ct)):(0,s.Q3)("",!0),2==d.sortType?((0,s.uX)(),(0,s.CE)("img",ht)):(0,s.Q3)("",!0)])])]),(0,s.bF)(p,{class:"datas-item",onLoad:r.peopleListLoad,finished:d.staff_list_nomore,loading:d.loading},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.staff_list,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"all-memeber fx-ac",key:e.id,onClick:(0,l.D$)((t=>r.wraperTap(e,a)),["stop"])},[(0,s.Lk)("div",pt,[(0,s.bo)((0,s.Lk)("input",{class:"check-input",type:"checkbox","onUpdate:modelValue":t=>e.checked=t,onChange:t=>r.checkChange(e,t,a)},null,40,gt),[[l.lH,e.checked]]),(0,s.Lk)("img",{src:be,alt:"",class:(0,n.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==e.avatar}])},null,2)]),(0,s.Lk)("div",ft,[(0,s.Lk)("div",_t,[(0,s.Lk)("div",mt,[(0,s.Lk)("span",kt,(0,n.v_)(e.name),1)]),(0,s.Lk)("div",vt,[t[7]||(t[7]=(0,s.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,s.Lk)("div",At,(0,n.v_)(e.cst_total),1)])])])],8,ut)))),128)),d.staff_list.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0}))])),_:1},8,["onLoad","finished","loading"]),(0,s.Lk)("div",yt,[d.staff_list_Loading?((0,s.uX)(),(0,s.Wv)(g,{key:0,size:"small"})):(0,s.Q3)("",!0),!d.staff_list_Loading&&d.staff_list.length?((0,s.uX)(),(0,s.CE)("div",bt,(0,n.v_)(d.staff_list_nomore?"":"下滑加载更多"),1)):(0,s.Q3)("",!0)])])}var Lt=a(4379),wt=a(7875),St={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{loading:!1,staff_list:[],staff_list_params:{page:1,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,oldSelect:[],sortType:1,searchTimer:""}},components:{ZmScroll:Lt.A},computed:{showStatus(){let e=!0;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},created(){this.staff_list.length||(this.loading=!1,this.getUser_get_staff_list()),this.getOldData()},watch:{selectData(){let e=this.selectData.map((e=>e.userid));for(let t=0;t<this.staff_list.length;t++){let a=this.staff_list[t];e.includes(a.userid)?a.checked=!0:a.checked=!1,this.staff_list[t]=a}},"staff_list_params.keyword"(){clearInterval(this.searchTimer),this.searchTimer=setTimeout((()=>{this.addPeopleSearch()}),500)}},methods:{addPeopleSearch(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},getUser_get_staff_list(){this.loading||this.staff_list_nomore||this.staff_list_Loading||(this.loading=!0,this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.chat_status=this.isSession),this.isAuthMode&&(this.staff_list_params.is_auth_mode=1),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.sortType?this.staff_list_params.order_by=1==this.sortType?"DESC":"ASC":this.staff_list_params.order_by="",this.staff_list_params.order_fields="cst_total",this.viewAppointPermissions&&(this.staff_list_params.permission_userids=this.viewAppointPermissions),(0,wt.Xj)(this.staff_list_params).then((e=>{if(this.staff_list_Loading=!1,!e.data.items.length)return this.staff_list_nomore=!0,this.loading=!1,!1;if(e.data&&e.data.items&&e.data.items.length){e.data.items.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.items=e.data.items.filter((e=>e[this.filterStaff.key]==this.filterStaff.value))),this.staff_list=this.staff_list.concat(e.data.items);let t=e=>{this.staff_list.forEach(((t,a)=>{e.includes(t.userid)&&(t.checked=!0)}))};t(this.selectData.map((e=>e.userid)))}this.loading=!1})))},peopleListLoad(){this.staff_list_Loading||(this.staff_list_params.page++,this.loading=!1,this.getUser_get_staff_list())},getGroup(e){return e&&e.length?e.map((e=>e.name)).join(","):"--"},setCheck(e,t){let a=this.staff_list.map((e=>e.userid)),s=a.indexOf(e.userid);this.staff_list[s]&&(this.staff_list[s].checked=!1,this.staff_list[s]=this.staff_list[s])},wraperTap(e,t){this.checkChange(e,!e.checked,t)},checkChange(e,t,a){let s=JSON.parse(JSON.stringify(this.selectData));if(e.data_type=1,e.checked=t,this.staff_list[a]=e,"multiple"!==this.selectType)this.staff_list.forEach(((t,a)=>{this.staff_list[a].checked=!1,t.userid===e.userid&&(this.staff_list[a].checked=!0)})),s=[e];else{let a=s.filter((e=>1===e.data_type)).map((e=>e.userid));if(t&&!a.includes(e.userid))s.push(e);else if(!t&&a.includes(e.userid)){let t;s.forEach(((a,s)=>{a.userid===e.userid&&(t=s)})),s.splice(t,1)}}this.$emit("setSelect",s)},sortTap(){this.staff_list_Loading||(this.sortType++,this.sortType>2&&(this.sortType=0),this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list())},getOldData(){let e={is_archive:this.isSession};this.isAuthMode&&(e.is_auth_mode=1)},oldSelectTap(e,t){e.checked=!e.checked,this.oldSelect[t]=e;let a=JSON.parse(JSON.stringify(this.selectData)),s=a.filter((e=>1===e.data_type)).map((e=>e.userid));if(s.includes(e.userid)){let t=s.indexOf(e.userid);-1!==t&&a.splice(t,1)}else e.data_type=1,"multiple"!==this.selectType?a=[e]:a.push(e);this.$emit("setSelect",a)},sessionCheck(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},openSeat(){window.open("/manage/index#/seatManage")}}};const xt=(0,g.A)(St,[["render",Ct],["__scopeId","data-v-b29d2868"]]);var Tt=xt;const It={class:"framework"},Et={style:{"margin-top":"12px"}},Ft={class:"sess-check-pro-title"},Dt={class:"title fx-ac"},Kt={class:"nums fx-ac"},Xt={class:"num"},Gt={class:"fir"},Bt={class:"num sc-num"},Wt={class:"fir"},Rt={class:"tree-wraper"},Ut={key:0,style:{"justify-content":"center","margin-top":"20px"},class:"fx-ac"},Ot=["onClick"],Qt=["onClick"],Nt={class:"staff-list fx-ac"},Mt={class:"i-left fx-ac"},Pt=["src"],zt={class:"i-right flex"},Ht={class:"ri-top fx-ac"},Vt={class:"nums fx-ac"},Yt={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},jt={class:"ri-bot fx-ac"},Jt={class:"seat-bind-box mr5"},qt={key:0,class:"bind-no"},$t={key:1,class:"interflow-bind"},Zt={key:2,class:"foundation-bind"},ea={class:"bm eliOne"},ta={key:0,class:"c-j flex"},aa={key:1,class:"p-t flex"},sa={key:0,class:"loading-btn"};function ia(e,t,a,i,d,r){const o=(0,s.g2)("a-input-search"),c=(0,s.g2)("a-button"),h=(0,s.g2)("a-popover"),u=(0,s.g2)("a-spin"),p=(0,s.g2)("a-tree");return(0,s.uX)(),(0,s.CE)("div",It,[(0,s.bF)(o,{placeholder:"请输入组织架构进行搜索",modelValue:d.searchParams.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>d.searchParams.keyword=e),modelModifiers:{trim:!0},style:{"margin-top":"-8px"}},null,8,["modelValue"]),(0,s.Lk)("div",Et,[(0,s.bF)(h,{placement:"bottom"},{content:(0,s.k6)((()=>[(0,s.Lk)("div",Ft,[(0,s.Lk)("div",Dt,[t[3]||(t[3]=(0,s.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,s.bF)(c,{type:"link",style:{"margin-left":"20px"},onClick:r.openSeat},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,s.Lk)("div",Kt,[(0,s.Lk)("div",Xt,[(0,s.Lk)("div",Gt,(0,n.v_)(r.bind_num),1),t[4]||(t[4]=(0,s.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,s.Lk)("div",Bt,[(0,s.Lk)("div",Wt,(0,n.v_)(r.unbind_num),1),t[5]||(t[5]=(0,s.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,s.Lk)("div",Rt,[d.showTree?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Ut,[(0,s.bF)(u)])),(0,s.bF)(u,{spinning:d.spinning},{default:(0,s.k6)((()=>[d.showTree?((0,s.uX)(),(0,s.Wv)(p,{key:0,checkable:"",props:d.props,checkStrictly:"",ref:"elTreeRef","load-data":r.loadNode,"tree-data":d.treeData,checkedKey:r.checkChange,"onUpdate:checkedKey":t[1]||(t[1]=e=>r.checkChange=e),"filter-tree-node":r.filterNode},{title:(0,s.k6)((({node:e,data:a})=>[(0,s.Lk)("div",{class:(0,n.C4)(["custom-tree-node",{"tree-node-30":a.show_more}])},[a.is_staff?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,n.C4)(["staff-wrape",{"padd-b-30":a.show_more}]),onClick:t=>r.itemTap(e,a)},[(0,s.Lk)("div",Nt,[(0,s.Lk)("div",Mt,[(0,s.Lk)("img",{src:a.avatar,alt:"",class:(0,n.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==a.avatar}])},null,10,Pt)]),(0,s.Lk)("div",zt,[(0,s.Lk)("div",Ht,[t[7]||(t[7]=(0,s.Lk)("div",{class:"name eliOne fx-ac",style:{"white-space":"normal"}},null,-1)),(0,s.Lk)("div",Vt,[t[6]||(t[6]=(0,s.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,s.Lk)("div",Yt,(0,n.v_)(a.external_total),1)])]),(0,s.Lk)("div",jt,[(0,s.Lk)("div",Jt,[a.is_bind_license?2==a.license_type?((0,s.uX)(),(0,s.CE)("div",$t)):1==a.license_type?((0,s.uX)(),(0,s.CE)("div",Zt)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",qt))]),(0,s.Lk)("div",ea,(0,n.v_)(a.alias?a.alias:""),1),1==a.role?((0,s.uX)(),(0,s.CE)("div",ta,"超级管理员")):(0,s.Q3)("",!0),2==a.role?((0,s.uX)(),(0,s.CE)("div",aa,"普通员工")):(0,s.Q3)("",!0)])])]),a.show_more?((0,s.uX)(),(0,s.CE)("div",sa,[(0,s.bF)(c,{type:"dashed",ref:"loading_id"+a.loading_id,icon:"redo",onClick:(0,l.D$)((t=>r.loadMoreTap(e,a)),["stop"])},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)(" 点击加载更多 ")]))),_:2},1032,["onClick"])])):(0,s.Q3)("",!0)],10,Qt)):((0,s.uX)(),(0,s.CE)("div",{key:0,onClick:t=>r.itemTap(e,a)},(0,n.v_)(a.department_name)+" ("+(0,n.v_)(a.staff_count)+")",9,Ot))],2)])),_:1},8,["props","load-data","tree-data","checkedKey","filter-tree-node"])):(0,s.Q3)("",!0)])),_:1},8,["spinning"])])])}var la={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{treeData:[],searchParams:{keyword:""},props:{children:"child",isLeaf:function(e,t){return e.child&&0===e.child.length}},staff_list_params:{page:0,size:20,department_type:1},staff_list_Loading:!1,staff_list_nomore:!0,textures_list:[],currTotal:0,currSelectKeys:[],department_ids:[],spinning:!1,showTree:!0}},computed:{showStatus(){let e=0==this.$store.state.user.active_corp.setting_status||3==this.$store.state.user.active_corp.setting_status;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},components:{},watch:{"searchParams.keyword"(){this.$refs.elTreeRef.filter(this.searchParams.keyword)},selectData(){let e=this.selectData.filter((e=>1===e.data_type)).map((e=>e.staff_id));e.forEach((e=>{this.currSelectKeys.includes(e)||(this.currSelectKeys.push(e),this.setTreeKeys())}))}},created(){this.initNode()},methods:{clearCheck(){this.currSelectKeys=[],this.setTreeKeys()},clearParKey(){this.currSelectKeys=this.currSelectKeys.filter((e=>-1!=e.indexOf("_"))),setTimeout((()=>{this.setTreeKeys()}),500)},setCheck(e,t,a){if(1===a)this.department_ids.forEach((t=>{let a=this.currSelectKeys.findIndex((a=>a===t+"_"+e.staff_id));-1!==a&&this.currSelectKeys.splice(a,1)})),this.setTreeKeys();else if(2===a){let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&(this.currSelectKeys.splice(t,1),this.setTreeKeys())}},filterNode(e){return e.department_name?e.department_name:e.name?e.name:void 0},itemTap(e,t){if(t.disabled)return;let{department_id:a}=t;if("multiple"!==this.selectType)this.currSelectKeys=[a],this.setTreeKeys();else if(this.currSelectKeys.includes(a)){let e=this.currSelectKeys.findIndex((e=>e===a));-1!==e&&(this.currSelectKeys.splice(e,1),this.setTreeKeys())}else this.currSelectKeys.push(a),this.setTreeKeys()},checkChange(e,t){if(t)this.currSelectKeys.includes(e.department_id)||this.currSelectKeys.push(e.department_id);else{let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&this.currSelectKeys.splice(t,1)}let a=JSON.parse(JSON.stringify(this.selectData)),{is_staff:s}=e;if(s){if(e.data_type=1,"multiple"!==this.selectType)a=[e];else{let s=a.filter((e=>1===e.data_type)).map((e=>e.staff_id));t&&!s.includes(e.staff_id)?a.push(e):!t&&s.includes(e.staff_id)&&a.splice(a.findIndex((t=>t.staff_id==e.staff_id)),1)}this.$emit("setSelect",a)}else{e.data_type=2;let s=a.filter((e=>2===e.data_type)).map((e=>e.department_id));if(t&&!s.includes(e.department_id))this.$emit("setLoading",!0),this.getCurrStaffList(e).then((t=>{e.staff_list=t,a.push(e),this.$emit("setLoading",!1),this.$emit("setSelect",a)}));else if(!t&&s.includes(e.department_id)){let t;a.forEach(((a,s)=>{a.department_id===e.department_id&&(t=s)})),a.splice(t,1),this.$emit("setSelect",a)}}},setTreeKeys(){this.$refs.elTreeRef.setCheckedKeys(this.currSelectKeys)},getFrameWorkList(){this.spinning=!0;let e={};this.isSession&&(e.is_session=this.isSession),this.isAuthMode&&(e.is_auth_mode=1);let t={msg:"成功",res:0,data:{list:[{department_id:"1",department_order:"100000000",department_parent_id:"0",department_name:"武汉铁杵磨针网络科技有限公司",staff_count:26,child:[{department_id:"2",department_order:"100000000",department_parent_id:"1",department_name:"测试",child:[{department_id:"4",department_order:"100000000",department_parent_id:"2",department_name:"测试1",child:[{department_id:"5",department_order:"100000000",department_parent_id:"4",department_name:"测试11",child:[],staff_count:1}],staff_count:2}],staff_count:4},{department_id:"3",department_order:"99999000",department_parent_id:"1",department_name:"开发",child:[],staff_count:9}]}]}};if(this.spinning=!1,t&&t.data&&t.data.list){this.textures_list=t.data.list;let e=[],a=t=>{t.forEach((t=>{t.disabled=1*t.staff_count>500||"multiple"!==this.selectType,e.push(t.department_id),t.child&&t.child.length?a(t.child):delete t.child}))};return a(t.data.list),this.department_ids=e,Promise.resolve(t.data.list)}},setNodeSty(){this.$nextTick((()=>{let e=document.querySelectorAll(".a-tree-node__content");e.forEach((e=>{e.getElementsByTagName("label")[0].style.marginTop=0}));let t=document.querySelectorAll(".tree-node-30");t.forEach((e=>{let t=e.parentNode.getElementsByTagName("label");t[0].style.marginTop="-40px"}))}))},async loadMoreTap(e,t){this.$refs["loading_id"+t.loading_id].$el.__vue__.sLoading=!0;let a=e.parent.childNodes.map((e=>e.data));a.forEach((e=>e.show_more=!1)),this.staff_list_nomore=!1,this.staff_list_params.department_id=t.par_department_id,this.staff_list_params.page=t.cur_page+1;let s=await this.getUser_get_staff_list();s.forEach(((e,a)=>{e.child=[],e.is_staff=!0,e.par_department_id=t.par_department_id,e.cur_page=t.cur_page+1,e.department_id=t.par_department_id+"_"+e.staff_id,e.loading_id=e.staff_id})),s[s.length-1]&&(s[s.length-1].show_more=!this.staff_list_nomore);let i=[...a,...s];this.$refs.elTreeRef.updateKeyChildren(t.par_department_id,i),this.setNodeSty()},async initNode(){let e=await this.getFrameWorkList();this.treeData=e},async loadNode(e,t){this.staff_list_nomore=!1,this.staff_list_params.department_id=e.department_id,this.staff_list_params.page=1;let a=await this.getUser_get_staff_list();a.forEach(((t,a)=>{t.child=[],t.is_staff=!0,t.par_department_id=e.department_id,t.cur_page=1,t.department_id=e.department_id+"_"+t.staff_id,t.loading_id=t.staff_id}));let s=e.child||[];a[a.length-1]&&(a[a.length-1].show_more=!this.staff_list_nomore),this.treeData=[...s,...a],this.setNodeSty()},getUser_get_staff_list(){if(this.staff_list_nomore)return;if(this.staff_list_Loading)return;this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.is_session=this.isSession),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.bind_type&&(this.staff_list_params.bind_type=this.bind_type),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.viewAppointPermissions&&(this.staff_list_params.permission_staff_ids=this.viewAppointPermissions);let e={msg:"成功",res:0,data:{pagination:{curPage:1,pageSize:20,total:13,totalCount:13,hasNextPage:!1},list:[{staff_id:"3587",name:"黄思龙",user_id:"woX2IKEAAAstH9Dx0LRajnJjSgmPDbyw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3451",name:"Felix余鑫",user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",external_total:"0",alias:"",is_bind_license:!0,group:[],ready_to_bind:0,license_type:"2"},{staff_id:"3450",name:"stone",user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3432",name:"彭建龙1",user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3167",name:"zhanglong",user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3149",name:"colson",user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3100",name:"sizz",user_id:"woX2IKEAAAEN39PCRL-cxrsgBhqdUmMg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"sizz",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3084",name:"fred",user_id:"woX2IKEAAAcN5qt6p6gBLbFMC0i8VFuQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3083",name:"王小鹏测试机",user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"2481",name:"钱楚",user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1893",name:"老贾",user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1889",name:"王进华",user_id:"woX2IKEAAAzc9fAQaEkE63j_g5SeXo6Q",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"Fox",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1888",name:"时光",user_id:"woX2IKEAAAe7bfgnclYNTM512bBfODtg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2}]}};if(this.staff_list_Loading=!1,e.data&&e.data.list&&e.data.list.length){e.data.list.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.list=e.data.list.filter((e=>e[this.filterStaff.key]==this.filterStaff.value)));let t=t=>{e.data.list.forEach((e=>{t.includes(e.staff_id)&&(this.department_ids.forEach((t=>{let a=t+"_"+e.staff_id;this.currSelectKeys.includes(a)||this.currSelectKeys.push(a)})),this.setTreeKeys())}))};return t(this.selectData.map((e=>e.staff_id))),this.currTotal=e.data.pagination.total,Promise.resolve(e.data.list)}return Promise.resolve([])},getCurrStaffList(e){let t={page:1,size:1e3,department_id:e.department_id};return this.isSession&&(t.is_session=this.isSession),this.excludeRole&&(t.exclude_role=this.excludeRole),this.bind_type&&(t.bind_type=this.bind_type),this.group_chat&&(t.group_chat=this.group_chat),this.viewAppointPermissions&&(t.permission_staff_ids=this.viewAppointPermissions),this.$api.user_get_staff_list(t).then((e=>Promise.resolve(e.data.list))).catch((e=>Promise.resolve([])))},sessionCheck(e){this.showTree=!1,setTimeout((e=>{this.showTree=!0}),500)},openSeat(){window.open("/manage/index#/seatManage")}}};const na=(0,g.A)(la,[["render",ia],["__scopeId","data-v-2130d9e8"]]);var da=na;const ra={class:"cont fx-ac",style:{"margin-top":"10px"}};function oa(e,t,a,i,l,n){const d=(0,s.g2)("a-input"),r=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.Wv)(r,{open:l.visible,"onUpdate:open":t[1]||(t[1]=e=>l.visible=e),"confirm-loading":l.confirmLoading,onOk:n.handleOk,width:"472px",onCancel:n.handleCancel},{default:(0,s.k6)((()=>[t[3]||(t[3]=(0,s.Lk)("div",{slot:"title",class:"fx-ac"},[(0,s.Lk)("div",{class:"fir-tit"},"创建标签"),(0,s.Lk)("div",{class:"sec-tit"},"确定将当前已选员工新建标签？")],-1)),(0,s.Lk)("div",ra,[t[2]||(t[2]=(0,s.Lk)("div",{class:"fir fx-ac"},[(0,s.Lk)("span",null,"*"),(0,s.eW)("标签名称：")],-1)),(0,s.bF)(d,{maxLength:32,style:{width:"262px"},modelValue:l.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.name=e),modelModifiers:{trim:!0},placeholder:"请输入标签名称"},null,8,["modelValue"])])])),_:1},8,["open","confirm-loading","onOk","onCancel"])}var ca=a(7277);const ha={user_get_corp_group_list:(e={})=>ca.Ay.post("/user/get-corp-group-list",e),user_edit_corp_group:(e={})=>ca.Ay.post("/user/edit-corp-group",e),user_add_corp_group:(e={})=>ca.Ay.post("/user/add-corp-group",e),user_del_corp_group:(e={})=>ca.Ay.post("/user/del-corp-group",e),user_get_staff_list:(e={})=>ca.Ay.get("/user/get-staff-list",{params:e}),user_get_simple_staff_list:(e={})=>ca.Ay.get("/user/get-simple-staff-list",{params:e}),user_add_group_member:(e={})=>ca.Ay.post("/user/add-group-member",e),user_remove_staff_group:(e={})=>ca.Ay.post("/user/remove-staff-group",e),user_get_group_by_staff:(e={})=>ca.Ay.post("/user/get-group-by-staff",e),user_get_corp_group_list_by_page:(e={})=>ca.Ay.post("/user/get-corp-group-list-by-page",e),getDepartmentList:(e={})=>ca.Ay.get("/user/get-department-list",{params:e}),getStaffGroupList:(e={})=>ca.Ay.get("/user/get-staff-group-list",{params:e}),bookTagGetLocalTagList:(e={})=>ca.Ay.get("/corp-address-book-tag/get-local-tag-list",{params:e}),bookTagAddTag:(e={})=>ca.Ay.post("/corp-address-book-tag/add-tag",e),bookTagDelTag:(e={})=>ca.Ay.post("/corp-address-book-tag/delete-tag",e),bookTagEditTag:(e={})=>ca.Ay.post("/corp-address-book-tag/edit-tag",e),bookTagAddStaff:(e={})=>ca.Ay.post("/corp-address-book-tag/add-staff-to-tag",e),bookTagGetTagStaff:(e={})=>ca.Ay.get("/corp-address-book-tag/get-local-staff-list-by-tag",{params:e}),bookTagDelTagStaff:(e={})=>ca.Ay.post("/corp-address-book-tag/remove-staff-from-tag",e),bookTagGetAllTagStaff:(e={})=>ca.Ay.get("/corp-address-book-tag/get-tag-staff-list",{params:e})};var ua=ha,pa={name:"",data(){return{visible:!1,name:"",confirmLoading:!1,staff:[]}},mounted(){},methods:{show(e){this.staff=e,this.name="",this.visible=!0},handleOk(){if(!this.name)return this.$message.error("请输入标签名称");this.createName().then((e=>{this.confirmLoading=!0,ua.bookTagAddStaff({tag_id:e,staff_id_list:this.staff.map((e=>e.staff_id)).join(",")}).then((t=>{if(this.confirmLoading=!1,0==t.res)return this.$message.success("操作成功"),this.handleCancel(),void this.$emit("initFunc",e);this.$message.error(t.msg)})).catch((e=>{this.confirmLoading=!1}))}))},createName(){return new Promise(((e,t)=>{this.confirmLoading=!0,ua.bookTagAddTag({tag_name:this.name}).then((a=>{this.confirmLoading=!1,0!=a.res?(t(),this.$message.error(a.msg)):e(a.data)})).catch((e=>{t(),this.confirmLoading=!1}))}))},handleCancel(){this.visible=!1}}};const ga=(0,g.A)(pa,[["render",oa],["__scopeId","data-v-38a89d7f"]]);var fa=ga,_a={name:"selectStaffNew",components:{allStaff:Tt,newFramework:da,addTag:fa},props:{addPeopleShow:{type:Boolean,default:function(){return!1}},addConfirmLoading:{type:Boolean,default:function(){return!1}},title:{type:String,default:function(){return""}},selectType:{type:String,default:function(){return""}},isSession:{default:""},excludeRole:{default:""},bind_type:{default:""},filterStaff:{type:Object,default:function(){return{}}},group_chat:{default:""},emptyCanClose:{default:!1},isAuthMode:{default:!1},viewAppointPermissions:{type:Array,default:()=>[]},maxStaffNum:{type:Number,default:-1}},data(){return{staff_list:[],staff_list_params:{page:0,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,pageStaffSize:50,selectData:[],selectDataAll:[],searchSelectData:[],selectOnSearchVal:"",alreadyAddPeopeList:[],selectDataShow:!0,oldData:null,newData:null,tabAcitive:1,big_spinning:!1,funcShow:!1,hasSetEditData:!1,hideTagName:"",batchDelTime:null,staffNameMap:{}}},computed:{bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0},dialogShow(){return this.addPeopleShow||this.funcShow},showStatus(){let e=!0;return e}},watch:{tabAcitive(){localStorage.setItem("select-staff-tab",this.tabAcitive)}},created(){let e=localStorage.getItem("select-staff-tab");e&&(this.tabAcitive=isNaN(1*e)?1:1*e)},methods:{modalATitle(){this.$refs.tabRef_1.addPeopleSearch()},async show(e){if(clearInterval(this.batchDelTime),this.pageStaffSize=50,this.funcShow=!0,e&&Array.isArray(e)){let t=Date.now();this.hasSetEditData=!0,e.forEach((e=>{e.data_type=1,e.id=t++})),this.selectDataAll=e,this.selectData=this.selectDataAll.slice(0,this.pageStaffSize)}},dragstart(e){this.oldData=e},dragenter(e,t){this.newData=e,t.preventDefault()},dragend(e,t){if(this.oldData!==this.newData){let e=this.selectData.indexOf(this.oldData),t=this.selectDataAll.indexOf(this.oldData),a=this.selectData.indexOf(this.newData),s=this.selectDataAll.indexOf(this.newData),i=[...this.selectData],l=[...this.selectDataAll];i.splice(e,1),l.splice(t,1),i.splice(a,0,this.oldData),l.splice(s,0,this.oldData),this.selectData=[...i],this.selectDataAll=[...l]}},dragover(e){e.preventDefault()},setSelect(e){let t=Date.now();if(this.maxStaffNum>-1&&e.length>this.maxStaffNum&&(e=e.slice(0,this.maxStaffNum),this.$emit("limit")),this.selectDataAll=e.map((e=>{e.id=t++})),this.selectOnSearchVal){let e=this.selectDataAll.filter((e=>-1!==e.name.indexOf(this.selectOnSearchVal)));this.searchSelectData=e}this.selectDataAll=e,this.selectData=e.slice(0,e.length>50?this.selectData.length:this.pageStaffSize)},setLoading(e){this.big_spinning=e},setScrollbarClear(){this.$nextTick((()=>{this.$refs.scrollbarRef&&this.$refs.scrollbarRef.wrap&&(this.$refs.scrollbarRef.wrap.scrollTop=0)})),this.selectDataAll=[],this.batchDelData()},batchDelData(){this.batchDelTime&&clearInterval(this.batchDelTime),this.batchDelTime=setInterval((()=>{0!=this.selectData.length?this.selectData.splice(0,100):clearInterval(this.batchDelTime)}),500)},addPeopleHandleCancel(e){this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancel"),this.$emit("cancelSelect")},selectDelete(e,t){let a=this.selectData.findIndex((t=>t.id===e.id));if(this.searchSelectData.length){this.searchSelectData.splice(a,1);let t=this.selectData.map((e=>e.userid));this.selectData.splice(t.indexOf(e.userid),1),this.selectDataAll.splice(t.indexOf(e.userid),1)}else this.selectData.splice(a,1),this.selectDataAll.splice(a,1);this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,a,t)},deleteAll(){this.selectDataAll.forEach(((e,t)=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,t,e.data_type)})),this.selectData=[],this.selectDataAll=[]},selectOnSearch(e){if(!e)return void(this.searchSelectData=[]);let t=this.selectDataAll.filter((t=>-1!==t.name.indexOf(e)));this.searchSelectData=t},addPeopleHandleOk(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],a=[];e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),a.push(e))})),this.$emit("selectStaff",a),this.$emit("change",a),this.emptyCanClose&&0==a.length||(this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancleSelect"))},setOldData(e){e.length&&this.$api.setLatelyChooseUser({user_id:e.map((e=>e.userid))}).then((e=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].getOldData()}))},createTag(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],a=[];return e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),a.push(e))})),a.length?a.some((e=>!e.userid))?this.$message.warning("选择的员工数据userid为空"):void this.$refs.addTagRef.show(a):this.$message.warning("请选择员工")},initMemberTag(e){e&&this.$emit("initFunc",e),this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].initMember(),"/staffManage"==this.$route.path&&(this.funcShow=!1)},hideTag(e){this.hideTagName=e,setTimeout((()=>{this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].$refs.elTreeRef_2.filter(e)}),500)},scrollLoad(){this.selectData.length!=this.selectDataAll.length&&(this.selectData=this.selectData.concat(this.selectDataAll.slice(this.selectData.length,this.selectData.length+this.pageStaffSize)))}},beforeUnmount(){clearInterval(this.batchDelTime)}};const ma=(0,g.A)(_a,[["render",Ye],["__scopeId","data-v-d90c69c4"]]);var ka=ma,va={name:"AccordingGroupManager",props:{active:{type:String,default:""},getStaffList:{type:Array,default:()=>[]},viewAppointPermissions:{type:Array,default:()=>[]}},components:{SelectStaffNew:ka},data(){return{staffList:[],tagShow:!0,isWidth:!1}},watch:{getStaffList:{handler(e){this.staffList=this.getStaffList},deep:!0}},created(){},methods:{selectGroupManager(){this.$refs.selectTagGroup.show(this.staffList)},staffUpdate(e){this.staffList=e,this.getWidth(),this.$emit("search",this.active,this.staffList)},getWidth(){this.$nextTick((()=>{let e=this.$refs.tagBoxRef;this.isWidth=e.offsetHeight<e.scrollHeight}))},delTag(e){this.staffList.splice(e,1),this.tagShow=!1,this.$nextTick((()=>{this.tagShow=!0,this.getWidth(),this.$emit("search",this.active,this.staffList)}))}}};const Aa=(0,g.A)(va,[["render",ye],["__scopeId","data-v-d7fc077a"]]);var ya=Aa;const ba={class:"according-group-tags"},Ca={class:"flex-wrap tag-box",ref:"tagBoxRef"};function La(e,t,a,i,l,d){const r=(0,s.g2)("a-button"),o=(0,s.g2)("a-tag"),c=(0,s.g2)("SelectTagGroup");return(0,s.uX)(),(0,s.CE)("div",ba,[(0,s.bF)(r,{type:"link",class:"button",onClick:d.selectTab},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)(" 选择群标签 ")]))),_:1},8,["onClick"]),(0,s.Lk)("div",Ca,[l.tagShow?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l.tags,((e,t)=>((0,s.uX)(),(0,s.Wv)(o,{class:"tag",closable:"",onClose:e=>d.delTag(t),key:t},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.name),1)])),_:2},1032,["onClose"])))),128)):(0,s.Q3)("",!0)],512),(0,s.bF)(c,{ref:"selectTagGroup",title:"选择群聊标签",onChange:d.setTagGroupChange},null,8,["onChange"])])}var wa=a.p+"img/cst-task-empty.9b19af16.png";const Sa={class:"title-box"},xa={class:"block translate3d"},Ta={class:"fx-ac-be mb10"},Ia={class:"wk-black-85-text title"},Ea={key:0,class:"select-tag"},Fa={key:1,class:"empty-img fx-ac-jc"},Da={class:"block translate3d"},Ka={class:"fx-ac-be mb10"},Xa={class:"fx-ac"},Ga={key:0,class:"spin fx-ac-jc"},Ba=["innerHTML"],Wa=["innerHTML"],Ra={key:0,class:"mt10"},Ua=["innerHTML"];function Oa(e,t,a,i,d,r){const o=(0,s.g2)("a-button"),c=(0,s.g2)("a-tag"),h=(0,s.g2)("a-space"),u=(0,s.g2)("PlusOutlined"),p=(0,s.g2)("a-input-search"),g=(0,s.g2)("a-spin"),f=(0,s.g2)("a-checkbox"),_=(0,s.g2)("a-input"),m=(0,s.g2)("groupTagGroupAdd"),k=(0,s.g2)("a-modal"),v=(0,s.gN)("focus");return(0,s.uX)(),(0,s.Wv)(k,{class:"select-tag-dialog-biubiu",modelValue:d.visible,"onUpdate:modelValue":t[1]||(t[1]=e=>d.visible=e),onCancel:r.hide,onOk:r.sure,mask:a.isMaskModal,width:"1000px"},{title:(0,s.k6)((()=>[(0,s.Lk)("div",Sa,[(0,s.eW)((0,n.v_)(a.title||"给客户群打标签")+" ",1),200!=d.widthLoading?((0,s.uX)(),(0,s.CE)("div",{key:0,style:(0,n.Tr)({width:d.widthLoading+"%"}),class:"width-loading"},null,4)):(0,s.Q3)("",!0)])])),default:(0,s.k6)((()=>[(0,s.Lk)("div",xa,[(0,s.Lk)("div",Ta,[(0,s.Lk)("p",Ia," 已选择的标签("+(0,n.v_)(d.selectTag.length)+") ",1),(0,s.bF)(o,{type:"link",onClick:r.clearSelect},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("清空选择")]))),_:1},8,["onClick"])]),d.selectTag.length?((0,s.uX)(),(0,s.CE)("div",Ea,[(0,s.bF)(h,{size:10,style:{"flex-wrap":"wrap"}},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.selectTag.slice(0,50),((e,t)=>((0,s.uX)(),(0,s.Wv)(c,{key:e.id,color:"blue",closable:"",onClose:e=>r.unselect(t)},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.name)+"("+(0,n.v_)(e.chat_count||0)+") ",1)])),_:2},1032,["onClose"])))),128))])),_:1})])):((0,s.uX)(),(0,s.CE)("div",Fa,t[3]||(t[3]=[(0,s.Lk)("img",{class:"img",src:wa,alt:""},null,-1),(0,s.Lk)("span",null,"暂未选择群标签",-1)])))]),(0,s.Lk)("div",Da,[(0,s.Lk)("div",Ka,[t[5]||(t[5]=(0,s.Lk)("p",{class:"wk-black-85-text title"},"选择可添加的标签",-1)),(0,s.Lk)("div",Xa,[(0,s.bF)(o,{type:"link",onClick:r.addBoxShow,class:"mr8"},{default:(0,s.k6)((()=>[(0,s.bF)(u),t[4]||(t[4]=(0,s.eW)(" 新建群标签组 "))])),_:1},8,["onClick"]),(0,s.bF)(p,{style:{width:"350px"},placeholder:"请输入标签组或标签名搜索",modelValue:d.searchValue,"onUpdate:modelValue":t[0]||(t[0]=e=>d.searchValue=e),onSearch:r.onSearch,allowClear:!0},null,8,["modelValue","onSearch"])])]),d.loading?((0,s.uX)(),(0,s.CE)("div",Ga,[(0,s.bF)(g)])):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(d.tagList,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.group_id},[(0,s.Lk)("div",{class:(0,n.C4)(["wk-black-65-text custom-title flex",{"fir-cut-title":0===t}])},[a.isMultiple?((0,s.uX)(),(0,s.Wv)(f,{key:0,indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":t=>e.checkAll=t,onChange:t=>r.onCheckAllChange(t,e)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",{innerHTML:r.getSearName(e)},null,8,Ba)])),_:2},1032,["indeterminate","checked","onUpdate:checked","onChange"])):((0,s.uX)(),(0,s.CE)("span",{key:1,innerHTML:r.getSearName(e)},null,8,Wa))],2),e.is_open?((0,s.uX)(),(0,s.CE)("div",Ra,[(0,s.bF)(h,{size:10,class:"fl-wrap"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.tag,(t=>((0,s.uX)(),(0,s.CE)(s.FK,null,[-1==d.excludeTags.indexOf(t.id)?((0,s.uX)(),(0,s.Wv)(c,{key:t.id,class:(0,n.C4)({"cur-not":-1!=r.disabledTagsList.indexOf(t.id)}),color:r.isSelect(t)?"blue":"",onClick:a=>r.select(t,e)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",{innerHTML:r.getSearName(t)},null,8,Ua)])),_:2},1032,["class","color","onClick"])):(0,s.Q3)("",!0)],64)))),256)),(0,s.Lk)("template",null,[e.showInput?(0,s.bo)(((0,s.uX)(),(0,s.Wv)(_,{key:0,placeholder:"输入标签名",style:{width:"100px"},maxLength:20,class:"add-input",onBlur:t=>r.addTag(e),onKeyup:(0,l.jR)((t=>r.addTag(e)),["enter"]),ref_for:!0,ref:"add_input_"+e.group_id},null,8,["onBlur","onKeyup"])),[[v]]):(0,s.Q3)("",!0),(0,s.bF)(o,{class:"add",onClick:()=>e.showInput=!0},{default:(0,s.k6)((()=>[(0,s.bF)(u)])),_:2},1032,["onClick"])])])),_:2},1024)])):(0,s.Q3)("",!0)])))),128))]),(0,s.bF)(m,{ref:"groupTagGroupAddRef",onUpdate:r.groupTagUpdate},null,8,["onUpdate"])])),_:1},8,["modelValue","onCancel","onOk","mask"])}const Qa={class:"add-tag-modal m16"},Na={class:"flex"},Ma=["onClick"];function Pa(e,t,a,i,n,d){const r=(0,s.g2)("a-input"),o=(0,s.g2)("PlusOutlined"),c=(0,s.g2)("a-button"),h=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(h,{title:"新建标签组",visible:n.tag_visible_group,width:480,onOk:d.tagHandleOkGroup,onCancel:d.tagHandleCancelGroup},{default:(0,s.k6)((()=>[(0,s.Lk)("div",Qa,[t[2]||(t[2]=(0,s.Lk)("div",{class:"mb8"},"标签组",-1)),(0,s.Lk)("div",Na,[(0,s.bF)(r,{value:n.tagGroup.tag_group_name,"onUpdate:value":t[0]||(t[0]=e=>n.tagGroup.tag_group_name=e),placeholder:"请填写标签组名",style:{width:"89.3%"},maxLength:15},null,8,["value"])]),t[3]||(t[3]=(0,s.Lk)("div",{class:"mb8 mt8"},[(0,s.Lk)("template",null,[(0,s.eW)("标签")])],-1)),(0,s.Lk)("template",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.tagGroup.tag_name,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"label_add",key:t},[(0,s.bF)(r,{placeholder:"请输入标签名",value:e.name,"onUpdate:value":t=>e.name=t,style:{width:"89.3%"},class:"list_input",maxLength:15,onBlur:e=>d.tage_list_inpt(e,t),help:"标签名不能超过15字，且不能重名"},null,8,["value","onUpdate:value","onBlur"]),(0,s.Lk)("div",{onClick:(0,l.D$)((a=>d.tage_list_dels(e,t)),["stop"]),class:"reduce"}," - ",8,Ma)])))),128))]),n.tagGroup.tag_name.length<20?((0,s.uX)(),(0,s.Wv)(c,{key:0,class:"add_tag_btn",onClick:d.add_list_content},{default:(0,s.k6)((()=>[(0,s.bF)(o),t[1]||(t[1]=(0,s.eW)(" 添加标签 "))])),_:1},8,["onClick"])):(0,s.Q3)("",!0)])])),_:1},8,["visible","onOk","onCancel"])])}var za={name:"groupTagGroupAdd",props:{},components:{PlusOutlined:h.A},data(){return{tag_visible_group:!1,tagGroup:{tag_group_name:"",tag_name:[]}}},computed:{},watch:{},created(){},mounted(){},methods:{addBoxShow(){this.tagGroup={tag_group_name:"",tag_name:[{name:"",id:0}]},this.tag_visible_group=!0},editTagDel(){let e=this.data.filter((e=>e.group_id==this.tagGroup.tag_group_id))[0],t={group_id:this.tagGroup.tag_group_id,group_name:this.tagGroup.tag_group_name,num:e.tag.length,tag:e.tag};this.tage_del(t,0,1,!1)},tage_list_inpt(e,t){let a=e.target.value;if(!a)return;let s=this.tagGroup.tag_name.filter(((e,s,i)=>s!==t&&e.name===a));return s.length>0&&(this.tagGroup.tag_name[t].name="",this.$message.error("标签名称不能重名！")),!1},tage_list_dels(e,t){0==e.num?this.tagGroup.tag_name.splice(t,1):this.tage_del(e,t,2)},add_list_content(){this.tagGroup.tag_name.length>19?this.$message.error("标签最大可设置20条"):this.tagGroup.tag_name.push({name:""})},tagHandleOkGroup(){let e={...this.tagGroup},t="";if(""==e.tag_group_name)return void this.$message.error("请补全群组名称再提交！");let a=e.tag_name.filter(((e,t,a)=>""==e.name));a.length>0?this.$message.error("请补全标签名再提交！"):(t="addTagGroup",e.tag_name=e.tag_name.map((e=>e.name)),WK.showLoading(),this.$api[t](e).then((e=>{WK.hideLoading(),0==e.res&&(this.$message.success(e.msg),this.$emit("update"),this.tag_visible_group=!1)}),(e=>{WK.hideLoading()})))},tagHandleCancelGroup(e){this.tag_visible_group=!1},tage_del(e,t,a,s){this.tagGroup.tag_name.splice(t,1)}}};const Ha=(0,g.A)(za,[["render",Pa],["__scopeId","data-v-79078594"]]);var Va=Ha,Ya={components:{groupTagGroupAdd:Va,PlusOutlined:h.A},data(){return{visible:!1,tagList:[],selectTag:[],excludeTags:[],disabledTags:[],searchValue:"",loading:!1,widthLoading:0,numIndex:0,son_index:0,fatherList:[],sonList:[],newTagList:[],time_val:null,tempList:[],tag_visible_group:!1}},props:{title:{type:String},disabled:{type:Array,default(){return[]}},isMultiple:{type:Boolean,default:!0},isMaskModal:{type:Boolean,default:!0}},computed:{role(){return this.$store.state.user.role},disabledTagsList(){let e=this.disabled.concat(this.disabledTags);return this.uniqueFun(e)}},directives:{focus:{inserted(e){e.focus()}}},methods:{clear(){clearInterval(this.time_val),this.selectTag=[],this.excludeTags=[],this.disabledTags=[],this.time_val=null,this.searchValue="",this.tempList=[],this.tagList=[],this.fatherList=[],this.sonList=[],this.newTagList=[],this.numIndex=0,this.son_index=0,this.widthLoading=0},hide(){this.visible=!1,this.clear(),this.$emit("cancel",this.visible)},show(e=[],t=[],a=[]){this.visible=!0,this.selectTag=[...e],t.length>0&&(this.excludeTags=t.map((e=>e.id))),a.length>0&&(this.disabledTags=a.map((e=>e.id))),this.search(),this.getChecked()},againData(e){this.newTagList=[],this.fatherList=[],this.sonList=[],this.numIndex=50,this.son_index=0,this.getNewTag(this.numIndex,e),this.tagList=this.newTagList,this.getTimeVal()},async search(){this.loading=!0,await this.$api.searchGroupTagList({name:this.searchValue}).then((e=>{let t=JSON.parse(JSON.stringify(e.data))||[];t.forEach((e=>{e.showInput=!1,e.is_open=!0,e.indeterminate=!1,e.checkAll=!1,e.checkedList=[]})),this.tempList=JSON.parse(JSON.stringify(t)),this.againData(t),this.getChecked(),this.loading=!1})).catch((e=>{this.loading=!1}))},getTimeVal(){clearInterval(this.time_val),this.time_val=setInterval((()=>{let e=parseInt(this.numIndex/this.sonList.length*100);this.widthLoading=e||0,this.loadScroll()}),600)},getNewTag(e,t){if(0===this.fatherList.length||0===this.sonList.length){let e=[],a=[],s=[];s=t?JSON.parse(JSON.stringify(t)):JSON.parse(JSON.stringify(this.tempList));for(let t=0;t<s.length;t++){e.push(s[t]);for(let e=0;e<s[t].tag.length;e++)a.push(s[t].tag[e]);s[t].tag=[]}this.fatherList=JSON.parse(JSON.stringify(e)),this.sonList=JSON.parse(JSON.stringify(a))}for(let a=0;a<this.fatherList.length;a++){let t=this.fatherList[a],s=this.sonList.slice(this.son_index,e);if(this.son_index>this.sonList.length||this.son_index>e)return;for(let e=0;e<s.length;e++){let a=s[e];if(a.group_id===t.group_id){let e=JSON.stringify(t.tag).indexOf(JSON.stringify(a));-1==e&&t.tag.push(a)}}let i=JSON.stringify(this.newTagList).indexOf(JSON.stringify(t));-1==i&&t.tag.length>0&&this.newTagList.push(t)}},loadScroll(){if(this.sonList.length<this.numIndex){if(clearInterval(this.time_val),200==this.widthLoading)return;return this.widthLoading=105.1,void setTimeout((()=>{this.widthLoading=200}),1500)}this.numIndex+=100,this.getNewTag(this.numIndex),this.tagList=this.newTagList,this.son_index+=100},select(e,t){if(-1!=this.disabledTagsList.indexOf(e.id))return;let a=t.checkedList.findIndex((t=>t.id==e.id));-1===a?t.checkedList.push(e):t.checkedList.splice(a,1);let s=this.selectTag.findIndex((t=>t.id==e.id));-1===s?this.isMultiple?this.selectTag.push(e):this.selectTag=[e]:this.selectTag.splice(s,1),t.indeterminate=!!t.checkedList.length&&t.checkedList.length<t.tag.length,t.checkAll=t.checkedList.length===t.tag.length},unselect(e){this.selectTag.splice(e,1),this.getChecked()},isSelect(e){let t=this.selectTag.findIndex((t=>t.id==e.id));return-1!=t},sure(){this.$emit("change",this.selectTag),this.hide()},addTag(e){const t=this;let a=t.$refs["add_input_"+e.group_id][0].$el,s=a.value;if(!s)return void(e.showInput=!1);let i=e.tag.filter(((e,t,a)=>e.name==s));i.length>0?t.$message.error("标签名称不能重复！"):t.$api.addTag({tag_group_id:e.group_id,tag_name:[s]}).then((async s=>{e.showInput=!1,a.value="",t.$message.success("添加成功"),await t.search(),await this.$emit("update",this.tempList)}))},roteGroup(e,t){e.is_open=!e.is_open,this.$set(this.tagList,t,e)},onCheckAllChange(e,t){const a=new Map;let s=JSON.parse(JSON.stringify(t.tag));if(Object.assign(t,{checkedList:e.target.checked?s:[],indeterminate:!1,checkAll:e.target.checked}),t.checkAll)for(let l=0;l<this.disabledTagsList.length;l++){let e=this.disabledTagsList[l],a=t.checkedList.findIndex((t=>t.id==e));-1!=a&&t.checkedList.splice(a,1)}else for(let l=0;l<t.tag.length;l++){let e=this.selectTag.findIndex((e=>e.id==t.tag[l].id));-1!=e&&this.selectTag.splice(e,1)}let i=[...this.selectTag,...t.checkedList];this.selectTag=i.filter((e=>!a.has(e.id)&&a.set(e.id,1)))},getChecked(){for(let e=0;e<this.tagList.length;e++){let t=this.tagList[e];if(t.checkedList=[],0!==this.selectTag.length)for(let e=0;e<t.tag.length;e++){let a=t.tag[e];for(let e=0;e<this.selectTag.length;e++){let s=this.selectTag[e];a.id==s.id&&t.checkedList.push(a)}}t.checkedList.length===t.tag.length?(t.checkAll=!0,t.indeterminate=!1):(t.checkAll=!1,t.indeterminate=!1,t.checkedList.length>0&&(t.indeterminate=!0))}},uniqueFun(e){const t=new Map;return e.filter((e=>!t.has(e)&&t.set(e,1)))},searchChange(){clearInterval(this.time_val),this.onSearch(this.searchValue)},onSearch(e){if(""==e)return this.getChecked(),void this.againData();this.widthLoading=0;let t=[];for(let s=0;s<this.tempList.length;s++){let a=this.tempList[s];t[s]={group_id:a.group_id,group_name:a.group_name,showInput:a.showInput,is_open:a.is_open,tag:[],indeterminate:!1,checkAll:!1,checkedList:[]};for(let i=0;i<a.tag.length;i++){let a=this.tempList[s].tag[i];a.name.indexOf(e)>-1&&t[s].tag.push({group_id:a.group_id,id:a.id,name:a.name,chat_count:a?.chat_count})}}let a=[];for(let s=0;s<t.length;s++){let i=t[s];if(i.is_open=!0,i.group_name.indexOf(e)>-1){let e=this.tempList.filter((e=>e.group_id==i.group_id))[0];a.push(e)}else i.tag.length>0&&a.push(i)}this.againData(a),this.getChecked()},getSearName(e){let t=e.group_name||e.name,a=e.chat_count||0,s=this.searchValue,i=t.split(s),l="";return i.length>1&&(l=i.join(`<span style="color: #ED744A;">${s}</span>`)),(this.searchValue&&l?l:t)+`(${a})`},clearSelect(){this.selectTag=[];for(let e=0;e<this.tagList.length;e++){let t=this.tagList[e];t.checkedList=[],t.checkAll=!1,t.indeterminate=!1}},addBoxShow(){this.$refs.groupTagGroupAddRef.addBoxShow()},async groupTagUpdate(){await this.clear(),await this.search(),await this.getChecked(),await this.$emit("update",this.tempList)}},beforeUnmount(){clearInterval(this.time_val)}};const ja=(0,g.A)(Ya,[["render",Oa],["__scopeId","data-v-f7148908"]]);var Ja=ja,qa={name:"AccordingGroupTags",props:{active:{type:String,default:""},getTags:{type:Array,default:()=>[]}},components:{SelectTagGroup:Ja},data(){return{tags:[],tagShow:!0}},watch:{getTags:{handler(e){this.tags=this.getTags},deep:!0}},created(){},methods:{selectTab(){this.$refs.selectTagGroup.show(this.tags)},setTagGroupChange(e){this.tags=e,this.$emit("search",this.active,this.tags)},delTag(e){this.tags.splice(e,1),this.tagShow=!1,this.$nextTick((()=>{this.tagShow=!0,this.$emit("search",this.active,this.tags)}))}}};const $a=(0,g.A)(qa,[["render",La],["__scopeId","data-v-76f0c2f9"]]);var Za=$a,es={name:"SelectGroupChat",props:{groupLiveCode:{type:Boolean,default:!1},aGroupGuests:{type:Boolean,default:!1},promptTitle:{type:String,default:""},disabledIds:{type:Array,default:()=>[]},disabledTabSwitch:{type:Boolean,default:!1},otherParams:{type:Object,default:function(){return{}}},viewAppointPermissions:{type:Array,default:function(){return[]}}},components:{RecentChoose:_e,AccordingGroupManager:ya,AccordingGroupTags:Za},data(){return{visible:!1,loading:!1,isMuti:!0,page:{page:1,size:100},total:0,name:"",orderBy:0,active:"1",tabs:[{label:"全部群聊",value:"1"}],dataLoading:!1,dataList:[],selectedChatIds:null,selectedGroup:[],recentChooseGroup:[],staffList:[],tags:[],type:"",oldData:null,newData:null,indeterminate:!1,checkAll:!1}},methods:{show(e=[],t=!0){this.visible=!0,this.reset(t),this.isMuti=t;let a=e.map((e=>e.chat_id));this.selectedChatIds=a,this.selectedGroup=e.concat(),this.isMuti||(this.selectedChatIds=a[0]),this.onSearch()},reset(e){this.selectedChatIds=null,this.selectedGroup=[],e&&(this.selectedChatIds=[])},selected(e){let t=this.recentChooseGroup.findIndex((t=>t.chat_id===e.chat_id));if(this.isMuti)this.recentChooseGroup[t].selected=!this.recentChooseGroup[t].selected,this.recentChooseGroup[t].selected?(this.isMuti?this.selectedChatIds.push(e.chat_id):this.selectedChatIds=e.chat_id,this.selectedGroup.push(e),this.checkAllStatus()):(this.del(e.chat_id),this.checkAllStatus());else if(!e.selected){for(let e in this.recentChooseGroup)this.recentChooseGroup[e].selected=!1;this.recentChooseGroup[t].selected=!0,this.selectedGroup=[],this.selectedGroup.push(e)}},search(e,t){"2"===e&&(this.staffList=t),"3"===e&&(this.tags=t),this.onSearch()},filtrate(e){let t={};"groupMembers"===e&&(t={1:6,6:0,0:1,4:1,5:1}),"buildGroupTime"===e&&(t={4:5,5:0,0:4,1:4,6:4}),this.orderBy=t[this.orderBy],this.page.page=1,this.getList()},async getList(){try{let e={...this.page,keyword:this.name,status:1,...this.otherParams};0!=this.orderBy&&(e.order_by=this.orderBy),"2"===this.active&&(e.owner_user_id=this.staffList.map((e=>e.user_id)).join(",")),"3"===this.active&&(e.tag_ids=this.tags.map((e=>e.id)).join(",")),this.groupLiveCode&&(e.scene=1),this.aGroupGuests&&(e.has_cst=0),this.dataLoading=!0,(0,wt.HN)(e).then((e=>{let t=e.data||{},{items:a,total:s}=t;s=Number(s),this.total=s,this.dataList=a,this.dataLoading=!1})),this.onChange("recentChoose")}catch(e){this.dataLoading=!1}},clear(){this.page.page=1,this.selectedGroup=[],this.selectedChatIds=[],this.indeterminate=!1,this.checkAll=!1,this.recentChooseGroup.map((e=>{e.selected=!1}))},del(e){if(!this.isMuti)return this.selectedChatIds=null,this.selectedGroup=[],void this.recentChooseGroup.map((e=>{e.selected=!1}));let t=this.selectedChatIds.findIndex((t=>t===e)),a=this.selectedGroup.findIndex((t=>t.chat_id===e)),s=this.recentChooseGroup.findIndex((t=>t.chat_id===e));this.selectedChatIds.splice(t,1),this.selectedGroup.splice(a,1),-1!=s&&(this.recentChooseGroup[s].selected=!1),this.checkAllStatus()},dragstart(e){this.oldData=e},dragenter(e,t){this.newData=e,t.preventDefault()},dragend(e,t){if(this.oldData!==this.newData){let e=this.selectedGroup.indexOf(this.oldData),t=this.selectedGroup.indexOf(this.newData),a=[...this.selectedGroup];a.splice(e,1),a.splice(t,0,this.oldData),this.selectedGroup=[...a],this.selectedChatIds=[],this.selectedGroup.map((e=>{this.selectedChatIds.push(e.chat_id)}))}},dragover(e){e.preventDefault()},handleOk(){this.$emit("selectedGroupChat",this.selectedGroup),this.visible=!1},handleCancel(){this.visible=!1},async onSearch(){this.page.page=1,await this.getList()},onChange(e,t){if(!e)return;if("recentChoose"!==e)if(e.target.checked)this.isMuti?this.selectedChatIds.push(t.chat_id):this.selectedChatIds=t.chat_id;else{let e=this.selectedChatIds.findIndex((e=>e===t.chat_id));this.selectedChatIds.splice(e,1)}if(!this.isMuti){let e=this.dataList.find((e=>e.chat_id===this.selectedChatIds));this.selectedGroup=[],e?this.selectedGroup.push(e):this.selectedGroup=[];let t=this.recentChooseGroup.findIndex((e=>e.chat_id===this.selectedChatIds));if(this.recentChooseGroup.map((e=>{e.selected=!1})),-1===t)return;return void(this.recentChooseGroup[t].selected=!0)}let a=this.selectedGroup.map((e=>e.chat_id));this.selectedChatIds.map((e=>{if(!a.includes(e)){let t=this.dataList.find((t=>t.chat_id===e));t&&this.selectedGroup.push(t)}this.recentChooseGroup.length>0&&this.recentChooseGroup.map((t=>{e===t.chat_id&&(t.selected=!0)}))})),this.selectedChatIds.length<this.selectedGroup.length&&a.map((e=>{if(!this.selectedChatIds.includes(e)){let t=this.selectedGroup.findIndex((t=>t.chat_id===e));this.selectedGroup.splice(t,1);let a=this.recentChooseGroup.findIndex((t=>t.chat_id===e));if(-1===a)return;this.recentChooseGroup[a].selected=!1}})),this.checkAllStatus()},async checkAllStatus(){if(!this.isMuti)return;let e=this.dataList.some((e=>this.selectedChatIds.includes(e.chat_id))),t=this.dataList.every((e=>this.selectedChatIds.includes(e.chat_id)));this.indeterminate=!t&&e,this.checkAll=!!this.dataList.length&&t},async onCheckAllChange(e){let t=[...this.selectedGroup,...this.dataList];t=this.uniqueFun(t),e.target.checked||this.dataList.forEach((e=>{let a=t.findIndex((t=>t.chat_id==e.chat_id));t.splice(a,1)})),Object.assign(this,{selectedGroup:t,indeterminate:!1,checkAll:e.target.checked});let a=t.map((e=>e.chat_id));e.target.checked?a.forEach((e=>{this.recentChooseGroup.forEach((t=>{e==t.chat_id&&(t.selected=!0)}))})):this.dataList.forEach((e=>{this.recentChooseGroup.forEach((t=>{e.chat_id==t.chat_id&&(t.selected=!1)}))})),this.selectedChatIds=a},uniqueFun(e){const t=new Map;return e.filter((e=>!t.has(e.chat_id)&&t.set(e.chat_id,1)))},pageChange(e,t){this.page.page=e,this.getList()},onShowSizeChange(e,t){this.page.size=t,this.getList()},tabChange(){this.tags=[],this.staffList=[],this.onSearch()}}};const ts=(0,g.A)(es,[["render",re],["__scopeId","data-v-30488552"]]);var as=ts;const ss={key:0,class:"mt8"},is=["onClick"];var ls={__name:"select-chat-box",props:{selectedChats:{type:Array,default(){return[]}}},emits:"change",setup(e,{emit:t}){const a=(0,i.KR)(0),l=t,d=e,r=(0,i.KR)(null),o=(0,i.KR)([]),c=(0,i.Kh)({total:0,current:1,pageSize:8,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}),u=(0,i.Kh)([{title:"群聊名称",dataIndex:"name",width:180},{title:"群主",dataIndex:"owner_name",width:180},{title:"操作",dataIndex:"operate",width:100,fixed:"right"}]);(0,s.wB)((()=>d.selectedChats),((e,t)=>{o.value=d.selectedChats,a.value=d.selectedChats.length}),{immediate:!0});const p=()=>{r.value.show(o.value)},g=e=>{o.value=e,a.value=e.length,l("change",e)},f=e=>{o.value.splice(e,1),a.value=o.value.length,l("change",o.value)},_=e=>{c.current=e.current,c.pageSize=e.pageSize};return(0,s.sV)((()=>{})),(e,t)=>{const l=(0,s.g2)("a-button"),d=(0,s.g2)("a-table");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(l,{icon:(0,s.h)((0,i.R1)(h.A)),type:"dashed",class:"mr16",onClick:p},{default:(0,s.k6)((()=>[(0,s.eW)("选择群聊 ("+(0,n.v_)(a.value)+")",1)])),_:1},8,["icon"]),o.value?.length>0?((0,s.uX)(),(0,s.CE)("div",ss,[(0,s.bF)(d,{class:"mt16 select-group-table","data-source":o.value,columns:u,pagination:c,scroll:{y:600},onChange:_},{bodyCell:(0,s.k6)((({column:e,text:t,record:a})=>["operate"===e.dataIndex?((0,s.uX)(),(0,s.CE)("a",{key:0,class:"operate-content",onClick:e=>f(a)},"移除",8,is)):(0,s.Q3)("",!0)])),_:1},8,["data-source","columns","pagination"])])):(0,s.Q3)("",!0),(0,s.bF)((0,i.R1)(as),{ref_key:"selectGroupChat",ref:r,onSelectedGroupChat:g},null,512)])}}};const ns=(0,g.A)(ls,[["__scopeId","data-v-042fc0f3"]]);var ds=ns;const rs={key:0,style:{display:"flex","flex-wrap":"wrap"}},os={key:0,class:"fx-ac",style:{flex:"1"}},cs={key:0,class:"fx-ac",style:{flex:"1"}};var hs={__name:"select-staff-box-normal",props:{title:{type:String,default:"选择员工"},btnText:{type:String,default:"添加员工"},btnType:{type:String,default:"dashed"},btnStyle:{type:String,default:"margin-right: 16px;"},showSelectStaff:{type:Boolean,default:!0},showClearSelectStaff:{type:Boolean,default:!1},selectType:{default:"multiple"},showStaffApproveTip:{default:!1},selectedStaffs:{type:Array,default(){return[]}},isTag:{type:Boolean,default:!0},showSeatTip:{type:Boolean,default:!1},maxShowWidth:{}},emits:"change",setup(e,{emit:t}){const a=t,l=e,d=(0,i.KR)(null),r=(0,s.EW)((()=>l.selectedStaffs)),o=e=>{r.value=e,a("change",e||[])},c=e=>{r.value.splice(e,1),a("change",r.value)},u=()=>{l.showClearSelectStaff?d.value.show([]):d.value.show(r.value)};return(0,s.sV)((()=>{})),(t,a)=>{const l=(0,s.g2)("a-button"),p=(0,s.g2)("a-avatar"),g=(0,s.g2)("a-tooltip"),f=(0,s.g2)("a-tag");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(l,{type:e.btnType,style:(0,n.Tr)(e.btnStyle),onClick:u},{default:(0,s.k6)((()=>[(0,s.bF)((0,i.R1)(h.A)),(0,s.eW)(" "+(0,n.v_)(e.btnText),1)])),_:1},8,["type","style"]),e.showSelectStaff?((0,s.uX)(),(0,s.CE)("div",rs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((t,a)=>((0,s.uX)(),(0,s.Wv)(f,{key:t.userid,closable:"",onClose:e=>c(a),style:{"margin-top":"6px"},class:(0,n.C4)(["fx-ac tag",{"red-tip":e.showSeatTip&&!t.is_bind_license}])},{default:(0,s.k6)((()=>[(0,s.bF)(g,null,{default:(0,s.k6)((()=>[e.showSeatTip?((0,s.uX)(),(0,s.CE)("div",os,[(0,s.bF)(p,{size:20,src:(0,i.R1)(be),style:{"margin-right":"4px"}},null,8,["src"]),(0,s.Lk)("span",null,(0,n.v_)(t.name),1)])):(0,s.Q3)("",!0)])),_:2},1024),e.showSeatTip?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",cs,[(0,s.bF)(p,{size:20,src:(0,i.R1)(be),style:{"margin-right":"4px"}},null,8,["src"]),(0,s.Lk)("span",null,(0,n.v_)(t.name),1)]))])),_:2},1032,["onClose","class"])))),128))])):(0,s.Q3)("",!0),(0,s.bF)((0,i.R1)(ka),{selectType:"multiple",ref_key:"setStaff",ref:d,onChange:a[0]||(a[0]=e=>o(e))},null,512)])}}};const us=(0,g.A)(hs,[["__scopeId","data-v-123a009c"]]);var ps=us,gs=a(8298),fs=a(8812),_s=a(9660);const ms={class:"zm-main-content"},ks={class:"mt8"},vs={key:2,class:"content-box",style:{width:"530px"}},As={key:0,class:"mt8"},ys={class:"mt8"},bs={class:"content-box mt8"},Cs={class:"compact-item"},Ls={class:"content-box mt8"},ws={class:"compact-item"},Ss={class:"title"},xs={class:"content-box"},Ts={class:"zm-flex-center"},Is={class:"mt8"},Es={class:"zm-fixed-bottom-box in-module"};var Fs={__name:"store",setup(e){const t=(0,i.KR)(0),a=(0,d.rd)(),u=(0,d.lq)(),p=(0,i.KR)(null),g=(0,i.KR)(null),f=(0,i.KR)(!0),_=(0,i.KR)(!1),k=((0,i.KR)(1),(0,i.KR)([]),{timeout_unit:1,timeout_value:"",is_remind_group_member:!1,is_remind_staff_designation:!1,designate_remind_userid_list:[],remind_staff_user_list:[]}),v=(0,i.Kh)({name:"",group_type:1,group_chat_id_list:[],group_staff_userid_list:[],group_keyword_list:{include_list:[],exclude_list:[]},is_remind_group_owner:!1,inspect_time_type:1,remind_rules:[(0,gs.t0)(k)],_group_chats:[],_group_staffs:[]}),A=(0,i.Kh)({filter_full_match_word_list:[],filter_half_match_word_list:[],worktime_data:[]});async function y(){await L(),u.query.rule_id>0?(t.value=u.query.rule_id,w()):f.value=!1}async function L(){await(0,fs.EX)().then((e=>{let t=e.data||{},a=t.working_hours||[];t.worktime_data=(0,_s.v)(a),(0,gs.AB)(A,t)}))}function w(){f.value=!0,(0,fs.lS)(t.value).finally((()=>{f.value=!1})).then((e=>{let t=e.data||{};switch(t.inspect_time_type=t.inspect_time_type.value,t.group_type=t.group_type.value,t._group_chats=t.group_chat_detail_list||[],t._group_staffs=t.group_staff_user_list||[],(0,gs.AB)(v,t),t.inspect_time_type){case 2:S();break;case 3:let e=(0,_s.v)(t.custom_time_list);(0,s.dY)((()=>{g.value.input(e)}));break}}))}function S(){2==v.inspect_time_type&&(0,s.dY)((()=>{p.value.input(A.worktime_data)}))}function x(e,t){let a=v.remind_rules[t];a.designate_remind_userid_list=e.map((e=>e.userid)),a.remind_staff_user_list=e,v.remind_rules[t]=a}function T(e){v.group_chat_id_list=e.map((e=>e.chat_id)),v._group_chats=e}function I(e){v.group_staff_userid_list=e.map((e=>e.userid)),v._group_staffs=e}function E(){v.remind_rules.length>2||v.remind_rules.push((0,gs.t0)(k))}function F(e){v.remind_rules.length<2||v.remind_rules.splice(e,1)}function D(){let e=a.resolve({path:"/module/timeout-reply-group/rule"});(0,gs.fA)("timeout_reply_group",e.href)}function K(){try{if(v.name=v.name.trim(),!v.name)throw"请输入规则名称";switch(v.group_type){case 1:if(!v.group_chat_id_list.length)throw"请选择指定群聊";break;case 2:if(!v.group_staff_userid_list.length)throw"请选择指定群聊员工";break;case 3:if(!v.group_keyword_list.include_list.length)throw"请填写群聊关键词";break}if(3==v.inspect_time_type){let e=g.value.verify();if(!e.ok)throw e.error}for(let e of v.remind_rules){if(!e.timeout_value)throw"请输入超过时间";if(!e.is_remind_group_member&&!e.is_remind_staff_designation)throw"请选择提醒员工";if(e.is_remind_staff_designation&&!e.designate_remind_userid_list.length)throw"请指定提醒员工"}return!0}catch(e){console.log("Err:",e),r.Ay.error(e)}return!1}function X(){a.push({path:"/module/timeout-reply-group/index"})}async function G(){try{if(!K())return;_.value=!0;let e=(0,gs.t0)(v);if(e.custom_time_list=[],3===e.inspect_time_type){let t=g.value.output();e.custom_time_list=t.map((e=>{let t=e.ranges.map((e=>({start:e.times[0],end:e.times[1]})));return{week_day_list:e.week,time_period_list:t}}))}e.remind_rules=e.remind_rules.map((e=>(delete e.remind_staff_user_list,e))),delete e._group_staffs,delete e._group_chats,t.value>0?await(0,fs.Ao)(t.value,e):await(0,fs.XP)(e),r.Ay.success("已保存"),setTimeout((()=>{X()}),1200)}catch(e){_.value=!1}}return(0,s.sV)((()=>{y()})),(0,s.wB)((()=>v.group_keyword_list.include_list),(()=>{v.group_keyword_list.include_list.length>20&&(v.group_keyword_list.include_list=v.group_keyword_list.include_list.slice(0,20))})),(0,s.wB)((()=>v.group_keyword_list.exclude_list),(()=>{v.group_keyword_list.exclude_list.length>20&&(v.group_keyword_list.exclude_list=v.group_keyword_list.exclude_list.slice(0,20))})),(e,a)=>{const d=(0,s.g2)("a-input"),r=(0,s.g2)("a-form-item"),u=(0,s.g2)("a-radio"),k=(0,s.g2)("a-radio-group"),y=(0,s.g2)("a-select"),L=(0,s.g2)("a-button"),w=(0,s.g2)("a-switch"),K=(0,s.g2)("a-input-number"),B=(0,s.g2)("a-checkbox"),W=(0,s.g2)("a-form");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(b,{title:[{name:"群聊超时",route:"/module/timeout-reply-group/index"},{name:t.value>0?"编辑规则":"新增规则"}]},null,8,["title"]),(0,s.Lk)("div",ms,[f.value?((0,s.uX)(),(0,s.Wv)(m,{key:0})):((0,s.uX)(),(0,s.Wv)(W,{key:1,class:"form-box",labelCol:{span:4},wrapperCol:{span:20}},{default:(0,s.k6)((()=>[(0,s.bF)(r,{label:"规则名称",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(d,{value:v.name,"onUpdate:value":a[0]||(a[0]=e=>v.name=e),placeholder:"请输入规则名称",style:{width:"320px"},"max-length":50},null,8,["value"])])),_:1}),(0,s.bF)(r,{label:"质检群聊",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(k,{value:v.group_type,"onUpdate:value":a[1]||(a[1]=e=>v.group_type=e)},{default:(0,s.k6)((()=>[(0,s.bF)(u,{value:1},{default:(0,s.k6)((()=>a[8]||(a[8]=[(0,s.eW)("指定群聊")]))),_:1}),(0,s.bF)(u,{value:2},{default:(0,s.k6)((()=>a[9]||(a[9]=[(0,s.eW)("当员工在群内时关注该群")]))),_:1}),(0,s.bF)(u,{value:3},{default:(0,s.k6)((()=>a[10]||(a[10]=[(0,s.eW)("当群名包含关键词时关注该群")]))),_:1})])),_:1},8,["value"]),(0,s.Lk)("div",ks,[1==v.group_type?((0,s.uX)(),(0,s.Wv)(ds,{key:0,"selected-chats":v._group_chats,ref:"groupRef",onChange:T},null,8,["selected-chats"])):2==v.group_type?((0,s.uX)(),(0,s.Wv)(ps,{key:1,"selected-staffs":v._group_staffs,ref:"groupStaffRef",onChange:I},null,8,["selected-staffs"])):((0,s.uX)(),(0,s.CE)("div",vs,[(0,s.bF)(r,{label:"包含关键词",labelCol:{span:5},required:""},{default:(0,s.k6)((()=>[(0,s.bF)(y,{value:v.group_keyword_list.include_list,"onUpdate:value":a[2]||(a[2]=e=>v.group_keyword_list.include_list=e),"token-separators":[","],open:!1,mode:"tags",placeholder:"请输入关键词"},null,8,["value"]),a[11]||(a[11]=(0,s.Lk)("div",null,[(0,s.Lk)("span",{class:"zm-tip-info"},"最多设置20个关键词")],-1))])),_:1}),(0,s.bF)(r,{label:"排除关键词",labelCol:{span:5}},{default:(0,s.k6)((()=>[(0,s.bF)(y,{value:v.group_keyword_list.exclude_list,"onUpdate:value":a[3]||(a[3]=e=>v.group_keyword_list.exclude_list=e),"token-separators":[","],open:!1,mode:"tags",placeholder:"请输入关键词"},null,8,["value"]),a[12]||(a[12]=(0,s.Lk)("div",null,[(0,s.Lk)("span",{class:"zm-tip-info"},"最多设置20个关键词")],-1))])),_:1})]))])])),_:1}),(0,s.bF)(r,{label:"质检时间",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(k,{value:v.inspect_time_type,"onUpdate:value":a[4]||(a[4]=e=>v.inspect_time_type=e),onChange:S},{default:(0,s.k6)((()=>[(0,s.bF)(u,{value:1},{default:(0,s.k6)((()=>a[13]||(a[13]=[(0,s.eW)("全天质检")]))),_:1}),(0,s.bF)(u,{value:2},{default:(0,s.k6)((()=>a[14]||(a[14]=[(0,s.eW)("工作时间")]))),_:1}),(0,s.bF)(u,{value:3},{default:(0,s.k6)((()=>a[15]||(a[15]=[(0,s.eW)("自定义质检时间")]))),_:1})])),_:1},8,["value"]),3==v.inspect_time_type?((0,s.uX)(),(0,s.CE)("div",As,[((0,s.uX)(),(0,s.Wv)(C.A,{key:1,ref_key:"customTimeRangeRef",ref:g}))])):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",ys,[((0,s.uX)(),(0,s.Wv)(C.A,{key:2,ref_key:"timeRangeRef",ref:p,disabled:"",showAddBtn:!1})),(0,s.bF)(L,{onClick:D,type:"dashed",icon:(0,s.h)((0,i.R1)(o.A)),style:{width:"100%"}},{default:(0,s.k6)((()=>a[16]||(a[16]=[(0,s.eW)(" 编辑工作时间 ")]))),_:1},8,["icon"])],512),[[l.aG,2==v.inspect_time_type]])])),_:1}),(0,s.bF)(r,{label:"提醒群主"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{checked:v.is_remind_group_owner,"onUpdate:checked":a[5]||(a[5]=e=>v.is_remind_group_owner=e)},null,8,["checked"]),a[17]||(a[17]=(0,s.Lk)("div",{class:"zm-tip-info"},"开启后，每次通知都将发送给群主",-1))])),_:1}),(0,s.bF)(r,{label:"过滤关键词",required:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[a[18]||(a[18]=(0,s.eW)("过滤关键词可到聊天统计-统计规则中设置")),(0,s.Lk)("a",{onClick:D,class:"ml8"},"去设置")]),a[22]||(a[22]=(0,s.Lk)("div",{class:"zm-tip-info"}," 关键词（单聊时，客户发送的最后一句话成功匹配到关键词，且员工没有回复，不算作未回复消息） ",-1)),(0,s.Lk)("div",bs,[(0,s.Lk)("div",Cs,[a[19]||(a[19]=(0,s.Lk)("div",{class:"tag"},"全匹配",-1)),(0,s.bF)(y,{value:A.filter_full_match_word_list,"onUpdate:value":a[6]||(a[6]=e=>A.filter_full_match_word_list=e),mode:"tags",style:{width:"100%"},placeholder:"请输入过滤关键词",disabled:""},null,8,["value"])])]),(0,s.Lk)("div",Ls,[(0,s.Lk)("div",ws,[a[20]||(a[20]=(0,s.Lk)("div",{class:"tag"},"半匹配",-1)),(0,s.bF)(y,{value:A.filter_half_match_word_list,"onUpdate:value":a[7]||(a[7]=e=>A.filter_half_match_word_list=e),mode:"tags",style:{width:"100%"},placeholder:"请输入过滤关键词",disabled:""},null,8,["value"])])]),(0,s.bF)(L,{onClick:D,class:"mt8",type:"dashed",icon:(0,s.h)((0,i.R1)(o.A)),style:{width:"100%"}},{default:(0,s.k6)((()=>a[21]||(a[21]=[(0,s.eW)(" 编辑未回复规则 ")]))),_:1},8,["icon"])])),_:1}),(0,s.bF)(r,{label:"提醒员工",required:""},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.remind_rules,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"notify-rule-item"},[(0,s.Lk)("div",Ss,[(0,s.eW)(" 规则"+(0,n.v_)(t+1)+" ",1),(0,s.bF)((0,i.R1)(c.A),{class:(0,n.C4)(["del-icon",{disabled:v.remind_rules.length<2}]),onClick:e=>F(t)},null,8,["class","onClick"])]),(0,s.Lk)("div",xs,[(0,s.Lk)("div",Ts,[a[23]||(a[23]=(0,s.Lk)("span",null,"超过",-1)),(0,s.bF)(K,{value:e.timeout_value,"onUpdate:value":t=>e.timeout_value=t,class:"ml4",placeholder:"请输入",precision:0,max:60},null,8,["value","onUpdate:value"]),a[24]||(a[24]=(0,s.Lk)("span",{class:"ml4"},"分钟",-1)),a[25]||(a[25]=(0,s.Lk)("span",{class:"ml4"},"未回复客户消息的群聊，给员工发送提醒",-1))]),(0,s.Lk)("div",Is,[(0,s.bF)(B,{checked:e.is_remind_staff_designation,"onUpdate:checked":t=>e.is_remind_staff_designation=t},{default:(0,s.k6)((()=>a[26]||(a[26]=[(0,s.eW)("指定员工")]))),_:2},1032,["checked","onUpdate:checked"]),(0,s.bF)(B,{checked:e.is_remind_group_member,"onUpdate:checked":t=>e.is_remind_group_member=t},{default:(0,s.k6)((()=>a[27]||(a[27]=[(0,s.eW)("群内员工")]))),_:2},1032,["checked","onUpdate:checked"])]),e.is_remind_staff_designation?((0,s.uX)(),(0,s.Wv)(ps,{key:0,selectedStaffs:e.remind_staff_user_list,onChange:e=>x(e,t),class:"mt16"},null,8,["selectedStaffs","onChange"])):(0,s.Q3)("",!0)])])))),128)),(0,s.bF)(L,{onClick:E,disabled:v.remind_rules.length>2,class:"mt8",type:"dashed",icon:(0,s.h)((0,i.R1)(h.A)),style:{width:"100%"}},{default:(0,s.k6)((()=>[(0,s.eW)("添加规则（"+(0,n.v_)(v.remind_rules.length)+"/3） ",1)])),_:1},8,["disabled","icon"])])),_:1})])),_:1})),(0,s.Lk)("div",Es,[(0,s.bF)(L,{onClick:X},{default:(0,s.k6)((()=>a[28]||(a[28]=[(0,s.eW)("取 消")]))),_:1}),(0,s.bF)(L,{class:"ml8",type:"primary",onClick:G,loading:_.value},{default:(0,s.k6)((()=>a[29]||(a[29]=[(0,s.eW)("保 存")]))),_:1},8,["loading"])])])])}}};const Ds=(0,g.A)(Fs,[["__scopeId","data-v-d29f1776"]]);var Ks=Ds},7767:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA/tJREFUaEPtmk9slEUUwH/v6y5tFVpNgVBppSghYsVIqBFMTIxWapp4oD0RNfHmSSIHT8YT9mRiI568mZhIPLQk1aBgSbyBAmIIBaKEFi1UKaZxqdDt7n7PvG9dUpXdnV1m20/jO33ZfTPzfvNm5r35IyyQfQe1/rccz4qGPUAv0A7UL9RZgu8sMClwgCA8tCJIfLW7V9IFO6TwMfCFtobpcI8IrwJNS2CoS5PTqnwYZIPBN/tlygpEAJHx8zok6HaXWpZaR5GjQUb6DUKiYZMJ94rwxlIbVkn7qrzTnAzekoHPMj0aBh8BqyqpIAa6KZVglwyM5N5V2BMDg6oxYZ+8PZIbBzqqKR2DMhcMIAMkYmBMNSakDUCrKRmXMv8DFPPEsgQ0JPP/zmdhzgZqDcS7B+oTsOk+4aHWvwKcnoRzV5Rc6JfCK0BTA+zsCmi79/ZGTs7AgZMhqZv+ILwB3LUMujuFzW230qvbWjl2WRk9q8zO+YHwBrC1Q3iuU6gLShsWKhw5q3xz0c/i5w1g1zbhgVWle7+ANn5N+fhozABe6w5oanQbFjfSMHjYz2z25oHXdwTc7bj1sUn8/mjMAF7cLnSsdBtCF6eV/cdiNoSeeFB4ZpMQlGHIhjA6ppyciBnA8gbofljoXFua4Myk8uWYcmPebb6U0/I2B6whC2R9XQFriwSyyzMwHNdAVugpiwMb1wiPtkNjMr/pvpmB81P5VCJtZwwexasHFtqVrPsTQPIAltDVQmoGYNmoecM8YAmc754vdIY3AFt91jQTLaUrV4DlRhGA5AEs95n5HS5cVaav53/zIXcM0HoPbFgtPLZOoknsIqk5ODWhfP+LcjXlUqK4TtUANsYt739qo9DcmO/pSsSSOvPI8XHlux+r3ydUBWA9/cKWgPtbKBu4XKAu/Qojp6rbJ1QMYMZb3m+971POTWkUoSvd7FQEYJPypSeL77juFMg88cnXIZmce00VAdim5fnNfnv+76Z+fjrk20s1AFjdBH1bA1qWu1dejea1WRg+EUZLrYs4e+Dx9RKN/XLZpkujpXQsPthcOOGYrToD9HfZUUlth08B7PzPytBxt3TbGWDHI4J5YTHEYsPhM54BbPncsk5ob6kdgipcmckHt9lbt2Cl23P2gFVj479wXFgLDAOwpM+itKtUBOBa6WLq/ScA7JDP8UBkMfvWqa2seeAHYIOTevyUJgzgPWB3/Gwrb5HAoOz9VHtFw/0xvp0vRjItQfjyv/+i2/AGhrRVk7lhkG3lHRcHDT0mmbq+6KlBwRyDCBPRY49XYnxrn1Llg3889ihA2LuJ6/PZpwmCHoWdQFsM7pAtqfgJwoMqiUPNdRxZ+NzmD26ItxWYaSgLAAAAAElFTkSuQmCC"}}]);