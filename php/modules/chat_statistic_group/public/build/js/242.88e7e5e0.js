"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[242],{8589:function(t,e,a){a.d(e,{Nk:function(){return o},Wl:function(){return u},ho:function(){return r},uO:function(){return s},zj:function(){return l}});var n=a(7277);const l=t=>n.Ay.get("/modules/chat_statistic_group/api/config",{params:t}),o=t=>n.Ay.post("/modules/chat_statistic_group/api/config",t),r=t=>n.Ay.get("/modules/chat_statistic_group/api/list",{params:t}),s=t=>n.Ay.get("/modules/chat_statistic_group/api/detail",{params:t}),u=t=>n.Ay.get("/modules/chat_statistic_group/api/stat",{params:t})},1242:function(t,e,a){a.r(e),a.d(e,{default:function(){return q}});a(4114);var n=a(6768),l=a(144),o=a(4232),r=a(1387),s=a(1576),u=a.n(s),i=a(1644),c=a(7403),d=a(6252);const _={class:"_main-nav"},p={key:1,class:"title"};var v={__name:"mainNavbar",props:{title:{type:[Array,String]}},setup(t){return(e,a)=>{const l=(0,n.g2)("router-link"),r=(0,n.g2)("a-breadcrumb-item"),s=(0,n.g2)("a-breadcrumb");return(0,n.uX)(),(0,n.CE)("div",_,[Array.isArray(t.title)?((0,n.uX)(),(0,n.Wv)(s,{key:0},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.title,((t,e)=>((0,n.uX)(),(0,n.Wv)(r,{key:e},{default:(0,n.k6)((()=>[t.route?((0,n.uX)(),(0,n.Wv)(l,{key:0,to:t.route},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(t.name),1)])),_:2},1032,["to"])):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,o.v_)(t.name),1)],64))])),_:2},1024)))),128))])),_:1})):((0,n.uX)(),(0,n.CE)("div",p,(0,o.v_)(t.title),1))])}}},m=a(1241);const y=(0,m.A)(v,[["__scopeId","data-v-b8774510"]]);var g=y,k=a(8589),A=a(8298);const h={class:"zm-main-content"},f={class:"header"},w={class:"left"},b={class:"item zm-user-info"},I=["src"],x={class:"name"},C={class:"item"},F={class:"right filter-box"},P={class:"filter-item ml16"},R={key:0},X={class:"table-box"},z={key:0},B={key:1,class:"reply-status"},K={key:2,class:"reply-status no"},M=["onClick"];var W={__name:"detail",setup(t){const e=a(7767),s=(0,r.lq)(),_=((0,r.rd)(),(0,l.KR)(!1)),p=((0,l.KR)({name:"",avatar:""}),(0,l.KR)("all")),v=(0,l.KR)(""),m=(0,l.KR)(""),y=(0,l.Kh)({current:1,page:1,pageSize:10,total:0,pageSizeOptions:["10","20","50","100"],showQuickJumper:!0,showSizeChanger:!0}),W=(0,l.Kh)({keyword:""}),L=(0,l.KR)([]),q=(0,l.KR)([]),U={chat_name:{title:"群聊名称",dataIndex:"chat_name",width:300},owner_name:{title:"群主",dataIndex:"owner_name",width:120},staff_msg_no_day:{title:"员工消息数",dataIndex:"staff_msg_no_day",width:120},cst_msg_no_day:{title:"客户消息数",dataIndex:"cst_msg_no_day",width:120},at_rate_avg:{dataIndex:"at_rate_avg",width:120},at_round_no:{title:"@回复轮次",dataIndex:"at_round_no",width:120},rate_avg:{dataIndex:"rate_avg",width:120},reply_status:{title:"回复状态",dataIndex:"reply_status",width:120},noreply_content:{title:"未回复消息内容",dataIndex:"noreply_content",width:200},promoter_type_text:{title:"发起人",dataIndex:"promoter_type_text",width:100},operate:{title:"操作",dataIndex:"operate",width:120}},S=["chat_name","owner_name","staff_msg_no_day","cst_msg_no_day","rate_avg","reply_status","promoter_type_text","operate"],H=["chat_name","owner_name","staff_msg_no_day","cst_msg_no_day","reply_status","promoter_type_text","operate"],Y=["chat_name","owner_name","at_rate_avg","at_round_no","rate_avg","promoter_type_text","operate"],j=(0,l.KR)([{key:"all",title:"全部群聊",value:"",columns:S},{key:"new_room",title:"今日新增群聊",value:"",columns:S},{key:"active_room",title:"活跃群聊",value:"",columns:S},{key:"replay",title:"已回复群聊",value:"",columns:S},{key:"no_replay",title:"未回复群聊",value:"",columns:H},{key:"rate_avg",title:"回复率",value:"",columns:Y}]);function E(){Z(),J(),G()}function Z(){const t=j.value.find((t=>t.key===p.value));q.value=[],t.columns.map((t=>{q.value.push(U[t])}))}function D(){(0,k.zj)().then((t=>{try{let e=t?.data||{};v.value=e.msg_reply_sec,m.value=e.at_msg_reply_sec}catch(e){console.error("statRuleDetail error:",e)}}))}function N(){y.current=1,y.total=0,L.value=[],J()}function Q(){N(),G()}function V(){Z(),N()}function O(){return u()(1e3*s.query.stat_time).format("YYYY-MM-DD")}function T(){let t={page:y.current,size:y.pageSize,staff_userid:s.query.staff_userid,stat_time:s.query.stat_time};return W.keyword=W.keyword.trim(),W.keyword&&(t.keyword=W.keyword),["all"].includes(p.value)||(t.type=p.value),t}function J(){_.value=!0;let t=T();(0,k.uO)(t).then((e=>{let a=e.data.list||[];a.map((t=>{t.chat_name=t?.chat_info?.name||"未命名群聊",t.owner_name=t?.owner_info?.name||"--",t.promoter_type_text=1==t?.promoter_type?"客户":"员工",t.rate_avg=(0,A.gd)(t.rate_avg,1),t.at_rate_avg=(0,A.gd)(t.at_rate_avg,1)})),L.value=a,y.total=Number(e.data.count);let n=t.type||"",l=j.value.findIndex((t=>t.key===n));l>-1&&(j.value[l].value=y.total)})).finally((()=>{_.value=!1}))}function G(){let t=T();t.page=1,t.size=1,j.value.map((e=>{["all"].includes(e.key)?delete t.type:t.type=e.key,(0,k.uO)(t).then((t=>{e.value=Number(t?.data?.count||0)}))}))}function $(t){Object.assign(y,t),J()}function tt(t){const e={group_chat_id:t?.chat_info?.chat_id||""};window.open(`/#/sessionArchive/index?${(0,A.cX)(e)}`)}return(0,n.sV)((()=>{p.value=s.query.type,D(),E()})),(t,a)=>{const r=(0,n.g2)("a-input-search"),u=(0,n.g2)("a-tab-pane"),k=(0,n.g2)("a-tabs"),A=(0,n.g2)("a-tooltip"),U=(0,n.g2)("a-table");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(g,{title:[{name:"群聊统计",route:"/module/chat-statistic-group/index"},{name:"员工群聊明细"}]}),(0,n.Lk)("div",h,[(0,n.Lk)("div",f,[(0,n.Lk)("div",w,[(0,n.Lk)("div",b,[(0,n.Lk)("img",{class:"avatar",src:(0,l.R1)(e)},null,8,I),(0,n.Lk)("span",x,(0,o.v_)((0,l.R1)(s).query.staff_name),1)]),a[2]||(a[2]=(0,n.Lk)("div",{class:"hr"},null,-1)),(0,n.Lk)("div",C,"统计时间："+(0,o.v_)(O()),1)]),(0,n.Lk)("div",F,[(0,n.Lk)("div",P,[(0,n.bF)(r,{value:W.keyword,"onUpdate:value":a[0]||(a[0]=t=>W.keyword=t),allowClear:"",placeholder:"请输入群聊名称进行搜索",onChange:Q,style:{width:"240px"}},null,8,["value"])])])]),(0,n.bF)(k,{activeKey:p.value,"onUpdate:activeKey":a[1]||(a[1]=t=>p.value=t),onChange:V},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(j.value,(t=>((0,n.uX)(),(0,n.Wv)(u,{key:t.key},{tab:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(t.title),1),t.value>0?((0,n.uX)(),(0,n.CE)("span",R,"（"+(0,o.v_)(t.value)+"）",1)):(0,n.Q3)("",!0)])),_:2},1024)))),128))])),_:1},8,["activeKey"]),(0,n.Lk)("div",X,[(0,n.bF)(U,{loading:_.value,"data-source":L.value,columns:q.value,pagination:y,scroll:{x:1200},onChange:$},{headerCell:(0,n.k6)((({column:t})=>["rate_avg"===t.dataIndex?((0,n.uX)(),(0,n.Wv)(A,{key:0,title:`${v.value}分钟内回复的总轮次/单聊的总轮次之和，这里轮次是客户发起，所属员工回复算一轮`},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(v.value)+"分钟回复率 ",1),(0,n.bF)((0,l.R1)(i.A))])),_:1},8,["title"])):"at_rate_avg"===t.dataIndex?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)(" @后"+(0,o.v_)(m.value)+"分钟回复率 ",1)],64)):(0,n.Q3)("",!0)])),bodyCell:(0,n.k6)((({column:t,text:e,record:o})=>["reply_status"===t.dataIndex?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[-1==o.reply_status?((0,n.uX)(),(0,n.CE)("span",z,"--")):1==o.reply_status?((0,n.uX)(),(0,n.CE)("div",B,[(0,n.bF)((0,l.R1)(c.A)),a[3]||(a[3]=(0,n.Lk)("span",null,"已回复",-1))])):((0,n.uX)(),(0,n.CE)("div",K,[(0,n.bF)((0,l.R1)(d.A)),a[4]||(a[4]=(0,n.Lk)("span",null,"未回复",-1))]))],64)):"operate"===t.dataIndex?((0,n.uX)(),(0,n.CE)("a",{key:1,onClick:t=>tt(o)},"明细",8,M)):(0,n.Q3)("",!0)])),_:1},8,["loading","data-source","columns","pagination"])])])])}}};const L=(0,m.A)(W,[["__scopeId","data-v-2c1baeab"]]);var q=L},7767:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA/tJREFUaEPtmk9slEUUwH/v6y5tFVpNgVBppSghYsVIqBFMTIxWapp4oD0RNfHmSSIHT8YT9mRiI568mZhIPLQk1aBgSbyBAmIIBaKEFi1UKaZxqdDt7n7PvG9dUpXdnV1m20/jO33ZfTPzfvNm5r35IyyQfQe1/rccz4qGPUAv0A7UL9RZgu8sMClwgCA8tCJIfLW7V9IFO6TwMfCFtobpcI8IrwJNS2CoS5PTqnwYZIPBN/tlygpEAJHx8zok6HaXWpZaR5GjQUb6DUKiYZMJ94rwxlIbVkn7qrzTnAzekoHPMj0aBh8BqyqpIAa6KZVglwyM5N5V2BMDg6oxYZ+8PZIbBzqqKR2DMhcMIAMkYmBMNSakDUCrKRmXMv8DFPPEsgQ0JPP/zmdhzgZqDcS7B+oTsOk+4aHWvwKcnoRzV5Rc6JfCK0BTA+zsCmi79/ZGTs7AgZMhqZv+ILwB3LUMujuFzW230qvbWjl2WRk9q8zO+YHwBrC1Q3iuU6gLShsWKhw5q3xz0c/i5w1g1zbhgVWle7+ANn5N+fhozABe6w5oanQbFjfSMHjYz2z25oHXdwTc7bj1sUn8/mjMAF7cLnSsdBtCF6eV/cdiNoSeeFB4ZpMQlGHIhjA6ppyciBnA8gbofljoXFua4Myk8uWYcmPebb6U0/I2B6whC2R9XQFriwSyyzMwHNdAVugpiwMb1wiPtkNjMr/pvpmB81P5VCJtZwwexasHFtqVrPsTQPIAltDVQmoGYNmoecM8YAmc754vdIY3AFt91jQTLaUrV4DlRhGA5AEs95n5HS5cVaav53/zIXcM0HoPbFgtPLZOoknsIqk5ODWhfP+LcjXlUqK4TtUANsYt739qo9DcmO/pSsSSOvPI8XHlux+r3ydUBWA9/cKWgPtbKBu4XKAu/Qojp6rbJ1QMYMZb3m+971POTWkUoSvd7FQEYJPypSeL77juFMg88cnXIZmce00VAdim5fnNfnv+76Z+fjrk20s1AFjdBH1bA1qWu1dejea1WRg+EUZLrYs4e+Dx9RKN/XLZpkujpXQsPthcOOGYrToD9HfZUUlth08B7PzPytBxt3TbGWDHI4J5YTHEYsPhM54BbPncsk5ob6kdgipcmckHt9lbt2Cl23P2gFVj479wXFgLDAOwpM+itKtUBOBa6WLq/ScA7JDP8UBkMfvWqa2seeAHYIOTevyUJgzgPWB3/Gwrb5HAoOz9VHtFw/0xvp0vRjItQfjyv/+i2/AGhrRVk7lhkG3lHRcHDT0mmbq+6KlBwRyDCBPRY49XYnxrn1Llg3889ihA2LuJ6/PZpwmCHoWdQFsM7pAtqfgJwoMqiUPNdRxZ+NzmD26ItxWYaSgLAAAAAElFTkSuQmCC"}}]);