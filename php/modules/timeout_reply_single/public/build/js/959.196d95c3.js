"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[959],{391:function(e,t,a){a.d(t,{Ao:function(){return c},C6:function(){return l},EX:function(){return i},Q4:function(){return r},XP:function(){return n},ji:function(){return u},lS:function(){return o},sn:function(){return d},uM:function(){return f}});var s=a(7277);const i=e=>s.Ay.get("/modules/timeout_reply_single/api/reply-rules",{params:e}),l=e=>s.Ay.post("/modules/timeout_reply_single/api/reply-rules",e),r=e=>s.Ay.get("/modules/timeout_reply_single/api/rules",{params:e}),n=e=>s.Ay.post("/modules/timeout_reply_single/api/rules",e),o=e=>s.Ay.get(`/modules/timeout_reply_single/api/rules/${e}`),d=e=>s.Ay.delete(`/modules/timeout_reply_single/api/rules/${e}`),c=(e,t)=>s.Ay.put(`/modules/timeout_reply_single/api/rules/${e}`,t),f=e=>s.Ay.put(`/modules/timeout_reply_single/api/rules/${e}/enable`),u=e=>s.Ay.put(`/modules/timeout_reply_single/api/rules/${e}/disable`)},9660:function(e,t,a){a.d(t,{v:function(){return i},z:function(){return l}});a(4114);var s=a(8298);function i(e){return e.map((e=>{let t=e.time_period_list.map((e=>({times:[e.start,e.end]})));return{week:e.week_day_list,ranges:t}}))}function l(e){switch(Number(e.inspect_time_type.value)){case 1:return"全天";case 2:return"工作时间";case 3:let t,a,i=[];return e.custom_time_list.map((e=>{t=[],a=[],e.week_day_list.map((e=>t.push((0,s.bG)(e)))),e.time_period_list.map((e=>a.push(`${e.start}~${e.end}`))),i.push(`${t.join("、")} ${a.join(" ")}`)})),i}}},1509:function(e,t,a){a.d(t,{A:function(){return L}});a(4114);var s=a(6768),i=a(4232),l=a(144),r=a(2281),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},o=n,d=a(4827);function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),s.forEach((function(t){f(e,t,a[t])}))}return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=function(e,t){var a=c({},e,t.attrs);return(0,s.bF)(d.A,c({},a,{icon:o}),null)};u.displayName="PlusCircleOutlined",u.inheritAttrs=!1;var p=u,h=a(5226),_=a(3536),m=a(8298);const g={class:"times-range-container"},A={class:"time-range-title"},v={class:"text"},y={class:"time-range-body"},k={class:"times"},b={class:"operator-box ml8"};var w={__name:"timesRange",props:{limit:{type:Number,default:5},timeLimit:{type:Number,default:5},disabled:{type:Boolean,default:!1},showAddBtn:{type:Boolean,default:!0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,o=e,d={times:[]},c={week:[],ranges:[(0,m.t0)(d)]},f=(0,l.KR)([{...c}]);function u(){f.value.length>=o.limit||(f.value.push((0,m.t0)(c)),E())}function w(e){o.disabled||1===f.value.length||(f.value.splice(e,1),E())}function S(e){o.disabled||e.ranges.length>=o.timeLimit||(e.ranges.push((0,m.t0)(d)),E())}function C(e,t){o.disabled||1===e.ranges.length||(e.ranges.splice(t,1),E())}function L(e,t){let a;for(let s=0;s<f.value.length;s++)if(a=f.value[s],s!==e&&a.week.includes(t.value))return!0;return!1}function x(){let e=(0,m.t0)(f.value);if(e=e.filter((e=>(e.times=e.ranges.filter((e=>e.times.length>0)),e.week.length>0&&e.times.length>0))),!e.length)return{ok:!1,error:"请至少完善一条时段规则"};for(let t of e){let e=t.ranges.map((e=>[(0,m.EF)(e.times[0]),(0,m.EF)(e.times[1])]));if((0,m.dj)(...e))return{ok:!1,error:"工作时间段存在重叠，请检查后重新选择"}}return{ok:!0}}function D(){let e=(0,m.t0)(f.value);return e=e.filter((e=>(e.times=e.ranges.filter((e=>e.times.length>0)),e.week=e.week.sort(),e.week.length>0&&e.times.length>0))),e}function T(e){e.length&&(f.value=e)}function E(){n("change")}return t({input:T,output:D,verify:x}),(t,a)=>{const n=(0,s.g2)("a-checkbox"),o=(0,s.g2)("a-checkbox-group"),d=(0,s.g2)("a-time-range-picker"),c=(0,s.g2)("a-button");return(0,s.uX)(),(0,s.CE)("div",g,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"time-range-item",key:a},[(0,s.Lk)("div",A,[(0,s.Lk)("span",v,"时间段"+(0,i.v_)(a+1),1),(0,s.bF)((0,l.R1)(r.A),{class:(0,i.C4)(["del",{disabled:e.disabled||f.value.length<2}]),onClick:e=>w(a)},null,8,["class","onClick"])]),(0,s.Lk)("div",y,[(0,s.bF)(o,{value:t.week,"onUpdate:value":e=>t.week=e,disabled:e.disabled,onChange:E},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,l.R1)(m.QM),(e=>((0,s.uX)(),(0,s.Wv)(n,{key:e.value,value:e.value,disabled:L(a,e)},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(e.label),1)])),_:2},1032,["value","disabled"])))),128))])),_:2},1032,["value","onUpdate:value","disabled"]),(0,s.Lk)("div",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.ranges,((a,r)=>((0,s.uX)(),(0,s.CE)("div",{class:"time-item",key:r},[(0,s.bF)(d,{value:a.times,"onUpdate:value":e=>a.times=e,disabled:e.disabled,onChange:E,style:{width:"300px"},format:"HH:mm","value-format":"HH:mm","show-time":{format:"HH:mm"},placeholder:["开始时间","结束时间"]},null,8,["value","onUpdate:value","disabled"]),(0,s.Lk)("div",b,[(0,s.bF)((0,l.R1)(p),{class:(0,i.C4)(["add",{disabled:e.disabled||t.ranges.length>=e.timeLimit}]),onClick:e=>S(t)},null,8,["class","onClick"]),(0,s.bF)((0,l.R1)(h.A),{class:(0,i.C4)(["remove ml8",{disabled:e.disabled||t.ranges.length<2}]),onClick:e=>C(t,r)},null,8,["class","onClick"])])])))),128))])])])))),128)),e.showAddBtn?((0,s.uX)(),(0,s.Wv)(c,{key:0,disabled:e.disabled||f.value.length>=e.limit,type:"dashed",icon:(0,s.h)((0,l.R1)(_.A)),onClick:u,style:{width:"100%"}},{default:(0,s.k6)((()=>a[0]||(a[0]=[(0,s.eW)("添加时间段 ")]))),_:1},8,["disabled","icon"])):(0,s.Q3)("",!0)])}}},S=a(1241);const C=(0,S.A)(w,[["__scopeId","data-v-676c50b6"]]);var L=C},4379:function(e,t,a){a.d(t,{A:function(){return p}});var s=a(6768),i=a(4232),l=a(144);const r=["id"],n={key:0,class:"loading-box"},o={class:"zm-list-content"},d={key:1,class:"loading-box bottom"};var c={__name:"zmScroll",props:{immediate:{type:Boolean,default:!0},loading:{type:Boolean},loadType:{type:String,default:"down"},finished:{type:Boolean},offsets:{type:Number,default:50},showLoading:{type:Boolean,default:!0},showScrollbar:{type:Boolean,default:!1}},emits:["load"],setup(e,{expose:t,emit:a}){const c=e,f=a,u=(0,l.KR)(""),p=(0,l.KR)(!1),h=(0,l.KR)(!1);(0,s.sV)((()=>{u.value="zm-scroll-"+Date.now()*Math.floor(1e4*Math.random()),c.immediate&&f("load")})),(0,s.wB)((()=>c.loading),(()=>{c.loading||c.finished||(0,s.dY)((()=>{p.value=_(),p.value||f("load")}))}));const _=()=>{const e=window.document.getElementById(u.value);return e.scrollHeight>e.offsetHeight},m=e=>{if(c.finished||c.loading||h.value)return;const{scrollTop:t,scrollHeight:a,offsetHeight:s}=e.target;"down"===c.loadType?t+s>=a-c.offsets&&f("load"):"up"===c.loadType&&t<=c.offsets&&f("load")},g=()=>window.document.getElementById(u.value),A=()=>{const e=g();h.value=!0,e.scrollTop=e.scrollHeight,setTimeout((()=>{h.value=!1}),500)},v=e=>{const t=g();h.value=!0,t.scrollTop=e,setTimeout((()=>{h.value=!1}),200)};return t({getListDom:g,scrollToBottom:A,setScrollTop:v}),(t,a)=>{const l=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",{class:(0,i.C4)(["zm-list-container",{"hide-scrollbar":!e.showScrollbar}]),id:u.value,onScroll:m},[e.showLoading&&"up"===e.loadType?((0,s.uX)(),(0,s.CE)("div",n,[e.loading?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(l,{size:"small"}),a[0]||(a[0]=(0,s.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)("已经到顶了")],64)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),(0,s.Lk)("div",o,[(0,s.RG)(t.$slots,"default")]),e.showLoading&&"down"===e.loadType?((0,s.uX)(),(0,s.CE)("div",d,[e.loading?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(l,{size:"small"}),a[1]||(a[1]=(0,s.Lk)("span",{class:"ml4"},"正在加载...",-1))],64)):e.finished&&p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)("已经到底了")],64)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)],42,r)}}},f=a(1241);const u=(0,f.A)(c,[["__scopeId","data-v-4c97411c"]]);var p=u},3959:function(e,t,a){a.r(t),a.d(t,{default:function(){return Pt}});a(4114);var s=a(6768),i=a(144),l=a(5130),r=a(1387),n=a(7694),o=a(5046),d=a(4232);const c={class:"_main-nav"},f={key:1,class:"title"};var u={__name:"mainNavbar",props:{title:{type:[Array,String]}},setup(e){return(t,a)=>{const i=(0,s.g2)("router-link"),l=(0,s.g2)("a-breadcrumb-item"),r=(0,s.g2)("a-breadcrumb");return(0,s.uX)(),(0,s.CE)("div",c,[Array.isArray(e.title)?((0,s.uX)(),(0,s.Wv)(r,{key:0},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.title,((e,t)=>((0,s.uX)(),(0,s.Wv)(l,{key:t},{default:(0,s.k6)((()=>[e.route?((0,s.uX)(),(0,s.Wv)(i,{key:0,to:e.route},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.name),1)])),_:2},1032,["to"])):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)((0,d.v_)(e.name),1)],64))])),_:2},1024)))),128))])),_:1})):((0,s.uX)(),(0,s.CE)("div",f,(0,d.v_)(e.title),1))])}}},p=a(1241);const h=(0,p.A)(u,[["__scopeId","data-v-b8774510"]]);var _=h,m=a(1509),g=a(3536),A=a(7767),v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA5FJREFUaEPtmr1r1VAYxp/3fLSVoiAqKmixoqibdBesdHBwE1xE0FKcOihiKx1arOggCIKDi6jopFBB6CAo+B8UHQRFUfC66SQU25uccyS5SZom596bhARzpdnycXOf3/udwyF4x3PDh5awhSn0b5Ig/1pNjxVAK43m9xH8xhlS5IkffoftAwCrqWarLA/k21H8oqFrZusgw0AviQ+1Lmus0PCM2dlr1g8B/jgwdGTG7O5F64eaNwD+tfc2PPDfesBo9LtKTcFACcHvEMNqFbCVhFBLvPsQoNFA9FvB+XgVEKUDWMSHhq8EolSAlHiDhq+esLcqT5QGYBPPBD/tCdeuWqgKojQAx/Fj/qRvaYOGJ54z/PBOlcaeBMQrKfl4GUldIoD6DGCwFTJ0Vwp2Oy7QcfUUjLkUXFuRku+vF4Crz8OYW9GMQjQrBHvgnbuunjDGzEf3QNNCsqe1AvCFNvWEoZhQolk/ouLiDc2KvhZYGUehEAoS9j5Ax0E0LwV7HIpJQsRFUkK844KTUceY5B8Y8LMIUG4AW52nWLjYPOGnRUJ84j0NxteSPg9ILoAOTQqdILqID/UWgsgMYG1SjBZilSUF4WgcMsod6JPifajSYgQXgAju54bIBNCuSXl13pa4YfVJhoL1PWTOauB6bG7KBZEJwGmqGRAmbU3KWn0YTgnOl+IAnYxg8UpmiPwAQOrlyToPzkclw6f1jUyNweBJcM1lMCe4FF/WhZarXoNwILj2TEp+uVtCZwLoZKFUk2pT53UTOxTUYruZKGUE0KSU7EUpAH4zSs/4DVAiiRPiXaVGDPHl0BuWmcgfsZXW54o2u0we6FBBIgMlS2XcovESm4YwHwE6HI0ZOTt1LoA2nkg1qXQ4ePPd2mxk8YSvP2mEbuHj/6bIwlbwvXsPwBhgbkgpHkWjRGJwWzdKdIAoIr4wQDvL2BLa91piwAv7hO8JpaaJ6I0Q7GUWiyefKeQB2x85jnsBoJu2WE41uzqO046jvgLBKnf3D5plKfnBIhav0gNrn5SJZheEygIQfdwvSskv1gqgXbPzRGql4uJLXV4pLQfaNruWmeu/rJKh2ZVq+ahYFOkD3WK3p5cW13nCVVe8855b3O3moTLvl5rEZQrL+q4NgKyWquq53vfAvqtmV933R7TznrfdoPe3GmDOiGEH23ptu0G02cN3z5wRQ6vYzBn66g7i7Y/QHKvhdpu/jwqKiOCsWFkAAAAASUVORK5CYII=",y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA0lJREFUaEPtms9rFDEUx79vkmxXRaGoaEVLV4QqBSt6EISKF6GghYJgbxUFQfTgSZAeLPgPeBJFQVDRg6dCexAUFXuQKhULeisordSDgiBUt5tJnsw4o0vdH9m225mFndMw85J8P+8leS8QQvA8YtH+Fhs8g5Y1ChR+S+mTB6yxKMzsxw+cJEOB+Nw7bMoCXko1l5QVgHzch2/Ufplb13nINpL4WOu8RZ5yQ7yl0bwfA/zSYNozxG2N6P1YcxMg6eg1I9CMwDI9UNMU0oxWMuZgtTE9KSY94Gs1u5X47wzga3OEgTuAU9KbBWy/UurLSois1IczgNZmAsAOd0H8Wgo5QB4W3NvUblkLwFzU/SQRrpcbii1dBHF3+J8woqQ4X7ss9xZLAXislDhTbgit0QbYUYC3/bGhG0T8xkUSA76QYqqW9bPiAIFQbbAX1ow4rpfFbHl4OKWEGHeBrgtACKHNMQC3XUT8Z8OYVhlx2KVt3QBCCItOsibnIiSwYcYFAAeCd6VENAUrt64rgKvw2E5rE2zTvU2AUp7T2sTbaOVdiP0OMrS7VB/kiffCw+fyO1jCEdAFvwNEzyrsPvNgcVRl8KmMk5KbQlpjLWCfAFx50TKmkRW9yuLnYohE14DW5haA45Go50S4XyzQMp8mUE/0reQ0TBpgBoAMcy/hhJTiVTFAVAw+jL7llRI7UxYBew7gK1H5MAeYvrgaNRbbrbEjReXFVaW8m6kCiLLvNQADoTCmKSm9/uDVN/4YQF2R4HtKicupW8ShZosW3zcPQDgUCRwDWAIUJicGjyshB8uV2ImugdijtoDNBmYMtOjswJgFiX6lUPaQkwqAcMoU/C4mGi3KB3li7pMZ+aFSeZEagGg9/KtGCYNKiqfVaqNUAYQQFp1s/GxGyalq4iPo5DKxi8BqNqmLQDXBSeWBiof6WkUX29f3QFMwL0HYtRyBzm3rcqQ0pgcWd5d4UHfWDmCeIM5KhRcujZyPlEFnYZLyTDdFRZvLALXasBATivDdtV1NAK6drqZdE2A1vV1qrGYEmhFYpgeo4xJvTfv9iHKMwXWDxr9qgGGWOY2NjXbd4O9ljzA8wyzbF7BeeMikHSS4H2EFFuLrNr8BWArnee8fSGwAAAAASUVORK5CYII=",k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAArdJREFUaEPtmj9oFEEUxr+3M+OdhAhCAgYkRLFQUBDTCSkEOzsDFooIoqWlIBYG0gUsIhYWikg6xVYQLFIIgk0QtLMQjCiIWESid+7OPJlN7ojh7vbf2+QWdstj3sz3e+/Nm9nbR/DPM1aTK9gXWDT2GlD825A+LcBZh7+fT2ENF8iSF3/oHcaaQDCkmnvK8iCfTuIHTd7i/SMBmlUS39G67tCiqZt8YNjTpp9z/4RgOnabJ6ro/Y7mGmC3o1dHoI5AQQ/UKVTQgYXNM0cgDO19EGYzrtwCaN7o4ElGu8Th2QEi+zVx1j4DCHRH6+BRXvtedkUAvgNYSSGmAeBM9+QUhigC8NJodTUFAKLIXWPwfBkQOwLghZcFsWMAZUGIAliHg87ZozpQrylAu1d6SUdCDMAB4zZybwFugrFsjLrUb39IQogBhJE9C2BpU3TLaHV40AaXghADYIdGaKOHBJoB0aLRwb2kCiUBIQaQJLasdNp1gF7VCYzrxqgXaZxSBGDZ6P4bNc3iW8f8l06MVZA6bTRs0jx5AD4CGPETS99twtDeBeFiLJrVtDH4Jg4Qhe4yEy9IXwt8EYisfQ7CdDw32eNG7fkpDlDGiRqLd/bxlkvfK6PVlSTxMWfe/4UkSmCcKdvFM1YDpWZVgC+lAkhEoqj4QhHoeCdvJCTEiwD4ScLQnQfxIgCdpjpJiRcD2ICw50B4kAQhKV4UIA2EtHhxgEEQZYgvBaAXBICnYBzpHlIZS+Wgcpr7HEiq0dv3RHe8oPjSItAR619yGFggoPMR5Q1Y3Uhzx0lyUPcqk/ckTrvARkphQhHWA421LHZpxpaWQmkWlxhTA0h4scgcdQSKeE/CttIfun27QaVbDbRvNcAc66nfGKtau4EC3Aff7BHn4RzrE22M/qpAu43vjxhVaL/fbLf5B0ryz4je82TlAAAAAElFTkSuQmCC";const b={class:"fx-ac"},w={class:"add-people flex"},S={class:"add-left"},C={class:"add-right"},L={class:"top-btn flex"},x={class:"active fir"},D=["onDragstart","onDragenter","onDragend"],T={key:0,class:"staff flex"},E={class:"left flex"},F={class:"img-wra"},K={class:"name fx-ac"},R={class:"icon"},B={key:1,class:"staff flex"},I={class:"icon"},U={key:2,class:"staff flex"},Q={class:"left flex"},X={class:"name"},W={class:"icon"},P={key:3,class:"staff flex"},N={class:"left flex"},O={class:"name"},Y={class:"icon"};function M(e,t,a,i,l,r){const n=(0,s.g2)("a-button"),o=(0,s.g2)("allStaff"),c=(0,s.g2)("a-tab-pane"),f=(0,s.g2)("a-tabs"),u=(0,s.g2)("a-empty"),p=(0,s.g2)("cu-scroll"),h=(0,s.g2)("a-spin"),_=(0,s.g2)("addTag"),m=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(m,{width:"820px",open:r.dialogShow,"onUpdate:open":t[4]||(t[4]=e=>r.dialogShow=e),centered:"",confirmLoading:a.addConfirmLoading,onOk:r.addPeopleHandleOk,onCancel:r.addPeopleHandleCancel,class:"select-staff-new-dialog"},{title:(0,s.k6)((()=>[(0,s.Lk)("div",b,[(0,s.Lk)("div",null,(0,d.v_)(a.title||"选择员工"),1),a.group_chat?((0,s.uX)(),(0,s.CE)("a",{key:0,class:"modal_a_title ml10",onClick:t[0]||(t[0]=(...e)=>r.modalATitle&&r.modalATitle(...e))},"刷新员工数据")):(0,s.Q3)("",!0)])])),footer:(0,s.k6)((()=>[(0,s.bF)(n,{onClick:r.addPeopleHandleCancel,disabled:a.addConfirmLoading},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("取消")]))),_:1},8,["onClick","disabled"]),(0,s.bF)(n,{type:"primary",loading:a.addConfirmLoading,onClick:r.addPeopleHandleOk},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)(" 确定 ")]))),_:1},8,["loading","onClick"])])),default:(0,s.k6)((()=>[(0,s.RG)(e.$slots,"alert",{},void 0,!0),(0,s.bF)(h,{spinning:l.big_spinning},{default:(0,s.k6)((()=>[(0,s.Lk)("div",w,[(0,s.Lk)("div",S,[(0,s.bF)(f,{activeKey:l.tabAcitive,"onUpdate:activeKey":t[1]||(t[1]=e=>l.tabAcitive=e)},{default:(0,s.k6)((()=>[((0,s.uX)(),(0,s.Wv)(c,{key:1,tab:"员工"},{default:(0,s.k6)((()=>[(0,s.bF)(o,{selectData:l.selectDataAll,onSetSelect:r.setSelect,isSession:a.isSession,isAuthMode:a.isAuthMode,excludeRole:a.excludeRole,bind_type:a.bind_type,"filter-staff":a.filterStaff,group_chat:a.group_chat,ref:"tabRef_1",selectType:a.selectType,viewAppointPermissions:a.viewAppointPermissions},null,8,["selectData","onSetSelect","isSession","isAuthMode","excludeRole","bind_type","filter-staff","group_chat","selectType","viewAppointPermissions"])])),_:1}))])),_:1},8,["activeKey"])]),(0,s.Lk)("div",C,[(0,s.Lk)("div",L,[(0,s.Lk)("div",x,[t[7]||(t[7]=(0,s.eW)(" 已选择")),(0,s.Lk)("span",null,"("+(0,d.v_)(l.selectDataAll.length)+")",1)]),l.selectDataAll.length?((0,s.uX)(),(0,s.Wv)(n,{key:0,type:"link",onClick:r.deleteAll},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("一键移除")]))),_:1},8,["onClick"])):(0,s.Q3)("",!0)]),(0,s.bF)(p,{class:"scroll-box",ref:"scrollbarRef"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:"test_wrapper",onDragover:t[3]||(t[3]=e=>r.dragover(e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.selectData,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"all-select fx-ac",key:e.id,draggable:!0,onDragstart:t=>r.dragstart(e),onDragenter:t=>r.dragenter(e,t),onDragend:t=>r.dragend(e,t),onDragover:t[2]||(t[2]=e=>r.dragover(e))},[t[16]||(t[16]=(0,s.Lk)("div",{class:"drag"},null,-1)),1===e.data_type?((0,s.uX)(),(0,s.CE)("div",T,[(0,s.Lk)("div",E,[(0,s.Lk)("div",F,[(0,s.Lk)("img",{src:A,class:(0,d.C4)({"img-c":"/static/image/default-avatar.svg"==e.avatar}),alt:""},null,2)]),(0,s.Lk)("span",K,(0,d.v_)(e.name),1)]),(0,s.Lk)("div",R,[(0,s.bF)(n,{type:"link",onClick:t=>r.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),2===e.data_type?((0,s.uX)(),(0,s.CE)("div",B,[t[11]||(t[11]=(0,s.Lk)("div",{class:"left flex"},[(0,s.Lk)("img",{src:v,alt:"",style:{width:"36px",height:"36px"}})],-1)),(0,s.Lk)("div",I,[(0,s.bF)(n,{type:"link",onClick:t=>r.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),3===e.data_type?((0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",Q,[t[12]||(t[12]=(0,s.Lk)("img",{src:y,style:{width:"36px",height:"36px"},alt:""},null,-1)),(0,s.Lk)("div",X,(0,d.v_)(e.name),1)]),(0,s.Lk)("div",W,[(0,s.bF)(n,{type:"link",onClick:t=>r.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0),4===e.data_type?((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",N,[t[14]||(t[14]=(0,s.Lk)("img",{src:k,alt:"",style:{width:"36px",height:"36px"}},null,-1)),(0,s.Lk)("div",O,(0,d.v_)(e.tag_name),1)]),(0,s.Lk)("div",Y,[(0,s.bF)(n,{type:"link",onClick:t=>r.selectDelete(e,e.data_type)},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])):(0,s.Q3)("",!0)],40,D)))),128))],32),l.selectDataAll.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0}))])),_:1},512)])])])),_:1},8,["spinning"]),(0,s.bF)(_,{ref:"addTagRef",onInitFunc:r.initMemberTag},null,8,["onInitFunc"])])),_:3},8,["open","confirmLoading","onOk","onCancel"])])}var z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAVdJREFUSEu9lc1tgzAYhvOaAxInRghHG5DCBmGDdoI2E0TdoN2ADcoG7QbJBlTYgisjsAC4cgVSRQEbEOWKv+fB3x847PxgZ/5hkaAoiisAl1L6ZvphxoKyLM9t294UuG3bOAzDu4nESFCW5bGDHzto5ThO5HlerZMYCYQQKYCn3zAACWPsZbNACPEM4H0MBOCRMfY5J5m9wUhqhqyaEBJRSqspyaxgLDVDEIA7YyxeLBBCnABkuhyr91LKKAiCr9E0zgE452edAEA9BVexRl2kk6wu8hZwH6sr8smyLFcnopROTvWk4F+KXBTFTUqpK3Tq+/5lcZuqADVoTdNkaoNOTHIFIF49aAqa5/mDZVkfYwIp5SUIgnRzF3HOE0LIdQCaTY1RF/WHsixzbdvOpJQ/6xqANjWLBOqwmmpCyD4/nP5rOOev3WpIdLOx+AamwD/bdm2gadw3I4Z9GVXUaNYAAAAASUVORK5CYII=",H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXxJREFUSEvFlc1twjAYhvN+keDKCFyjGIlsQDZoJ2iZAEUJSNzaE1LIgQ3KBu0GsEGqGMGVEXJH5KuMhIRQEjv8qL7afh5/P7ZhPXngyXyrkSBJkhGAThiGn6YHMxbM5/MBgJUCM7M/Ho/XJhIjwWw267ZarRUzdxUUwJ6IvCAIcp3ESJAkydKyrLdLGIBFGIbB3YI4jt+J6KsC9BpF0U+dpDaC69SUgPLD4eBNp9N9laRWUJaaEtA6iiK/sSCO4z4Rpbocq/miKLzJZPJbtrY2AtWaOgEz51XwU8fpAPfO/69gs9n0bdvu6KJwHKfyVldGoOAAjIrMzJ4QonmRt9uteh50hV66rjts3KZqw2636x6Px1S9oKUtCOwB+I7j3HbRFDTLshfbtr/LBMw8FEKod6pyGHWRlHJBRKMrSm1qzmuNBGmadtrtdnr5XOtS00igFkspB0R0+nCKovB7vd7jPpzzaaSUHwByIcRCdzcaR2AKvF5nVINb4WrfH349gBkc1ySJAAAAAElFTkSuQmCC",G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAXlJREFUSEvVlUFuwjAQRf0jZcMqR4BlLCI1NyA3aE/QcgJUoURi166QiCW4QXOD9gblBlSKRbYcIWsW48oIJBoljkPEot7a85/nz3gMdueFO+uzToD9fj8D4Pm+/257MWtAURQTIvrWwkQUBUGwtYFYAYqiGJ7Fh2fRw2AwCEejUdkGsQJIKTMAz9diADac89feACnlC4CPOiEAT5zzLxPEmEGNNVWt0nGc0Pf9QxPECKizpioEYMs5jzoDpJQPAHZtHut9pVQ4Ho9/am00CeR5PmkDACibxHWsVRe1QW4uch/hS6wxg9VqpevgtYHiOG581Y0ALe44jlWRiShMkqR7kYUQevYYCw0gm8/n085tqgOWy+XQdV2dRa1NAA7H4zFaLBa3PTQNEUI8MsY+625IRNMkSbLeXSSE2DDGZpVhZ7TGqosuh9brtUdEO6XUaVzbWNMJoA+naToBcPpwlFKRqTX/ZNrW49f7aZq+McbKOI61ZVbr/4+KXzY7gBlfd6c0AAAAAElFTkSuQmCC";const V={class:"all-staff"},q={class:"sess-check fx-ac"},j={class:"sel-radio-type fx-ac",style:{"margin-top":"4px"}},J={class:"sess-check-pro-title"},Z={class:"title fx-ac"},$={class:"nums fx-ac"},ee={class:"num"},te={class:"fir"},ae={class:"num sc-num"},se={class:"fir"},ie={class:"sec fx-ac"},le={key:0,src:z,alt:""},re={key:1,src:H,alt:""},ne={key:2,src:G,alt:""},oe=["onClick"],de={class:"i-left fx-ac"},ce=["onUpdate:modelValue","onChange"],fe={class:"i-right flex"},ue={class:"ri-top fx-ac"},pe={class:"name eliOne fx-ac"},he={class:"eliOne"},_e={class:"nums fx-ac"},me={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},ge={style:{"text-align":"center",height:"18px"}},Ae={key:1};function ve(e,t,a,i,r,n){const o=(0,s.g2)("a-input-search"),c=(0,s.g2)("a-button"),f=(0,s.g2)("a-popover"),u=(0,s.g2)("a-empty"),p=(0,s.g2)("ZmScroll"),h=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",V,[(0,s.bF)(o,{placeholder:"请输入员工名称进行搜索",onSearch:n.addPeopleSearch,style:{"margin-top":"-8px"},value:r.staff_list_params.keyword,"onUpdate:value":t[0]||(t[0]=e=>r.staff_list_params.keyword=e),valueModifiers:{trim:!0}},null,8,["onSearch","value"]),(0,s.Lk)("div",q,[(0,s.Lk)("div",j,[(0,s.bF)(f,{placement:"bottom"},{content:(0,s.k6)((()=>[(0,s.Lk)("div",J,[(0,s.Lk)("div",Z,[t[3]||(t[3]=(0,s.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,s.bF)(c,{type:"link",style:{"margin-left":"20px"},onClick:n.openSeat},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,s.Lk)("div",$,[(0,s.Lk)("div",ee,[(0,s.Lk)("div",te,(0,d.v_)(n.bind_num),1),t[4]||(t[4]=(0,s.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,s.Lk)("div",ae,[(0,s.Lk)("div",se,(0,d.v_)(n.unbind_num),1),t[5]||(t[5]=(0,s.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,s.Lk)("div",{class:"fx-ac tit",onClick:t[1]||(t[1]=(...e)=>n.sortTap&&n.sortTap(...e))},[(0,s.Lk)("div",ie,[t[6]||(t[6]=(0,s.Lk)("div",null,"客户数",-1)),0==r.sortType?((0,s.uX)(),(0,s.CE)("img",le)):(0,s.Q3)("",!0),1==r.sortType?((0,s.uX)(),(0,s.CE)("img",re)):(0,s.Q3)("",!0),2==r.sortType?((0,s.uX)(),(0,s.CE)("img",ne)):(0,s.Q3)("",!0)])])]),(0,s.bF)(p,{class:"datas-item",onLoad:n.peopleListLoad,finished:r.staff_list_nomore,loading:r.loading},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.staff_list,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"all-memeber fx-ac",key:e.id,onClick:(0,l.D$)((t=>n.wraperTap(e,a)),["stop"])},[(0,s.Lk)("div",de,[(0,s.bo)((0,s.Lk)("input",{class:"check-input",type:"checkbox","onUpdate:modelValue":t=>e.checked=t,onChange:t=>n.checkChange(e,t,a)},null,40,ce),[[l.lH,e.checked]]),(0,s.Lk)("img",{src:A,alt:"",class:(0,d.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==e.avatar}])},null,2)]),(0,s.Lk)("div",fe,[(0,s.Lk)("div",ue,[(0,s.Lk)("div",pe,[(0,s.Lk)("span",he,(0,d.v_)(e.name),1)]),(0,s.Lk)("div",_e,[t[7]||(t[7]=(0,s.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,s.Lk)("div",me,(0,d.v_)(e.cst_total),1)])])])],8,oe)))),128)),r.staff_list.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:0}))])),_:1},8,["onLoad","finished","loading"]),(0,s.Lk)("div",ge,[r.staff_list_Loading?((0,s.uX)(),(0,s.Wv)(h,{key:0,size:"small"})):(0,s.Q3)("",!0),!r.staff_list_Loading&&r.staff_list.length?((0,s.uX)(),(0,s.CE)("div",Ae,(0,d.v_)(r.staff_list_nomore?"":"下滑加载更多"),1)):(0,s.Q3)("",!0)])])}var ye=a(4379),ke=a(7875),be={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{loading:!1,staff_list:[],staff_list_params:{page:1,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,oldSelect:[],sortType:1,searchTimer:""}},components:{ZmScroll:ye.A},computed:{showStatus(){let e=!0;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},created(){this.staff_list.length||(this.loading=!1,this.getUser_get_staff_list()),this.getOldData()},watch:{selectData(){let e=this.selectData.map((e=>e.userid));for(let t=0;t<this.staff_list.length;t++){let a=this.staff_list[t];e.includes(a.userid)?a.checked=!0:a.checked=!1,this.staff_list[t]=a}},"staff_list_params.keyword"(){clearInterval(this.searchTimer),this.searchTimer=setTimeout((()=>{this.addPeopleSearch()}),500)}},methods:{addPeopleSearch(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},getUser_get_staff_list(){this.loading||this.staff_list_nomore||this.staff_list_Loading||(this.loading=!0,this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.chat_status=this.isSession),this.isAuthMode&&(this.staff_list_params.is_auth_mode=1),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.sortType?this.staff_list_params.order_by=1==this.sortType?"DESC":"ASC":this.staff_list_params.order_by="",this.staff_list_params.order_fields="cst_total",this.viewAppointPermissions&&(this.staff_list_params.permission_userids=this.viewAppointPermissions),(0,ke.Xj)(this.staff_list_params).then((e=>{if(this.staff_list_Loading=!1,!e.data.items.length)return this.staff_list_nomore=!0,this.loading=!1,!1;if(e.data&&e.data.items&&e.data.items.length){e.data.items.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.items=e.data.items.filter((e=>e[this.filterStaff.key]==this.filterStaff.value))),this.staff_list=this.staff_list.concat(e.data.items);let t=e=>{this.staff_list.forEach(((t,a)=>{e.includes(t.userid)&&(t.checked=!0)}))};t(this.selectData.map((e=>e.userid)))}this.loading=!1})))},peopleListLoad(){this.staff_list_Loading||(this.staff_list_params.page++,this.loading=!1,this.getUser_get_staff_list())},getGroup(e){return e&&e.length?e.map((e=>e.name)).join(","):"--"},setCheck(e,t){let a=this.staff_list.map((e=>e.userid)),s=a.indexOf(e.userid);this.staff_list[s]&&(this.staff_list[s].checked=!1,this.staff_list[s]=this.staff_list[s])},wraperTap(e,t){this.checkChange(e,!e.checked,t)},checkChange(e,t,a){let s=JSON.parse(JSON.stringify(this.selectData));if(e.data_type=1,e.checked=t,this.staff_list[a]=e,"multiple"!==this.selectType)this.staff_list.forEach(((t,a)=>{this.staff_list[a].checked=!1,t.userid===e.userid&&(this.staff_list[a].checked=!0)})),s=[e];else{let a=s.filter((e=>1===e.data_type)).map((e=>e.userid));if(t&&!a.includes(e.userid))s.push(e);else if(!t&&a.includes(e.userid)){let t;s.forEach(((a,s)=>{a.userid===e.userid&&(t=s)})),s.splice(t,1)}}this.$emit("setSelect",s)},sortTap(){this.staff_list_Loading||(this.sortType++,this.sortType>2&&(this.sortType=0),this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list())},getOldData(){let e={is_archive:this.isSession};this.isAuthMode&&(e.is_auth_mode=1)},oldSelectTap(e,t){e.checked=!e.checked,this.oldSelect[t]=e;let a=JSON.parse(JSON.stringify(this.selectData)),s=a.filter((e=>1===e.data_type)).map((e=>e.userid));if(s.includes(e.userid)){let t=s.indexOf(e.userid);-1!==t&&a.splice(t,1)}else e.data_type=1,"multiple"!==this.selectType?a=[e]:a.push(e);this.$emit("setSelect",a)},sessionCheck(e){this.staff_list=[],this.staff_list_nomore=!1,this.staff_list_params.page=1,this.loading=!1,this.getUser_get_staff_list()},openSeat(){window.open("/manage/index#/seatManage")}}};const we=(0,p.A)(be,[["render",ve],["__scopeId","data-v-b29d2868"]]);var Se=we;const Ce={class:"framework"},Le={style:{"margin-top":"12px"}},xe={class:"sess-check-pro-title"},De={class:"title fx-ac"},Te={class:"nums fx-ac"},Ee={class:"num"},Fe={class:"fir"},Ke={class:"num sc-num"},Re={class:"fir"},Be={class:"tree-wraper"},Ie={key:0,style:{"justify-content":"center","margin-top":"20px"},class:"fx-ac"},Ue=["onClick"],Qe=["onClick"],Xe={class:"staff-list fx-ac"},We={class:"i-left fx-ac"},Pe=["src"],Ne={class:"i-right flex"},Oe={class:"ri-top fx-ac"},Ye={class:"nums fx-ac"},Me={style:{color:"rgba(0, 0,0 ,.65)","font-weight":"500"}},ze={class:"ri-bot fx-ac"},He={class:"seat-bind-box mr5"},Ge={key:0,class:"bind-no"},Ve={key:1,class:"interflow-bind"},qe={key:2,class:"foundation-bind"},je={class:"bm eliOne"},Je={key:0,class:"c-j flex"},Ze={key:1,class:"p-t flex"},$e={key:0,class:"loading-btn"};function et(e,t,a,i,r,n){const o=(0,s.g2)("a-input-search"),c=(0,s.g2)("a-button"),f=(0,s.g2)("a-popover"),u=(0,s.g2)("a-spin"),p=(0,s.g2)("a-tree");return(0,s.uX)(),(0,s.CE)("div",Ce,[(0,s.bF)(o,{placeholder:"请输入组织架构进行搜索",modelValue:r.searchParams.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchParams.keyword=e),modelModifiers:{trim:!0},style:{"margin-top":"-8px"}},null,8,["modelValue"]),(0,s.Lk)("div",Le,[(0,s.bF)(f,{placement:"bottom"},{content:(0,s.k6)((()=>[(0,s.Lk)("div",xe,[(0,s.Lk)("div",De,[t[3]||(t[3]=(0,s.eW)(" 建议选择有席位的员工，避免核心业务受干扰 ")),(0,s.bF)(c,{type:"link",style:{"margin-left":"20px"},onClick:n.openSeat},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 绑定席位 ")]))),_:1},8,["onClick"])]),(0,s.Lk)("div",Te,[(0,s.Lk)("div",Ee,[(0,s.Lk)("div",Fe,(0,d.v_)(n.bind_num),1),t[4]||(t[4]=(0,s.Lk)("div",{class:"sec"},"有效席位员工数",-1))]),(0,s.Lk)("div",Ke,[(0,s.Lk)("div",Re,(0,d.v_)(n.unbind_num),1),t[5]||(t[5]=(0,s.Lk)("div",{class:"sec"},"到期未绑定席位员工数",-1))])])])])),_:1})]),(0,s.Lk)("div",Be,[r.showTree?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Ie,[(0,s.bF)(u)])),(0,s.bF)(u,{spinning:r.spinning},{default:(0,s.k6)((()=>[r.showTree?((0,s.uX)(),(0,s.Wv)(p,{key:0,checkable:"",props:r.props,checkStrictly:"",ref:"elTreeRef","load-data":n.loadNode,"tree-data":r.treeData,checkedKey:n.checkChange,"onUpdate:checkedKey":t[1]||(t[1]=e=>n.checkChange=e),"filter-tree-node":n.filterNode},{title:(0,s.k6)((({node:e,data:a})=>[(0,s.Lk)("div",{class:(0,d.C4)(["custom-tree-node",{"tree-node-30":a.show_more}])},[a.is_staff?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,d.C4)(["staff-wrape",{"padd-b-30":a.show_more}]),onClick:t=>n.itemTap(e,a)},[(0,s.Lk)("div",Xe,[(0,s.Lk)("div",We,[(0,s.Lk)("img",{src:a.avatar,alt:"",class:(0,d.C4)(["img",{"img-c":"/static/image/default-avatar.svg"==a.avatar}])},null,10,Pe)]),(0,s.Lk)("div",Ne,[(0,s.Lk)("div",Oe,[t[7]||(t[7]=(0,s.Lk)("div",{class:"name eliOne fx-ac",style:{"white-space":"normal"}},null,-1)),(0,s.Lk)("div",Ye,[t[6]||(t[6]=(0,s.Lk)("div",{style:{color:"rgba(0, 0,0 ,.45)"}},"客户数：",-1)),(0,s.Lk)("div",Me,(0,d.v_)(a.external_total),1)])]),(0,s.Lk)("div",ze,[(0,s.Lk)("div",He,[a.is_bind_license?2==a.license_type?((0,s.uX)(),(0,s.CE)("div",Ve)):1==a.license_type?((0,s.uX)(),(0,s.CE)("div",qe)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Ge))]),(0,s.Lk)("div",je,(0,d.v_)(a.alias?a.alias:""),1),1==a.role?((0,s.uX)(),(0,s.CE)("div",Je,"超级管理员")):(0,s.Q3)("",!0),2==a.role?((0,s.uX)(),(0,s.CE)("div",Ze,"普通员工")):(0,s.Q3)("",!0)])])]),a.show_more?((0,s.uX)(),(0,s.CE)("div",$e,[(0,s.bF)(c,{type:"dashed",ref:"loading_id"+a.loading_id,icon:"redo",onClick:(0,l.D$)((t=>n.loadMoreTap(e,a)),["stop"])},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)(" 点击加载更多 ")]))),_:2},1032,["onClick"])])):(0,s.Q3)("",!0)],10,Qe)):((0,s.uX)(),(0,s.CE)("div",{key:0,onClick:t=>n.itemTap(e,a)},(0,d.v_)(a.department_name)+" ("+(0,d.v_)(a.staff_count)+")",9,Ue))],2)])),_:1},8,["props","load-data","tree-data","checkedKey","filter-tree-node"])):(0,s.Q3)("",!0)])),_:1},8,["spinning"])])])}var tt={name:"",props:["selectData","selectType","isSession","isAuthMode","excludeRole","bind_type","filterStaff","group_chat","viewAppointPermissions"],data(){return{treeData:[],searchParams:{keyword:""},props:{children:"child",isLeaf:function(e,t){return e.child&&0===e.child.length}},staff_list_params:{page:0,size:20,department_type:1},staff_list_Loading:!1,staff_list_nomore:!0,textures_list:[],currTotal:0,currSelectKeys:[],department_ids:[],spinning:!1,showTree:!0}},computed:{showStatus(){let e=0==this.$store.state.user.active_corp.setting_status||3==this.$store.state.user.active_corp.setting_status;return e},bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0}},components:{},watch:{"searchParams.keyword"(){this.$refs.elTreeRef.filter(this.searchParams.keyword)},selectData(){let e=this.selectData.filter((e=>1===e.data_type)).map((e=>e.staff_id));e.forEach((e=>{this.currSelectKeys.includes(e)||(this.currSelectKeys.push(e),this.setTreeKeys())}))}},created(){this.initNode()},methods:{clearCheck(){this.currSelectKeys=[],this.setTreeKeys()},clearParKey(){this.currSelectKeys=this.currSelectKeys.filter((e=>-1!=e.indexOf("_"))),setTimeout((()=>{this.setTreeKeys()}),500)},setCheck(e,t,a){if(1===a)this.department_ids.forEach((t=>{let a=this.currSelectKeys.findIndex((a=>a===t+"_"+e.staff_id));-1!==a&&this.currSelectKeys.splice(a,1)})),this.setTreeKeys();else if(2===a){let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&(this.currSelectKeys.splice(t,1),this.setTreeKeys())}},filterNode(e){return e.department_name?e.department_name:e.name?e.name:void 0},itemTap(e,t){if(t.disabled)return;let{department_id:a}=t;if("multiple"!==this.selectType)this.currSelectKeys=[a],this.setTreeKeys();else if(this.currSelectKeys.includes(a)){let e=this.currSelectKeys.findIndex((e=>e===a));-1!==e&&(this.currSelectKeys.splice(e,1),this.setTreeKeys())}else this.currSelectKeys.push(a),this.setTreeKeys()},checkChange(e,t){if(t)this.currSelectKeys.includes(e.department_id)||this.currSelectKeys.push(e.department_id);else{let t=this.currSelectKeys.findIndex((t=>t===e.department_id));-1!==t&&this.currSelectKeys.splice(t,1)}let a=JSON.parse(JSON.stringify(this.selectData)),{is_staff:s}=e;if(s){if(e.data_type=1,"multiple"!==this.selectType)a=[e];else{let s=a.filter((e=>1===e.data_type)).map((e=>e.staff_id));t&&!s.includes(e.staff_id)?a.push(e):!t&&s.includes(e.staff_id)&&a.splice(a.findIndex((t=>t.staff_id==e.staff_id)),1)}this.$emit("setSelect",a)}else{e.data_type=2;let s=a.filter((e=>2===e.data_type)).map((e=>e.department_id));if(t&&!s.includes(e.department_id))this.$emit("setLoading",!0),this.getCurrStaffList(e).then((t=>{e.staff_list=t,a.push(e),this.$emit("setLoading",!1),this.$emit("setSelect",a)}));else if(!t&&s.includes(e.department_id)){let t;a.forEach(((a,s)=>{a.department_id===e.department_id&&(t=s)})),a.splice(t,1),this.$emit("setSelect",a)}}},setTreeKeys(){this.$refs.elTreeRef.setCheckedKeys(this.currSelectKeys)},getFrameWorkList(){this.spinning=!0;let e={};this.isSession&&(e.is_session=this.isSession),this.isAuthMode&&(e.is_auth_mode=1);let t={msg:"成功",res:0,data:{list:[{department_id:"1",department_order:"100000000",department_parent_id:"0",department_name:"武汉铁杵磨针网络科技有限公司",staff_count:26,child:[{department_id:"2",department_order:"100000000",department_parent_id:"1",department_name:"测试",child:[{department_id:"4",department_order:"100000000",department_parent_id:"2",department_name:"测试1",child:[{department_id:"5",department_order:"100000000",department_parent_id:"4",department_name:"测试11",child:[],staff_count:1}],staff_count:2}],staff_count:4},{department_id:"3",department_order:"99999000",department_parent_id:"1",department_name:"开发",child:[],staff_count:9}]}]}};if(this.spinning=!1,t&&t.data&&t.data.list){this.textures_list=t.data.list;let e=[],a=t=>{t.forEach((t=>{t.disabled=1*t.staff_count>500||"multiple"!==this.selectType,e.push(t.department_id),t.child&&t.child.length?a(t.child):delete t.child}))};return a(t.data.list),this.department_ids=e,Promise.resolve(t.data.list)}},setNodeSty(){this.$nextTick((()=>{let e=document.querySelectorAll(".a-tree-node__content");e.forEach((e=>{e.getElementsByTagName("label")[0].style.marginTop=0}));let t=document.querySelectorAll(".tree-node-30");t.forEach((e=>{let t=e.parentNode.getElementsByTagName("label");t[0].style.marginTop="-40px"}))}))},async loadMoreTap(e,t){this.$refs["loading_id"+t.loading_id].$el.__vue__.sLoading=!0;let a=e.parent.childNodes.map((e=>e.data));a.forEach((e=>e.show_more=!1)),this.staff_list_nomore=!1,this.staff_list_params.department_id=t.par_department_id,this.staff_list_params.page=t.cur_page+1;let s=await this.getUser_get_staff_list();s.forEach(((e,a)=>{e.child=[],e.is_staff=!0,e.par_department_id=t.par_department_id,e.cur_page=t.cur_page+1,e.department_id=t.par_department_id+"_"+e.staff_id,e.loading_id=e.staff_id})),s[s.length-1]&&(s[s.length-1].show_more=!this.staff_list_nomore);let i=[...a,...s];this.$refs.elTreeRef.updateKeyChildren(t.par_department_id,i),this.setNodeSty()},async initNode(){let e=await this.getFrameWorkList();this.treeData=e},async loadNode(e,t){this.staff_list_nomore=!1,this.staff_list_params.department_id=e.department_id,this.staff_list_params.page=1;let a=await this.getUser_get_staff_list();a.forEach(((t,a)=>{t.child=[],t.is_staff=!0,t.par_department_id=e.department_id,t.cur_page=1,t.department_id=e.department_id+"_"+t.staff_id,t.loading_id=t.staff_id}));let s=e.child||[];a[a.length-1]&&(a[a.length-1].show_more=!this.staff_list_nomore),this.treeData=[...s,...a],this.setNodeSty()},getUser_get_staff_list(){if(this.staff_list_nomore)return;if(this.staff_list_Loading)return;this.staff_list_Loading=!0,this.isSession&&(this.staff_list_params.is_session=this.isSession),this.excludeRole&&(this.staff_list_params.exclude_role=this.excludeRole),this.bind_type&&(this.staff_list_params.bind_type=this.bind_type),this.group_chat&&(this.staff_list_params.group_chat=this.group_chat),this.viewAppointPermissions&&(this.staff_list_params.permission_staff_ids=this.viewAppointPermissions);let e={msg:"成功",res:0,data:{pagination:{curPage:1,pageSize:20,total:13,totalCount:13,hasNextPage:!1},list:[{staff_id:"3587",name:"黄思龙",user_id:"woX2IKEAAAstH9Dx0LRajnJjSgmPDbyw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3451",name:"Felix余鑫",user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAm_uUslSAymm573gATC43vw",external_total:"0",alias:"",is_bind_license:!0,group:[],ready_to_bind:0,license_type:"2"},{staff_id:"3450",name:"stone",user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAtvHwkoi2laqJTkWSdSi_cw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3432",name:"彭建龙1",user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAsNjcTJgudtY18D4eeB-GBA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3167",name:"zhanglong",user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAKnG6KFdxwZAqi-TJdnADSA",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3149",name:"colson",user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAA9Y1ZmvLwKCQQe8rYQqd2aQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3100",name:"sizz",user_id:"woX2IKEAAAEN39PCRL-cxrsgBhqdUmMg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"sizz",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3084",name:"fred",user_id:"woX2IKEAAAcN5qt6p6gBLbFMC0i8VFuQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"3083",name:"王小鹏测试机",user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAALLtiAkJFasYV_FiYsCxGEw",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"2481",name:"钱楚",user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAIeC_R9U1gvkb-iAHM9hdcg",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1893",name:"老贾",user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"woX2IKEAAAFNWOLr07oLgsdR5OCJgCkQ",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1889",name:"王进华",user_id:"woX2IKEAAAzc9fAQaEkE63j_g5SeXo6Q",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"Fox",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2},{staff_id:"1888",name:"时光",user_id:"woX2IKEAAAe7bfgnclYNTM512bBfODtg",avatar:"/static/image/default-avatar.svg",role:"2",encry_user_id:"",external_total:"0",alias:"",is_bind_license:!1,group:[],ready_to_bind:1,license_type:2}]}};if(this.staff_list_Loading=!1,e.data&&e.data.list&&e.data.list.length){e.data.list.length<this.staff_list_params.size&&(this.staff_list_nomore=!0),this.filterStaff.key&&(e.data.list=e.data.list.filter((e=>e[this.filterStaff.key]==this.filterStaff.value)));let t=t=>{e.data.list.forEach((e=>{t.includes(e.staff_id)&&(this.department_ids.forEach((t=>{let a=t+"_"+e.staff_id;this.currSelectKeys.includes(a)||this.currSelectKeys.push(a)})),this.setTreeKeys())}))};return t(this.selectData.map((e=>e.staff_id))),this.currTotal=e.data.pagination.total,Promise.resolve(e.data.list)}return Promise.resolve([])},getCurrStaffList(e){let t={page:1,size:1e3,department_id:e.department_id};return this.isSession&&(t.is_session=this.isSession),this.excludeRole&&(t.exclude_role=this.excludeRole),this.bind_type&&(t.bind_type=this.bind_type),this.group_chat&&(t.group_chat=this.group_chat),this.viewAppointPermissions&&(t.permission_staff_ids=this.viewAppointPermissions),this.$api.user_get_staff_list(t).then((e=>Promise.resolve(e.data.list))).catch((e=>Promise.resolve([])))},sessionCheck(e){this.showTree=!1,setTimeout((e=>{this.showTree=!0}),500)},openSeat(){window.open("/manage/index#/seatManage")}}};const at=(0,p.A)(tt,[["render",et],["__scopeId","data-v-2130d9e8"]]);var st=at;const it={class:"cont fx-ac",style:{"margin-top":"10px"}};function lt(e,t,a,i,l,r){const n=(0,s.g2)("a-input"),o=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.Wv)(o,{open:l.visible,"onUpdate:open":t[1]||(t[1]=e=>l.visible=e),"confirm-loading":l.confirmLoading,onOk:r.handleOk,width:"472px",onCancel:r.handleCancel},{default:(0,s.k6)((()=>[t[3]||(t[3]=(0,s.Lk)("div",{slot:"title",class:"fx-ac"},[(0,s.Lk)("div",{class:"fir-tit"},"创建标签"),(0,s.Lk)("div",{class:"sec-tit"},"确定将当前已选员工新建标签？")],-1)),(0,s.Lk)("div",it,[t[2]||(t[2]=(0,s.Lk)("div",{class:"fir fx-ac"},[(0,s.Lk)("span",null,"*"),(0,s.eW)("标签名称：")],-1)),(0,s.bF)(n,{maxLength:32,style:{width:"262px"},modelValue:l.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.name=e),modelModifiers:{trim:!0},placeholder:"请输入标签名称"},null,8,["modelValue"])])])),_:1},8,["open","confirm-loading","onOk","onCancel"])}var rt=a(7277);const nt={user_get_corp_group_list:(e={})=>rt.Ay.post("/user/get-corp-group-list",e),user_edit_corp_group:(e={})=>rt.Ay.post("/user/edit-corp-group",e),user_add_corp_group:(e={})=>rt.Ay.post("/user/add-corp-group",e),user_del_corp_group:(e={})=>rt.Ay.post("/user/del-corp-group",e),user_get_staff_list:(e={})=>rt.Ay.get("/user/get-staff-list",{params:e}),user_get_simple_staff_list:(e={})=>rt.Ay.get("/user/get-simple-staff-list",{params:e}),user_add_group_member:(e={})=>rt.Ay.post("/user/add-group-member",e),user_remove_staff_group:(e={})=>rt.Ay.post("/user/remove-staff-group",e),user_get_group_by_staff:(e={})=>rt.Ay.post("/user/get-group-by-staff",e),user_get_corp_group_list_by_page:(e={})=>rt.Ay.post("/user/get-corp-group-list-by-page",e),getDepartmentList:(e={})=>rt.Ay.get("/user/get-department-list",{params:e}),getStaffGroupList:(e={})=>rt.Ay.get("/user/get-staff-group-list",{params:e}),bookTagGetLocalTagList:(e={})=>rt.Ay.get("/corp-address-book-tag/get-local-tag-list",{params:e}),bookTagAddTag:(e={})=>rt.Ay.post("/corp-address-book-tag/add-tag",e),bookTagDelTag:(e={})=>rt.Ay.post("/corp-address-book-tag/delete-tag",e),bookTagEditTag:(e={})=>rt.Ay.post("/corp-address-book-tag/edit-tag",e),bookTagAddStaff:(e={})=>rt.Ay.post("/corp-address-book-tag/add-staff-to-tag",e),bookTagGetTagStaff:(e={})=>rt.Ay.get("/corp-address-book-tag/get-local-staff-list-by-tag",{params:e}),bookTagDelTagStaff:(e={})=>rt.Ay.post("/corp-address-book-tag/remove-staff-from-tag",e),bookTagGetAllTagStaff:(e={})=>rt.Ay.get("/corp-address-book-tag/get-tag-staff-list",{params:e})};var ot=nt,dt={name:"",data(){return{visible:!1,name:"",confirmLoading:!1,staff:[]}},mounted(){},methods:{show(e){this.staff=e,this.name="",this.visible=!0},handleOk(){if(!this.name)return this.$message.error("请输入标签名称");this.createName().then((e=>{this.confirmLoading=!0,ot.bookTagAddStaff({tag_id:e,staff_id_list:this.staff.map((e=>e.staff_id)).join(",")}).then((t=>{if(this.confirmLoading=!1,0==t.res)return this.$message.success("操作成功"),this.handleCancel(),void this.$emit("initFunc",e);this.$message.error(t.msg)})).catch((e=>{this.confirmLoading=!1}))}))},createName(){return new Promise(((e,t)=>{this.confirmLoading=!0,ot.bookTagAddTag({tag_name:this.name}).then((a=>{this.confirmLoading=!1,0!=a.res?(t(),this.$message.error(a.msg)):e(a.data)})).catch((e=>{t(),this.confirmLoading=!1}))}))},handleCancel(){this.visible=!1}}};const ct=(0,p.A)(dt,[["render",lt],["__scopeId","data-v-38a89d7f"]]);var ft=ct,ut={name:"selectStaffNew",components:{allStaff:Se,newFramework:st,addTag:ft},props:{addPeopleShow:{type:Boolean,default:function(){return!1}},addConfirmLoading:{type:Boolean,default:function(){return!1}},title:{type:String,default:function(){return""}},selectType:{type:String,default:function(){return""}},isSession:{default:""},excludeRole:{default:""},bind_type:{default:""},filterStaff:{type:Object,default:function(){return{}}},group_chat:{default:""},emptyCanClose:{default:!1},isAuthMode:{default:!1},viewAppointPermissions:{type:Array,default:()=>[]},maxStaffNum:{type:Number,default:-1}},data(){return{staff_list:[],staff_list_params:{page:0,size:10,keyword:""},staff_list_Loading:!1,staff_list_nomore:!1,pageStaffSize:50,selectData:[],selectDataAll:[],searchSelectData:[],selectOnSearchVal:"",alreadyAddPeopeList:[],selectDataShow:!0,oldData:null,newData:null,tabAcitive:1,big_spinning:!1,funcShow:!1,hasSetEditData:!1,hideTagName:"",batchDelTime:null,staffNameMap:{}}},computed:{bind_num(){return this.$store.state.user.staff_seat.bind_num||0},unbind_num(){return this.$store.state.user.staff_seat.unbind_num||0},dialogShow(){return this.addPeopleShow||this.funcShow},showStatus(){let e=!0;return e}},watch:{tabAcitive(){localStorage.setItem("select-staff-tab",this.tabAcitive)}},created(){let e=localStorage.getItem("select-staff-tab");e&&(this.tabAcitive=isNaN(1*e)?1:1*e)},methods:{modalATitle(){console.log("刷新"),this.$refs.tabRef_1.addPeopleSearch()},async show(e){if(clearInterval(this.batchDelTime),this.pageStaffSize=50,this.funcShow=!0,e&&Array.isArray(e)){let t=Date.now();this.hasSetEditData=!0,e.forEach((e=>{e.data_type=1,e.id=t++})),this.selectDataAll=e,this.selectData=this.selectDataAll.slice(0,this.pageStaffSize)}},dragstart(e){this.oldData=e},dragenter(e,t){this.newData=e,t.preventDefault()},dragend(e,t){if(this.oldData!==this.newData){let e=this.selectData.indexOf(this.oldData),t=this.selectDataAll.indexOf(this.oldData),a=this.selectData.indexOf(this.newData),s=this.selectDataAll.indexOf(this.newData),i=[...this.selectData],l=[...this.selectDataAll];i.splice(e,1),l.splice(t,1),i.splice(a,0,this.oldData),l.splice(s,0,this.oldData),this.selectData=[...i],this.selectDataAll=[...l]}},dragover(e){e.preventDefault()},setSelect(e){let t=Date.now();if(this.maxStaffNum>-1&&e.length>this.maxStaffNum&&(e=e.slice(0,this.maxStaffNum),this.$emit("limit")),this.selectDataAll=e.map((e=>{e.id=t++})),this.selectOnSearchVal){let e=this.selectDataAll.filter((e=>-1!==e.name.indexOf(this.selectOnSearchVal)));this.searchSelectData=e}this.selectDataAll=e,this.selectData=e.slice(0,e.length>50?this.selectData.length:this.pageStaffSize)},setLoading(e){this.big_spinning=e},setScrollbarClear(){this.$nextTick((()=>{this.$refs.scrollbarRef&&this.$refs.scrollbarRef.wrap&&(this.$refs.scrollbarRef.wrap.scrollTop=0)})),this.selectDataAll=[],this.batchDelData()},batchDelData(){this.batchDelTime&&clearInterval(this.batchDelTime),this.batchDelTime=setInterval((()=>{0!=this.selectData.length?this.selectData.splice(0,100):clearInterval(this.batchDelTime)}),500)},addPeopleHandleCancel(e){this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancel"),this.$emit("cancelSelect")},selectDelete(e,t){let a=this.selectData.findIndex((t=>t.id===e.id));if(this.searchSelectData.length){this.searchSelectData.splice(a,1);let t=this.selectData.map((e=>e.userid));this.selectData.splice(t.indexOf(e.userid),1),this.selectDataAll.splice(t.indexOf(e.userid),1)}else this.selectData.splice(a,1),this.selectDataAll.splice(a,1);console.log("ss",e,t),this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,a,t)},deleteAll(){console.log("ss1",this.selectDataAll),this.selectDataAll.forEach(((e,t)=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].setCheck(e,t,e.data_type)})),this.selectData=[],this.selectDataAll=[]},selectOnSearch(e){if(!e)return void(this.searchSelectData=[]);let t=this.selectDataAll.filter((t=>-1!==t.name.indexOf(e)));this.searchSelectData=t},addPeopleHandleOk(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],a=[];e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),a.push(e))})),this.$emit("selectStaff",a),this.$emit("change",a),this.emptyCanClose&&0==a.length||(this.setScrollbarClear(),this.funcShow&&(this.funcShow=!1),this.$emit("cancleSelect"))},setOldData(e){e.length&&this.$api.setLatelyChooseUser({user_id:e.map((e=>e.userid))}).then((e=>{this.$refs["tabRef_1"]&&this.$refs["tabRef_1"].getOldData()}))},createTag(){let e=[];this.selectDataAll.forEach((t=>{1===t.data_type?e.push(t):2!==t.data_type&&3!==t.data_type&&4!==t.data_type||(e=e.concat(t.staff_list))}));let t=[],a=[];return e.forEach((e=>{t.includes(e.userid)||(t.push(e.userid),a.push(e))})),a.length?a.some((e=>!e.userid))?this.$message.warning("选择的员工数据userid为空"):void this.$refs.addTagRef.show(a):this.$message.warning("请选择员工")},initMemberTag(e){e&&this.$emit("initFunc",e),this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].initMember(),"/staffManage"==this.$route.path&&(this.funcShow=!1)},hideTag(e){this.hideTagName=e,setTimeout((()=>{this.$refs["tabRef_4"]&&this.$refs["tabRef_4"].$refs.elTreeRef_2.filter(e)}),500)},scrollLoad(){this.selectData.length!=this.selectDataAll.length&&(this.selectData=this.selectData.concat(this.selectDataAll.slice(this.selectData.length,this.selectData.length+this.pageStaffSize)))}},beforeUnmount(){clearInterval(this.batchDelTime)}};const pt=(0,p.A)(ut,[["render",M],["__scopeId","data-v-14ca2758"]]);var ht=pt;const _t={key:0,style:{display:"flex","flex-wrap":"wrap"}},mt={key:0,class:"fx-ac",style:{flex:"1"}},gt={key:0,class:"fx-ac",style:{flex:"1"}};var At={__name:"select-staff-box-normal",props:{title:{type:String,default:"选择员工"},btnText:{type:String,default:"添加员工"},btnType:{type:String,default:"dashed"},btnStyle:{type:String,default:"margin-right: 16px;"},showSelectStaff:{type:Boolean,default:!0},showClearSelectStaff:{type:Boolean,default:!1},selectType:{default:"multiple"},showStaffApproveTip:{default:!1},selectedStaffs:{type:Array,default(){return[]}},isTag:{type:Boolean,default:!0},showSeatTip:{type:Boolean,default:!1},maxShowWidth:{}},emits:"change",setup(e,{emit:t}){const a=t,l=e,r=(0,i.KR)(null),n=(0,s.EW)((()=>l.selectedStaffs)),o=e=>{n.value=e,a("change",e||[])},c=e=>{n.value.splice(e,1),a("change",n.value)},f=()=>{l.showClearSelectStaff?r.value.show([]):r.value.show(n.value)};return(0,s.sV)((()=>{})),(t,a)=>{const l=(0,s.g2)("a-button"),u=(0,s.g2)("a-avatar"),p=(0,s.g2)("a-tooltip"),h=(0,s.g2)("a-tag");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(l,{type:e.btnType,style:(0,d.Tr)(e.btnStyle),onClick:f},{default:(0,s.k6)((()=>[(0,s.bF)((0,i.R1)(g.A)),(0,s.eW)(" "+(0,d.v_)(e.btnText),1)])),_:1},8,["type","style"]),e.showSelectStaff?((0,s.uX)(),(0,s.CE)("div",_t,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,((t,a)=>((0,s.uX)(),(0,s.Wv)(h,{key:t.userid,closable:"",onClose:e=>c(a),style:{"margin-top":"6px"},class:(0,d.C4)(["fx-ac tag",{"red-tip":e.showSeatTip&&!t.is_bind_license}])},{default:(0,s.k6)((()=>[(0,s.bF)(p,null,{default:(0,s.k6)((()=>[e.showSeatTip?((0,s.uX)(),(0,s.CE)("div",mt,[(0,s.bF)(u,{size:20,src:(0,i.R1)(A),style:{"margin-right":"4px"}},null,8,["src"]),(0,s.Lk)("span",null,(0,d.v_)(t.name),1)])):(0,s.Q3)("",!0)])),_:2},1024),e.showSeatTip?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",gt,[(0,s.bF)(u,{size:20,src:(0,i.R1)(A),style:{"margin-right":"4px"}},null,8,["src"]),(0,s.Lk)("span",null,(0,d.v_)(t.name),1)]))])),_:2},1032,["onClose","class"])))),128))])):(0,s.Q3)("",!0),(0,s.bF)((0,i.R1)(ht),{selectType:"multiple",ref_key:"setStaff",ref:r,onChange:a[0]||(a[0]=e=>o(e))},null,512)])}}};const vt=(0,p.A)(At,[["__scopeId","data-v-123a009c"]]);var yt=vt,kt=a(391),bt=a(8298),wt=a(9660);const St={class:"loading-box"};function Ct(e,t){const a=(0,s.g2)("a-spin");return(0,s.uX)(),(0,s.CE)("div",St,[(0,s.bF)(a)])}const Lt={},xt=(0,p.A)(Lt,[["render",Ct],["__scopeId","data-v-3d53ffb8"]]);var Dt=xt;const Tt={class:"zm-main-content"},Et={key:0,class:"mt8"},Ft={class:"mt8"},Kt={class:"content-box mt8"},Rt={class:"compact-item"},Bt={class:"compact-item mt8"},It={class:"zm-flex-center"},Ut={class:"content-box mt8"},Qt={class:"zm-fixed-bottom-box in-module"};var Xt={__name:"store",setup(e){const t=(0,r.lq)(),a=(0,r.rd)(),d=(0,i.KR)(null),c=(0,i.KR)(null),f=(0,i.KR)(0),u=(0,i.KR)(!0),p=(0,i.KR)(!1),h=((0,i.KR)(1),(0,i.KR)([]),(0,i.Kh)({filter_full_match_word_list:[],filter_half_match_word_list:[],worktime_data:[]})),g=(0,i.Kh)({name:"",inspect_time_type:1,timeout_unit:1,timeout_value:"",is_remind_staff_himself:!1,is_remind_staff_designation:!1,designate_remind_userid_list:[],staff_userid_list:[],custom_time_list:[],staff_user_list:[],remind_staff_user_list:[]});(0,i.KR)([]),(0,i.KR)({}),(0,i.KR)([]);async function A(){await v(),t.query.rule_id>0?(f.value=t.query.rule_id,y()):u.value=!1}async function v(){await(0,kt.EX)().then((e=>{let t=e.data||{},a=t.working_hours||[];t.worktime_data=(0,wt.v)(a),(0,bt.AB)(h,t)}))}function y(){u.value=!0,(0,kt.lS)(f.value).finally((()=>{u.value=!1})).then((e=>{let t=e.data||{};switch(t.timeout_unit=t.timeout_unit.value,t.inspect_time_type=t.inspect_time_type.value,(0,bt.AB)(g,t),t.inspect_time_type){case 2:k();break;case 3:let e=(0,wt.v)(t.custom_time_list);(0,s.dY)((()=>{c.value.input(e)}));break}}))}function k(){2==g.inspect_time_type&&(0,s.dY)((()=>{d.value.input(h.worktime_data)}))}function b(e){g.staff_userid_list=e.map((e=>e.userid)),g.staff_user_list=e}function w(e,t){g.designate_remind_userid_list=e.map((e=>e.userid)),g.remind_staff_user_list=e}function S(){let e=a.resolve({path:"/module/timeout-reply-single/rule"});(0,bt.fA)("timeout_reply_single",e.href)}function C(){g.name=g.name.trim();try{if(!g.name)throw"请输入规则名称";if(!g.staff_userid_list.length)throw"请选择质检员工";if(3==g.inspect_time_type){let e=c.value.verify();if(!e.ok)throw e.error}if(!g.timeout_value)throw"请输入超过时间";if(!g.is_remind_staff_himself&&!g.is_remind_staff_designation)throw"请选择提醒员工";if(g.is_remind_staff_designation&&!g.designate_remind_userid_list.length)throw"请指定提醒员工";return!0}catch(e){return console.log("Err:",e),n.Ay.error(e),!1}}function L(){a.push({path:"/module/timeout-reply-single/index"})}async function x(){try{if(!C())return;p.value=!0;let e={...g};if(e.custom_time_list=[],3===e.inspect_time_type){let t=c.value.output();e.custom_time_list=t.map((e=>{let t=e.ranges.map((e=>({start:e.times[0],end:e.times[1]})));return{week_day_list:e.week,time_period_list:t}}))}delete e.staff_user_list,delete e.remind_staff_user_list,f.value>0?await(0,kt.Ao)(f.value,e):await(0,kt.XP)(e),n.Ay.success("已保存"),setTimeout((()=>{L()}),1200)}catch(e){p.value=!1}}return(0,s.sV)((()=>{A()})),(e,t)=>{const a=(0,s.g2)("a-input"),r=(0,s.g2)("a-form-item"),n=(0,s.g2)("a-radio"),A=(0,s.g2)("a-radio-group"),v=(0,s.g2)("a-button"),y=(0,s.g2)("a-select"),C=(0,s.g2)("a-input-number"),D=(0,s.g2)("a-checkbox"),T=(0,s.g2)("a-form");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(_,{title:[{name:"单聊超时",route:"/module/timeout-reply-single/index"},{name:f.value>0?"编辑规则":"新增规则"}]},null,8,["title"]),(0,s.Lk)("div",Tt,[u.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0})):((0,s.uX)(),(0,s.Wv)(T,{key:1,class:"form-box",labelCol:{span:4},wrapperCol:{span:20}},{default:(0,s.k6)((()=>[(0,s.bF)(r,{label:"规则名称",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(a,{value:g.name,"onUpdate:value":t[0]||(t[0]=e=>g.name=e),placeholder:"请输入规则名称",style:{width:"320px"},"max-length":50},null,8,["value"])])),_:1}),(0,s.bF)(r,{label:"质检员工",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(yt,{selectedStaffs:g.staff_user_list,onChange:b},null,8,["selectedStaffs"])])),_:1}),(0,s.bF)(r,{label:"质检时间",required:""},{default:(0,s.k6)((()=>[(0,s.bF)(A,{value:g.inspect_time_type,"onUpdate:value":t[1]||(t[1]=e=>g.inspect_time_type=e),onChange:k},{default:(0,s.k6)((()=>[(0,s.bF)(n,{value:1},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("全天质检")]))),_:1}),(0,s.bF)(n,{value:3},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("自定义质检时间")]))),_:1}),(0,s.bF)(n,{value:2},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)("工作时间")]))),_:1})])),_:1},8,["value"]),3==g.inspect_time_type?((0,s.uX)(),(0,s.CE)("div",Et,[((0,s.uX)(),(0,s.Wv)(m.A,{key:1,ref_key:"customTimeRangeRef",ref:c}))])):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",Ft,[((0,s.uX)(),(0,s.Wv)(m.A,{key:2,ref_key:"timeRangeRef",ref:d,disabled:"",showAddBtn:!1})),(0,s.bF)(v,{onClick:S,type:"dashed",icon:(0,s.h)((0,i.R1)(o.A)),style:{width:"100%"}},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)("编辑工作时间 ")]))),_:1},8,["icon"])],512),[[l.aG,2==g.inspect_time_type]])])),_:1}),(0,s.bF)(r,{label:"过滤关键词",required:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[t[11]||(t[11]=(0,s.eW)("过滤关键词可到聊天统计-统计规则中设置")),(0,s.Lk)("a",{onClick:S,class:"ml8"},"去设置")]),t[15]||(t[15]=(0,s.Lk)("div",{class:"zm-tip-info"}," 关键词（单聊时，客户发送的最后一句话成功匹配到关键词，且员工没有回复，不算作未回复消息） ",-1)),(0,s.Lk)("div",Kt,[(0,s.Lk)("div",Rt,[t[12]||(t[12]=(0,s.Lk)("div",{class:"tag"},"全匹配",-1)),(0,s.bF)(y,{value:h.filter_full_match_word_list,"onUpdate:value":t[2]||(t[2]=e=>h.filter_full_match_word_list=e),mode:"tags",style:{width:"100%"},placeholder:"暂无过滤关键词",disabled:""},null,8,["value"])]),(0,s.Lk)("div",Bt,[t[13]||(t[13]=(0,s.Lk)("div",{class:"tag"},"半匹配",-1)),(0,s.bF)(y,{value:h.filter_half_match_word_list,"onUpdate:value":t[3]||(t[3]=e=>h.filter_half_match_word_list=e),mode:"tags",style:{width:"100%"},placeholder:"暂无过滤关键词",disabled:""},null,8,["value"])])]),(0,s.bF)(v,{onClick:S,class:"mt8",type:"dashed",icon:(0,s.h)((0,i.R1)(o.A)),style:{width:"100%"}},{default:(0,s.k6)((()=>t[14]||(t[14]=[(0,s.eW)("编辑未回复规则 ")]))),_:1},8,["icon"])])),_:1}),(0,s.bF)(r,{label:"提醒员工",required:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",It,[t[16]||(t[16]=(0,s.Lk)("span",{class:"mr4"},"超过",-1)),(0,s.bF)(C,{value:g.timeout_value,"onUpdate:value":t[4]||(t[4]=e=>g.timeout_value=e),placeholder:"请输入",precision:0,max:1440},null,8,["value"]),t[17]||(t[17]=(0,s.Lk)("span",{class:"ml4"},"分钟",-1)),t[18]||(t[18]=(0,s.Lk)("span",{class:"ml4"},"未回复客户消息的单聊，给员工发送提醒",-1))]),(0,s.Lk)("div",Ut,[(0,s.bF)(D,{checked:g.is_remind_staff_designation,"onUpdate:checked":t[5]||(t[5]=e=>g.is_remind_staff_designation=e)},{default:(0,s.k6)((()=>t[19]||(t[19]=[(0,s.eW)("指定员工提醒")]))),_:1},8,["checked"]),(0,s.bF)(D,{checked:g.is_remind_staff_himself,"onUpdate:checked":t[6]||(t[6]=e=>g.is_remind_staff_himself=e)},{default:(0,s.k6)((()=>t[20]||(t[20]=[(0,s.eW)("提醒员工本人")]))),_:1},8,["checked"]),g.is_remind_staff_designation?((0,s.uX)(),(0,s.Wv)(yt,{key:0,"selected-staffs":g.remind_staff_user_list,onChange:w,class:"mt16"},null,8,["selected-staffs"])):(0,s.Q3)("",!0)])])),_:1})])),_:1})),(0,s.Lk)("div",Qt,[(0,s.bF)(v,{onClick:L},{default:(0,s.k6)((()=>t[21]||(t[21]=[(0,s.eW)("取 消")]))),_:1}),(0,s.bF)(v,{class:"ml8",type:"primary",onClick:x,loading:p.value},{default:(0,s.k6)((()=>t[22]||(t[22]=[(0,s.eW)("保 存")]))),_:1},8,["loading"])])])])}}};const Wt=(0,p.A)(Xt,[["__scopeId","data-v-410f6ba1"]]);var Pt=Wt},7767:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA/tJREFUaEPtmk9slEUUwH/v6y5tFVpNgVBppSghYsVIqBFMTIxWapp4oD0RNfHmSSIHT8YT9mRiI568mZhIPLQk1aBgSbyBAmIIBaKEFi1UKaZxqdDt7n7PvG9dUpXdnV1m20/jO33ZfTPzfvNm5r35IyyQfQe1/rccz4qGPUAv0A7UL9RZgu8sMClwgCA8tCJIfLW7V9IFO6TwMfCFtobpcI8IrwJNS2CoS5PTqnwYZIPBN/tlygpEAJHx8zok6HaXWpZaR5GjQUb6DUKiYZMJ94rwxlIbVkn7qrzTnAzekoHPMj0aBh8BqyqpIAa6KZVglwyM5N5V2BMDg6oxYZ+8PZIbBzqqKR2DMhcMIAMkYmBMNSakDUCrKRmXMv8DFPPEsgQ0JPP/zmdhzgZqDcS7B+oTsOk+4aHWvwKcnoRzV5Rc6JfCK0BTA+zsCmi79/ZGTs7AgZMhqZv+ILwB3LUMujuFzW230qvbWjl2WRk9q8zO+YHwBrC1Q3iuU6gLShsWKhw5q3xz0c/i5w1g1zbhgVWle7+ANn5N+fhozABe6w5oanQbFjfSMHjYz2z25oHXdwTc7bj1sUn8/mjMAF7cLnSsdBtCF6eV/cdiNoSeeFB4ZpMQlGHIhjA6ppyciBnA8gbofljoXFua4Myk8uWYcmPebb6U0/I2B6whC2R9XQFriwSyyzMwHNdAVugpiwMb1wiPtkNjMr/pvpmB81P5VCJtZwwexasHFtqVrPsTQPIAltDVQmoGYNmoecM8YAmc754vdIY3AFt91jQTLaUrV4DlRhGA5AEs95n5HS5cVaav53/zIXcM0HoPbFgtPLZOoknsIqk5ODWhfP+LcjXlUqK4TtUANsYt739qo9DcmO/pSsSSOvPI8XHlux+r3ydUBWA9/cKWgPtbKBu4XKAu/Qojp6rbJ1QMYMZb3m+971POTWkUoSvd7FQEYJPypSeL77juFMg88cnXIZmce00VAdim5fnNfnv+76Z+fjrk20s1AFjdBH1bA1qWu1dejea1WRg+EUZLrYs4e+Dx9RKN/XLZpkujpXQsPthcOOGYrToD9HfZUUlth08B7PzPytBxt3TbGWDHI4J5YTHEYsPhM54BbPncsk5ob6kdgipcmckHt9lbt2Cl23P2gFVj479wXFgLDAOwpM+itKtUBOBa6WLq/ScA7JDP8UBkMfvWqa2seeAHYIOTevyUJgzgPWB3/Gwrb5HAoOz9VHtFw/0xvp0vRjItQfjyv/+i2/AGhrRVk7lhkG3lHRcHDT0mmbq+6KlBwRyDCBPRY49XYnxrn1Llg3889ihA2LuJ6/PZpwmCHoWdQFsM7pAtqfgJwoMqiUPNdRxZ+NzmD26ItxWYaSgLAAAAAElFTkSuQmCC"}}]);