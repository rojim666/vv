"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[4],{7678:function(e,t,a){a.r(t),a.d(t,{default:function(){return Rt}});var s=a(6768),i=a(144),l=a(1387),n=a(8292),d=(a(4114),a(4232)),c=a(3536),o=a(5130);const h={class:"fl-jsb-ac"},r={class:"main flex"},u={class:"left-box"},g={class:"list-header fx-ac-be"},p={class:"list-total"},v={key:1},_={class:"screen fx-ac"},k={key:0,class:"list",style:{"text-align":"center"}},m={key:1,class:"list"},f={class:"group-name"},b={class:"group-name"},C={class:"fx-ac"},L={class:"fx-ac"},y={class:"name omit"},w={class:"member"},x={class:"leader-num"},G={class:"group-name"},I={class:"group-name"},S={class:"fx-ac"},T={class:"fx-ac"},F={class:"name omit"},A={class:"member"},W={class:"leader-num"},X={class:"group-page"},E={class:"right-box flex1"},O={class:"right-header fx-ac-be"},K={class:"title"},R={class:"right-list"},$=["onDragstart","onDragenter","onDragend"],N={class:"item-left fx-ac"},M={key:0,class:"sort"},z={class:"title"},D={class:"title"},U={class:"fx-ac"},V={class:"fx-ac"},B={class:"name omit"},J={class:"margin-left-18"},P={class:"leader-num"};function Q(e,t,a,i,l,n){const c=(0,s.g2)("a-tab-pane"),Q=(0,s.g2)("a-tabs"),j=(0,s.g2)("a-button"),q=(0,s.g2)("a-input-search"),H=(0,s.g2)("AccordingGroupManager"),Y=(0,s.g2)("AccordingGroupTags"),Z=(0,s.g2)("a-checkbox"),ee=(0,s.g2)("a-spin"),te=(0,s.g2)("a-tooltip"),ae=(0,s.g2)("a-radio"),se=(0,s.g2)("a-pagination"),ie=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.Wv)(ie,{open:l.visible,"onUpdate:open":t[5]||(t[5]=e=>l.visible=e),centered:"",onOk:n.handleOk,wrapClassName:"select-group-chat",destroyOnClose:!0,onCancel:n.clear,width:746},{title:(0,s.k6)((()=>[(0,s.bF)(Q,{modelValue:l.active,"onUpdate:modelValue":t[0]||(t[0]=e=>l.active=e),onChange:n.tabChange},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.tabs,(e=>((0,s.uX)(),(0,s.Wv)(c,{key:e.value,tab:e.label,disabled:a.disabledTabSwitch},null,8,["tab","disabled"])))),128))])),_:1},8,["modelValue","onChange"])])),footer:(0,s.k6)((()=>[(0,s.Lk)("div",h,[(0,s.Lk)("div",null,[(0,s.eW)((0,d.v_)(a.promptTitle)+" ",1),(0,s.RG)(e.$slots,"footerLeft",{},void 0,!0)]),(0,s.Lk)("div",null,[(0,s.bF)(j,{key:"back",onClick:n.handleCancel},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)(" 取消 ")]))),_:1},8,["onClick"]),(0,s.bF)(j,{key:"submit",type:"primary",loading:l.loading,onClick:n.handleOk},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)(" 保存 ")]))),_:1},8,["loading","onClick"])])])])),default:(0,s.k6)((()=>[(0,s.RG)(e.$slots,"alert",{},void 0,!0),(0,s.Lk)("div",r,[(0,s.Lk)("div",u,[(0,s.bF)(q,{placeholder:"请输入群名称搜索",value:l.name,"onUpdate:value":t[1]||(t[1]=e=>l.name=e),onSearch:n.onSearch,allowClear:!0},null,8,["value","onSearch"]),(0,s.bo)((0,s.bF)(H,{active:l.active,getStaffList:l.staffList,disabledIds:a.disabledIds,viewAppointPermissions:a.viewAppointPermissions,onSearch:n.search},null,8,["active","getStaffList","disabledIds","viewAppointPermissions","onSearch"]),[[o.aG,"2"===l.active]]),(0,s.bo)((0,s.bF)(Y,{active:l.active,getTags:l.tags,disabledIds:a.disabledIds,onSearch:n.search},null,8,["active","getTags","disabledIds","onSearch"]),[[o.aG,"3"===l.active]]),(0,s.Lk)("div",g,[(0,s.Lk)("div",p,[l.isMuti?((0,s.uX)(),(0,s.Wv)(Z,{key:0,disabled:a.disabledIds.length>0,indeterminate:l.indeterminate,checked:l.checkAll,onChange:n.onCheckAllChange},{default:(0,s.k6)((()=>[t[8]||(t[8]=(0,s.eW)("共")),(0,s.Lk)("span",null,(0,d.v_)(l.total),1),t[9]||(t[9]=(0,s.eW)("个群聊 "))])),_:1},8,["disabled","indeterminate","checked","onChange"])):((0,s.uX)(),(0,s.CE)("span",v,[t[10]||(t[10]=(0,s.eW)(" 共")),(0,s.Lk)("span",null,(0,d.v_)(l.total),1),t[11]||(t[11]=(0,s.eW)("个群聊 "))]))]),(0,s.Lk)("div",_,[t[13]||(t[13]=(0,s.eW)(" 排序： ")),(0,s.Lk)("div",{class:"fx-ac margin-left-16 pointer",onClick:t[2]||(t[2]=e=>n.filtrate("buildGroupTime"))},t[12]||(t[12]=[(0,s.Lk)("span",null,"建群时间",-1)]))])]),l.dataLoading?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.bF)(ee,{spinning:l.dataLoading},null,8,["spinning"])])):((0,s.uX)(),(0,s.CE)("div",m,[l.isMuti?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l.dataList,((e,i)=>((0,s.uX)(),(0,s.CE)("div",{class:"item",key:i},[(0,s.bF)(Z,{value:e.chat_id,disabled:a.disabledIds.includes(e.chat_id),checked:l.selectedChatIds.includes(e.chat_id),onChange:t=>n.onChange(t,e)},{default:(0,s.k6)((()=>[(0,s.bF)(te,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",b,(0,d.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",f,(0,d.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",C,[(0,s.Lk)("div",L,[t[14]||(t[14]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",y,(0,d.v_)(e.owner_name),1)]),(0,s.Lk)("div",w,[t[15]||(t[15]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",x,(0,d.v_)(e.total_member),1)])])])),_:2},1032,["value","disabled","checked","onChange"])])))),128)):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(l.dataList,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"item",key:a},[(0,s.bF)(ae,{value:e.chat_id,checked:l.selectedChatIds===e.chat_id,onChange:t=>n.onChange(t,e)},{default:(0,s.k6)((()=>[(0,s.bF)(te,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",I,(0,d.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",G,(0,d.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",S,[(0,s.Lk)("div",T,[t[16]||(t[16]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",F,(0,d.v_)(e.owner_name),1)]),(0,s.Lk)("div",A,[t[17]||(t[17]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",W,(0,d.v_)(e.total_member),1)])])])),_:2},1032,["value","checked","onChange"])])))),128))])),(0,s.Lk)("div",X,[(0,s.bF)(se,{modelValue:l.page.page,"onUpdate:modelValue":t[3]||(t[3]=e=>l.page.page=e),"page-size-options":["20","50","100"],total:l.total,size:"small","show-less-items":"","show-size-changer":"","page-size":l.page.size,onChange:n.pageChange,onShowSizeChange:n.onShowSizeChange},null,8,["modelValue","total","page-size","onChange","onShowSizeChange"])])]),(0,s.Lk)("div",E,[(0,s.Lk)("div",O,[(0,s.Lk)("div",K,[t[18]||(t[18]=(0,s.eW)(" 已选群聊")),(0,s.Lk)("span",null,"（"+(0,d.v_)(l.selectedGroup.length)+"）",1)]),(0,s.bF)(j,{type:"link",onClick:n.clear,disabled:l.selectedGroup.length<1||a.disabledIds.length>0},{default:(0,s.k6)((()=>t[19]||(t[19]=[(0,s.eW)(" 清空选择 ")]))),_:1},8,["onClick","disabled"])]),(0,s.Lk)("div",R,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.selectedGroup,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"fx-ac-be right-item pointer",key:e._id,draggable:!0,onDragstart:t=>n.dragstart(e),onDragenter:t=>n.dragenter(e,t),onDragend:t=>n.dragend(e,t),onDragover:t[4]||(t[4]=e=>n.dragover(e))},[(0,s.Lk)("div",N,[l.isMuti?((0,s.uX)(),(0,s.CE)("div",M)):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[(0,s.bF)(te,null,(0,s.eX)({default:(0,s.k6)((()=>[(0,s.Lk)("div",D,(0,d.v_)(e.name),1)])),_:2},[e.name.length>15?{name:"title",fn:(0,s.k6)((()=>[(0,s.Lk)("div",z,(0,d.v_)(e.name),1)])),key:"0"}:void 0]),1024),(0,s.Lk)("div",U,[(0,s.Lk)("div",V,[t[20]||(t[20]=(0,s.Lk)("span",{class:"leader"},"群主：",-1)),(0,s.Lk)("div",B,(0,d.v_)(e.owner_name),1)]),(0,s.Lk)("div",J,[t[21]||(t[21]=(0,s.Lk)("span",{class:"leader"},"群成员：",-1)),(0,s.Lk)("span",P,(0,d.v_)(e.total_member),1)])])])]),(0,s.bF)(j,{type:"link",onClick:t=>n.del(e.chat_id),disabled:a.disabledIds.includes(e.chat_id)},{default:(0,s.k6)((()=>t[22]||(t[22]=[(0,s.eW)(" 移除 ")]))),_:2},1032,["onClick","disabled"])],40,$)))),128))])])])])),_:3},8,["open","onOk","onCancel"])}const j={class:"recent-choose"},q={class:"flex-wrap"},H=["onClick"],Y={class:"recent-item-content omit"};function Z(e,t,a,i,l,n){const c=(0,s.g2)("a-tooltip");return(0,s.uX)(),(0,s.CE)("div",j,[t[0]||(t[0]=(0,s.Lk)("div",{class:"label"},"最近选择",-1)),(0,s.Lk)("div",q,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.list,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,d.C4)(["recent-item fx-ac-jc pointer",{selected:e.selected,disabled:a.disabledIds.includes(e.chat_id)}]),key:t,onClick:t=>n.selected(e)},[(0,s.bF)(c,null,{title:(0,s.k6)((()=>[(0,s.Lk)("div",null,(0,d.v_)(e.name),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("div",Y,(0,d.v_)(e.name),1)])),_:2},1024)],10,H)))),128))])])}var ee={name:"RecentChoose",props:{list:{type:Array,default:()=>[]},disabledIds:{type:Array,default:()=>[]}},data(){return{}},methods:{selected(e){this.disabledIds.includes(e.chat_id)||this.$emit("selected",e)}}},te=a(1241);const ae=(0,te.A)(ee,[["render",Z],["__scopeId","data-v-3b5fdaaa"]]);var se=ae;const ie={class:"according-group-manager"},le={key:0,class:"flex-wrap tag-box",ref:"tagBoxRef"},ne=["src"],de={class:"name omit"};function ce(e,t,a,i,l,n){const c=(0,s.g2)("a-button"),o=(0,s.g2)("a-tag"),h=(0,s.g2)("SelectStaffNew");return(0,s.uX)(),(0,s.CE)("div",ie,[(0,s.bF)(c,{type:"link",class:"button",onClick:n.selectGroupManager},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)(" 选择群主 ")]))),_:1},8,["onClick"]),l.tagShow?((0,s.uX)(),(0,s.CE)("div",le,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.staffList,((e,t)=>((0,s.uX)(),(0,s.Wv)(o,{class:(0,d.C4)(["tag fx-ac",{"tag-width":l.isWidth}]),closable:"",onClose:e=>n.delTag(t),key:t},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.avatar,alt:"",class:"img"},null,8,ne),(0,s.Lk)("div",de,(0,d.v_)(e.name),1)])),_:2},1032,["class","onClose"])))),128))],512)):(0,s.Q3)("",!0),(0,s.bF)(h,{ref:"selectTagGroup",selectType:"multiple",title:"选择群主",onChange:n.staffUpdate,viewAppointPermissions:a.viewAppointPermissions},null,8,["onChange","viewAppointPermissions"])])}var oe=a(7606),he={name:"AccordingGroupManager",props:{active:{type:String,default:""},getStaffList:{type:Array,default:()=>[]},viewAppointPermissions:{type:Array,default:()=>[]}},components:{SelectStaffNew:oe.A},data(){return{staffList:[],tagShow:!0,isWidth:!1}},watch:{getStaffList:{handler(e){this.staffList=this.getStaffList},deep:!0}},created(){},methods:{selectGroupManager(){this.$refs.selectTagGroup.show(this.staffList)},staffUpdate(e){this.staffList=e,this.getWidth(),this.$emit("search",this.active,this.staffList)},getWidth(){this.$nextTick((()=>{let e=this.$refs.tagBoxRef;this.isWidth=e.offsetHeight<e.scrollHeight}))},delTag(e){this.staffList.splice(e,1),this.tagShow=!1,this.$nextTick((()=>{this.tagShow=!0,this.getWidth(),this.$emit("search",this.active,this.staffList)}))}}};const re=(0,te.A)(he,[["render",ce],["__scopeId","data-v-d7fc077a"]]);var ue=re;const ge={class:"according-group-tags"},pe={class:"flex-wrap tag-box",ref:"tagBoxRef"};function ve(e,t,a,i,l,n){const c=(0,s.g2)("a-button"),o=(0,s.g2)("a-tag"),h=(0,s.g2)("SelectTagGroup");return(0,s.uX)(),(0,s.CE)("div",ge,[(0,s.bF)(c,{type:"link",class:"button",onClick:n.selectTab},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)(" 选择群标签 ")]))),_:1},8,["onClick"]),(0,s.Lk)("div",pe,[l.tagShow?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l.tags,((e,t)=>((0,s.uX)(),(0,s.Wv)(o,{class:"tag",closable:"",onClose:e=>n.delTag(t),key:t},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.name),1)])),_:2},1032,["onClose"])))),128)):(0,s.Q3)("",!0)],512),(0,s.bF)(h,{ref:"selectTagGroup",title:"选择群聊标签",onChange:n.setTagGroupChange},null,8,["onChange"])])}var _e=a.p+"img/cst-task-empty.9b19af16.png";const ke={class:"title-box"},me={class:"block translate3d"},fe={class:"fx-ac-be mb10"},be={class:"wk-black-85-text title"},Ce={key:0,class:"select-tag"},Le={key:1,class:"empty-img fx-ac-jc"},ye={class:"block translate3d"},we={class:"fx-ac-be mb10"},xe={class:"fx-ac"},Ge={key:0,class:"spin fx-ac-jc"},Ie=["innerHTML"],Se=["innerHTML"],Te={key:0,class:"mt10"},Fe=["innerHTML"];function Ae(e,t,a,i,l,n){const c=(0,s.g2)("a-button"),h=(0,s.g2)("a-tag"),r=(0,s.g2)("a-space"),u=(0,s.g2)("PlusOutlined"),g=(0,s.g2)("a-input-search"),p=(0,s.g2)("a-spin"),v=(0,s.g2)("a-checkbox"),_=(0,s.g2)("a-input"),k=(0,s.g2)("groupTagGroupAdd"),m=(0,s.g2)("a-modal"),f=(0,s.gN)("focus");return(0,s.uX)(),(0,s.Wv)(m,{class:"select-tag-dialog-biubiu",modelValue:l.visible,"onUpdate:modelValue":t[1]||(t[1]=e=>l.visible=e),onCancel:n.hide,onOk:n.sure,mask:a.isMaskModal,width:"1000px"},{title:(0,s.k6)((()=>[(0,s.Lk)("div",ke,[(0,s.eW)((0,d.v_)(a.title||"给客户群打标签")+" ",1),200!=l.widthLoading?((0,s.uX)(),(0,s.CE)("div",{key:0,style:(0,d.Tr)({width:l.widthLoading+"%"}),class:"width-loading"},null,4)):(0,s.Q3)("",!0)])])),default:(0,s.k6)((()=>[(0,s.Lk)("div",me,[(0,s.Lk)("div",fe,[(0,s.Lk)("p",be," 已选择的标签("+(0,d.v_)(l.selectTag.length)+") ",1),(0,s.bF)(c,{type:"link",onClick:n.clearSelect},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("清空选择")]))),_:1},8,["onClick"])]),l.selectTag.length?((0,s.uX)(),(0,s.CE)("div",Ce,[(0,s.bF)(r,{size:10,style:{"flex-wrap":"wrap"}},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.selectTag.slice(0,50),((e,t)=>((0,s.uX)(),(0,s.Wv)(h,{key:e.id,color:"blue",closable:"",onClose:e=>n.unselect(t)},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.name)+"("+(0,d.v_)(e.chat_count||0)+") ",1)])),_:2},1032,["onClose"])))),128))])),_:1})])):((0,s.uX)(),(0,s.CE)("div",Le,t[3]||(t[3]=[(0,s.Lk)("img",{class:"img",src:_e,alt:""},null,-1),(0,s.Lk)("span",null,"暂未选择群标签",-1)])))]),(0,s.Lk)("div",ye,[(0,s.Lk)("div",we,[t[5]||(t[5]=(0,s.Lk)("p",{class:"wk-black-85-text title"},"选择可添加的标签",-1)),(0,s.Lk)("div",xe,[(0,s.bF)(c,{type:"link",onClick:n.addBoxShow,class:"mr8"},{default:(0,s.k6)((()=>[(0,s.bF)(u),t[4]||(t[4]=(0,s.eW)(" 新建群标签组 "))])),_:1},8,["onClick"]),(0,s.bF)(g,{style:{width:"350px"},placeholder:"请输入标签组或标签名搜索",modelValue:l.searchValue,"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchValue=e),onSearch:n.onSearch,allowClear:!0},null,8,["modelValue","onSearch"])])]),l.loading?((0,s.uX)(),(0,s.CE)("div",Ge,[(0,s.bF)(p)])):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(l.tagList,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.group_id},[(0,s.Lk)("div",{class:(0,d.C4)(["wk-black-65-text custom-title flex",{"fir-cut-title":0===t}])},[a.isMultiple?((0,s.uX)(),(0,s.Wv)(v,{key:0,indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":t=>e.checkAll=t,onChange:t=>n.onCheckAllChange(t,e)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",{innerHTML:n.getSearName(e)},null,8,Ie)])),_:2},1032,["indeterminate","checked","onUpdate:checked","onChange"])):((0,s.uX)(),(0,s.CE)("span",{key:1,innerHTML:n.getSearName(e)},null,8,Se))],2),e.is_open?((0,s.uX)(),(0,s.CE)("div",Te,[(0,s.bF)(r,{size:10,class:"fl-wrap"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.tag,(t=>((0,s.uX)(),(0,s.CE)(s.FK,null,[-1==l.excludeTags.indexOf(t.id)?((0,s.uX)(),(0,s.Wv)(h,{key:t.id,class:(0,d.C4)({"cur-not":-1!=n.disabledTagsList.indexOf(t.id)}),color:n.isSelect(t)?"blue":"",onClick:a=>n.select(t,e)},{default:(0,s.k6)((()=>[(0,s.Lk)("span",{innerHTML:n.getSearName(t)},null,8,Fe)])),_:2},1032,["class","color","onClick"])):(0,s.Q3)("",!0)],64)))),256)),(0,s.Lk)("template",null,[e.showInput?(0,s.bo)(((0,s.uX)(),(0,s.Wv)(_,{key:0,placeholder:"输入标签名",style:{width:"100px"},maxLength:20,class:"add-input",onBlur:t=>n.addTag(e),onKeyup:(0,o.jR)((t=>n.addTag(e)),["enter"]),ref_for:!0,ref:"add_input_"+e.group_id},null,8,["onBlur","onKeyup"])),[[f]]):(0,s.Q3)("",!0),(0,s.bF)(c,{class:"add",onClick:()=>e.showInput=!0},{default:(0,s.k6)((()=>[(0,s.bF)(u)])),_:2},1032,["onClick"])])])),_:2},1024)])):(0,s.Q3)("",!0)])))),128))]),(0,s.bF)(k,{ref:"groupTagGroupAddRef",onUpdate:n.groupTagUpdate},null,8,["onUpdate"])])),_:1},8,["modelValue","onCancel","onOk","mask"])}const We={class:"add-tag-modal m16"},Xe={class:"flex"},Ee=["onClick"];function Oe(e,t,a,i,l,n){const d=(0,s.g2)("a-input"),c=(0,s.g2)("PlusOutlined"),h=(0,s.g2)("a-button"),r=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(r,{title:"新建标签组",visible:l.tag_visible_group,width:480,onOk:n.tagHandleOkGroup,onCancel:n.tagHandleCancelGroup},{default:(0,s.k6)((()=>[(0,s.Lk)("div",We,[t[2]||(t[2]=(0,s.Lk)("div",{class:"mb8"},"标签组",-1)),(0,s.Lk)("div",Xe,[(0,s.bF)(d,{value:l.tagGroup.tag_group_name,"onUpdate:value":t[0]||(t[0]=e=>l.tagGroup.tag_group_name=e),placeholder:"请填写标签组名",style:{width:"89.3%"},maxLength:15},null,8,["value"])]),t[3]||(t[3]=(0,s.Lk)("div",{class:"mb8 mt8"},[(0,s.Lk)("template",null,[(0,s.eW)("标签")])],-1)),(0,s.Lk)("template",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.tagGroup.tag_name,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"label_add",key:t},[(0,s.bF)(d,{placeholder:"请输入标签名",value:e.name,"onUpdate:value":t=>e.name=t,style:{width:"89.3%"},class:"list_input",maxLength:15,onBlur:e=>n.tage_list_inpt(e,t),help:"标签名不能超过15字，且不能重名"},null,8,["value","onUpdate:value","onBlur"]),(0,s.Lk)("div",{onClick:(0,o.D$)((a=>n.tage_list_dels(e,t)),["stop"]),class:"reduce"}," - ",8,Ee)])))),128))]),l.tagGroup.tag_name.length<20?((0,s.uX)(),(0,s.Wv)(h,{key:0,class:"add_tag_btn",onClick:n.add_list_content},{default:(0,s.k6)((()=>[(0,s.bF)(c),t[1]||(t[1]=(0,s.eW)(" 添加标签 "))])),_:1},8,["onClick"])):(0,s.Q3)("",!0)])])),_:1},8,["visible","onOk","onCancel"])])}var Ke={name:"groupTagGroupAdd",props:{},components:{PlusOutlined:c.A},data(){return{tag_visible_group:!1,tagGroup:{tag_group_name:"",tag_name:[]}}},computed:{},watch:{},created(){},mounted(){},methods:{addBoxShow(){this.tagGroup={tag_group_name:"",tag_name:[{name:"",id:0}]},this.tag_visible_group=!0},editTagDel(){let e=this.data.filter((e=>e.group_id==this.tagGroup.tag_group_id))[0],t={group_id:this.tagGroup.tag_group_id,group_name:this.tagGroup.tag_group_name,num:e.tag.length,tag:e.tag};this.tage_del(t,0,1,!1)},tage_list_inpt(e,t){let a=e.target.value;if(!a)return;let s=this.tagGroup.tag_name.filter(((e,s,i)=>s!==t&&e.name===a));return s.length>0&&(this.tagGroup.tag_name[t].name="",this.$message.error("标签名称不能重名！")),!1},tage_list_dels(e,t){0==e.num?this.tagGroup.tag_name.splice(t,1):this.tage_del(e,t,2)},add_list_content(){this.tagGroup.tag_name.length>19?this.$message.error("标签最大可设置20条"):this.tagGroup.tag_name.push({name:""})},tagHandleOkGroup(){let e={...this.tagGroup},t="";if(""==e.tag_group_name)return void this.$message.error("请补全群组名称再提交！");let a=e.tag_name.filter(((e,t,a)=>""==e.name));a.length>0?this.$message.error("请补全标签名再提交！"):(t="addTagGroup",e.tag_name=e.tag_name.map((e=>e.name)),WK.showLoading(),this.$api[t](e).then((e=>{WK.hideLoading(),0==e.res&&(this.$message.success(e.msg),this.$emit("update"),this.tag_visible_group=!1)}),(e=>{WK.hideLoading()})))},tagHandleCancelGroup(e){this.tag_visible_group=!1},tage_del(e,t,a,s){this.tagGroup.tag_name.splice(t,1)}}};const Re=(0,te.A)(Ke,[["render",Oe],["__scopeId","data-v-79078594"]]);var $e=Re,Ne={components:{groupTagGroupAdd:$e,PlusOutlined:c.A},data(){return{visible:!1,tagList:[],selectTag:[],excludeTags:[],disabledTags:[],searchValue:"",loading:!1,widthLoading:0,numIndex:0,son_index:0,fatherList:[],sonList:[],newTagList:[],time_val:null,tempList:[],tag_visible_group:!1}},props:{title:{type:String},disabled:{type:Array,default(){return[]}},isMultiple:{type:Boolean,default:!0},isMaskModal:{type:Boolean,default:!0}},computed:{role(){return this.$store.state.user.role},disabledTagsList(){let e=this.disabled.concat(this.disabledTags);return this.uniqueFun(e)}},directives:{focus:{inserted(e){e.focus()}}},methods:{clear(){clearInterval(this.time_val),this.selectTag=[],this.excludeTags=[],this.disabledTags=[],this.time_val=null,this.searchValue="",this.tempList=[],this.tagList=[],this.fatherList=[],this.sonList=[],this.newTagList=[],this.numIndex=0,this.son_index=0,this.widthLoading=0},hide(){this.visible=!1,this.clear(),this.$emit("cancel",this.visible)},show(e=[],t=[],a=[]){this.visible=!0,this.selectTag=[...e],t.length>0&&(this.excludeTags=t.map((e=>e.id))),a.length>0&&(this.disabledTags=a.map((e=>e.id))),this.search(),this.getChecked()},againData(e){this.newTagList=[],this.fatherList=[],this.sonList=[],this.numIndex=50,this.son_index=0,this.getNewTag(this.numIndex,e),this.tagList=this.newTagList,this.getTimeVal()},async search(){this.loading=!0,await this.$api.searchGroupTagList({name:this.searchValue}).then((e=>{let t=JSON.parse(JSON.stringify(e.data))||[];t.forEach((e=>{e.showInput=!1,e.is_open=!0,e.indeterminate=!1,e.checkAll=!1,e.checkedList=[]})),this.tempList=JSON.parse(JSON.stringify(t)),this.againData(t),this.getChecked(),this.loading=!1})).catch((e=>{this.loading=!1}))},getTimeVal(){clearInterval(this.time_val),this.time_val=setInterval((()=>{let e=parseInt(this.numIndex/this.sonList.length*100);this.widthLoading=e||0,this.loadScroll()}),600)},getNewTag(e,t){if(0===this.fatherList.length||0===this.sonList.length){let e=[],a=[],s=[];s=t?JSON.parse(JSON.stringify(t)):JSON.parse(JSON.stringify(this.tempList));for(let t=0;t<s.length;t++){e.push(s[t]);for(let e=0;e<s[t].tag.length;e++)a.push(s[t].tag[e]);s[t].tag=[]}this.fatherList=JSON.parse(JSON.stringify(e)),this.sonList=JSON.parse(JSON.stringify(a))}for(let a=0;a<this.fatherList.length;a++){let t=this.fatherList[a],s=this.sonList.slice(this.son_index,e);if(this.son_index>this.sonList.length||this.son_index>e)return;for(let e=0;e<s.length;e++){let a=s[e];if(a.group_id===t.group_id){let e=JSON.stringify(t.tag).indexOf(JSON.stringify(a));-1==e&&t.tag.push(a)}}let i=JSON.stringify(this.newTagList).indexOf(JSON.stringify(t));-1==i&&t.tag.length>0&&this.newTagList.push(t)}},loadScroll(){if(this.sonList.length<this.numIndex){if(clearInterval(this.time_val),200==this.widthLoading)return;return this.widthLoading=105.1,void setTimeout((()=>{this.widthLoading=200}),1500)}this.numIndex+=100,this.getNewTag(this.numIndex),this.tagList=this.newTagList,this.son_index+=100},select(e,t){if(-1!=this.disabledTagsList.indexOf(e.id))return;let a=t.checkedList.findIndex((t=>t.id==e.id));-1===a?t.checkedList.push(e):t.checkedList.splice(a,1);let s=this.selectTag.findIndex((t=>t.id==e.id));-1===s?this.isMultiple?this.selectTag.push(e):this.selectTag=[e]:this.selectTag.splice(s,1),t.indeterminate=!!t.checkedList.length&&t.checkedList.length<t.tag.length,t.checkAll=t.checkedList.length===t.tag.length},unselect(e){this.selectTag.splice(e,1),this.getChecked()},isSelect(e){let t=this.selectTag.findIndex((t=>t.id==e.id));return-1!=t},sure(){this.$emit("change",this.selectTag),this.hide()},addTag(e){const t=this;let a=t.$refs["add_input_"+e.group_id][0].$el,s=a.value;if(!s)return void(e.showInput=!1);let i=e.tag.filter(((e,t,a)=>e.name==s));i.length>0?t.$message.error("标签名称不能重复！"):t.$api.addTag({tag_group_id:e.group_id,tag_name:[s]}).then((async s=>{e.showInput=!1,a.value="",t.$message.success("添加成功"),await t.search(),await this.$emit("update",this.tempList)}))},roteGroup(e,t){e.is_open=!e.is_open,this.$set(this.tagList,t,e)},onCheckAllChange(e,t){const a=new Map;let s=JSON.parse(JSON.stringify(t.tag));if(Object.assign(t,{checkedList:e.target.checked?s:[],indeterminate:!1,checkAll:e.target.checked}),t.checkAll)for(let l=0;l<this.disabledTagsList.length;l++){let e=this.disabledTagsList[l],a=t.checkedList.findIndex((t=>t.id==e));-1!=a&&t.checkedList.splice(a,1)}else for(let l=0;l<t.tag.length;l++){let e=this.selectTag.findIndex((e=>e.id==t.tag[l].id));-1!=e&&this.selectTag.splice(e,1)}let i=[...this.selectTag,...t.checkedList];this.selectTag=i.filter((e=>!a.has(e.id)&&a.set(e.id,1)))},getChecked(){for(let e=0;e<this.tagList.length;e++){let t=this.tagList[e];if(t.checkedList=[],0!==this.selectTag.length)for(let e=0;e<t.tag.length;e++){let a=t.tag[e];for(let e=0;e<this.selectTag.length;e++){let s=this.selectTag[e];a.id==s.id&&t.checkedList.push(a)}}t.checkedList.length===t.tag.length?(t.checkAll=!0,t.indeterminate=!1):(t.checkAll=!1,t.indeterminate=!1,t.checkedList.length>0&&(t.indeterminate=!0))}},uniqueFun(e){const t=new Map;return e.filter((e=>!t.has(e)&&t.set(e,1)))},searchChange(){clearInterval(this.time_val),this.onSearch(this.searchValue)},onSearch(e){if(""==e)return this.getChecked(),void this.againData();this.widthLoading=0;let t=[];for(let s=0;s<this.tempList.length;s++){let a=this.tempList[s];t[s]={group_id:a.group_id,group_name:a.group_name,showInput:a.showInput,is_open:a.is_open,tag:[],indeterminate:!1,checkAll:!1,checkedList:[]};for(let i=0;i<a.tag.length;i++){let a=this.tempList[s].tag[i];a.name.indexOf(e)>-1&&t[s].tag.push({group_id:a.group_id,id:a.id,name:a.name,chat_count:a?.chat_count})}}let a=[];for(let s=0;s<t.length;s++){let i=t[s];if(i.is_open=!0,i.group_name.indexOf(e)>-1){let e=this.tempList.filter((e=>e.group_id==i.group_id))[0];a.push(e)}else i.tag.length>0&&a.push(i)}this.againData(a),this.getChecked()},getSearName(e){let t=e.group_name||e.name,a=e.chat_count||0,s=this.searchValue,i=t.split(s),l="";return i.length>1&&(l=i.join(`<span style="color: #ED744A;">${s}</span>`)),(this.searchValue&&l?l:t)+`(${a})`},clearSelect(){this.selectTag=[];for(let e=0;e<this.tagList.length;e++){let t=this.tagList[e];t.checkedList=[],t.checkAll=!1,t.indeterminate=!1}},addBoxShow(){this.$refs.groupTagGroupAddRef.addBoxShow()},async groupTagUpdate(){await this.clear(),await this.search(),await this.getChecked(),await this.$emit("update",this.tempList)}},beforeUnmount(){clearInterval(this.time_val)}};const Me=(0,te.A)(Ne,[["render",Ae],["__scopeId","data-v-f7148908"]]);var ze=Me,De={name:"AccordingGroupTags",props:{active:{type:String,default:""},getTags:{type:Array,default:()=>[]}},components:{SelectTagGroup:ze},data(){return{tags:[],tagShow:!0}},watch:{getTags:{handler(e){this.tags=this.getTags},deep:!0}},created(){},methods:{selectTab(){this.$refs.selectTagGroup.show(this.tags)},setTagGroupChange(e){this.tags=e,this.$emit("search",this.active,this.tags)},delTag(e){this.tags.splice(e,1),this.tagShow=!1,this.$nextTick((()=>{this.tagShow=!0,this.$emit("search",this.active,this.tags)}))}}};const Ue=(0,te.A)(De,[["render",ve],["__scopeId","data-v-76f0c2f9"]]);var Ve=Ue,Be=a(7875),Je={name:"SelectGroupChat",props:{groupLiveCode:{type:Boolean,default:!1},aGroupGuests:{type:Boolean,default:!1},promptTitle:{type:String,default:""},disabledIds:{type:Array,default:()=>[]},disabledTabSwitch:{type:Boolean,default:!1},otherParams:{type:Object,default:function(){return{}}},viewAppointPermissions:{type:Array,default:function(){return[]}}},components:{RecentChoose:se,AccordingGroupManager:ue,AccordingGroupTags:Ve},data(){return{visible:!1,loading:!1,isMuti:!0,page:{page:1,size:100},total:0,name:"",orderBy:0,active:"1",tabs:[{label:"全部群聊",value:"1"}],dataLoading:!1,dataList:[],selectedChatIds:null,selectedGroup:[],recentChooseGroup:[],staffList:[],tags:[],type:"",oldData:null,newData:null,indeterminate:!1,checkAll:!1}},methods:{show(e=[],t=!0){this.visible=!0,this.reset(t),this.isMuti=t;let a=e.map((e=>e.chat_id));this.selectedChatIds=a,this.selectedGroup=e.concat(),this.isMuti||(this.selectedChatIds=a[0]),this.onSearch()},reset(e){this.selectedChatIds=null,this.selectedGroup=[],e&&(this.selectedChatIds=[])},selected(e){let t=this.recentChooseGroup.findIndex((t=>t.chat_id===e.chat_id));if(this.isMuti)this.recentChooseGroup[t].selected=!this.recentChooseGroup[t].selected,this.recentChooseGroup[t].selected?(this.isMuti?this.selectedChatIds.push(e.chat_id):this.selectedChatIds=e.chat_id,this.selectedGroup.push(e),this.checkAllStatus()):(this.del(e.chat_id),this.checkAllStatus());else if(!e.selected){for(let e in this.recentChooseGroup)this.recentChooseGroup[e].selected=!1;this.recentChooseGroup[t].selected=!0,this.selectedGroup=[],this.selectedGroup.push(e)}},search(e,t){"2"===e&&(this.staffList=t),"3"===e&&(this.tags=t),this.onSearch()},filtrate(e){let t={};"groupMembers"===e&&(t={1:6,6:0,0:1,4:1,5:1}),"buildGroupTime"===e&&(t={4:5,5:0,0:4,1:4,6:4}),this.orderBy=t[this.orderBy],this.page.page=1,this.getList()},async getList(){try{let e={...this.page,keyword:this.name,status:1,...this.otherParams};0!=this.orderBy&&(e.order_by=this.orderBy),"2"===this.active&&(e.owner_user_id=this.staffList.map((e=>e.user_id)).join(",")),"3"===this.active&&(e.tag_ids=this.tags.map((e=>e.id)).join(",")),this.groupLiveCode&&(e.scene=1),this.aGroupGuests&&(e.has_cst=0),this.dataLoading=!0,(0,Be.HN)(e).then((e=>{let t=e.data||{},{items:a,total:s}=t;s=Number(s),this.total=s,this.dataList=a,this.dataLoading=!1})),this.onChange("recentChoose")}catch(e){this.dataLoading=!1}},clear(){this.page.page=1,this.selectedGroup=[],this.selectedChatIds=[],this.indeterminate=!1,this.checkAll=!1,this.recentChooseGroup.map((e=>{e.selected=!1}))},del(e){if(!this.isMuti)return this.selectedChatIds=null,this.selectedGroup=[],void this.recentChooseGroup.map((e=>{e.selected=!1}));let t=this.selectedChatIds.findIndex((t=>t===e)),a=this.selectedGroup.findIndex((t=>t.chat_id===e)),s=this.recentChooseGroup.findIndex((t=>t.chat_id===e));this.selectedChatIds.splice(t,1),this.selectedGroup.splice(a,1),-1!=s&&(this.recentChooseGroup[s].selected=!1),this.checkAllStatus()},dragstart(e){this.oldData=e},dragenter(e,t){this.newData=e,t.preventDefault()},dragend(e,t){if(this.oldData!==this.newData){let e=this.selectedGroup.indexOf(this.oldData),t=this.selectedGroup.indexOf(this.newData),a=[...this.selectedGroup];a.splice(e,1),a.splice(t,0,this.oldData),this.selectedGroup=[...a],this.selectedChatIds=[],this.selectedGroup.map((e=>{this.selectedChatIds.push(e.chat_id)}))}},dragover(e){e.preventDefault()},handleOk(){this.$emit("selectedGroupChat",this.selectedGroup),this.visible=!1},handleCancel(){this.visible=!1},async onSearch(){this.page.page=1,await this.getList()},onChange(e,t){if(!e)return;if("recentChoose"!==e)if(e.target.checked)this.isMuti?this.selectedChatIds.push(t.chat_id):this.selectedChatIds=t.chat_id;else{let e=this.selectedChatIds.findIndex((e=>e===t.chat_id));this.selectedChatIds.splice(e,1)}if(!this.isMuti){let e=this.dataList.find((e=>e.chat_id===this.selectedChatIds));this.selectedGroup=[],e?this.selectedGroup.push(e):this.selectedGroup=[];let t=this.recentChooseGroup.findIndex((e=>e.chat_id===this.selectedChatIds));if(this.recentChooseGroup.map((e=>{e.selected=!1})),-1===t)return;return void(this.recentChooseGroup[t].selected=!0)}let a=this.selectedGroup.map((e=>e.chat_id));this.selectedChatIds.map((e=>{if(!a.includes(e)){let t=this.dataList.find((t=>t.chat_id===e));t&&this.selectedGroup.push(t)}this.recentChooseGroup.length>0&&this.recentChooseGroup.map((t=>{e===t.chat_id&&(t.selected=!0)}))})),this.selectedChatIds.length<this.selectedGroup.length&&a.map((e=>{if(!this.selectedChatIds.includes(e)){let t=this.selectedGroup.findIndex((t=>t.chat_id===e));this.selectedGroup.splice(t,1);let a=this.recentChooseGroup.findIndex((t=>t.chat_id===e));if(-1===a)return;this.recentChooseGroup[a].selected=!1}})),this.checkAllStatus()},async checkAllStatus(){if(!this.isMuti)return;let e=this.dataList.some((e=>this.selectedChatIds.includes(e.chat_id))),t=this.dataList.every((e=>this.selectedChatIds.includes(e.chat_id)));this.indeterminate=!t&&e,this.checkAll=!!this.dataList.length&&t},async onCheckAllChange(e){let t=[...this.selectedGroup,...this.dataList];t=this.uniqueFun(t),e.target.checked||this.dataList.forEach((e=>{let a=t.findIndex((t=>t.chat_id==e.chat_id));t.splice(a,1)})),Object.assign(this,{selectedGroup:t,indeterminate:!1,checkAll:e.target.checked});let a=t.map((e=>e.chat_id));e.target.checked?a.forEach((e=>{this.recentChooseGroup.forEach((t=>{e==t.chat_id&&(t.selected=!0)}))})):this.dataList.forEach((e=>{this.recentChooseGroup.forEach((t=>{e.chat_id==t.chat_id&&(t.selected=!1)}))})),this.selectedChatIds=a},uniqueFun(e){const t=new Map;return e.filter((e=>!t.has(e.chat_id)&&t.set(e.chat_id,1)))},pageChange(e,t){this.page.page=e,this.getList()},onShowSizeChange(e,t){this.page.size=t,this.getList()},tabChange(){this.tags=[],this.staffList=[],this.onSearch()}}};const Pe=(0,te.A)(Je,[["render",Q],["__scopeId","data-v-30488552"]]);var Qe=Pe;const je={key:0,class:"mt8"},qe=["onClick"];var He={__name:"select-chat-box",props:{selectedChats:{type:Array,default(){return[]}}},emits:"change",setup(e,{emit:t}){const a=(0,i.KR)(0),l=t,n=e,o=(0,i.KR)(null),h=(0,i.KR)([]),r=(0,i.Kh)({total:0,current:1,pageSize:8,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}),u=(0,i.Kh)([{title:"群聊名称",dataIndex:"name",width:180},{title:"群主",dataIndex:"owner_name",width:180},{title:"操作",dataIndex:"operate",width:100,fixed:"right"}]);(0,s.wB)((()=>n.selectedChats),((e,t)=>{h.value=n.selectedChats,a.value=n.selectedChats.length}),{immediate:!0});const g=()=>{o.value.show(h.value)},p=e=>{h.value=e,a.value=e.length,l("change",e)},v=e=>{h.value.splice(e,1),a.value=h.value.length,l("change",h.value)},_=e=>{r.current=e.current,r.pageSize=e.pageSize};return(0,s.sV)((()=>{})),(e,t)=>{const l=(0,s.g2)("a-button"),n=(0,s.g2)("a-table");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(l,{icon:(0,s.h)((0,i.R1)(c.A)),type:"dashed",class:"mr16",onClick:g},{default:(0,s.k6)((()=>[(0,s.eW)("选择群聊 ("+(0,d.v_)(a.value)+")",1)])),_:1},8,["icon"]),h.value?.length>0?((0,s.uX)(),(0,s.CE)("div",je,[(0,s.bF)(n,{class:"mt16 select-group-table","data-source":h.value,columns:u,pagination:r,scroll:{y:600},onChange:_},{bodyCell:(0,s.k6)((({column:e,text:t,record:a})=>["operate"===e.dataIndex?((0,s.uX)(),(0,s.CE)("a",{key:0,class:"operate-content",onClick:e=>v(a)},"移除",8,qe)):(0,s.Q3)("",!0)])),_:1},8,["data-source","columns","pagination"])])):(0,s.Q3)("",!0),(0,s.bF)((0,i.R1)(Qe),{ref_key:"selectGroupChat",ref:o,onSelectedGroupChat:p},null,512)])}}};const Ye=(0,te.A)(He,[["__scopeId","data-v-042fc0f3"]]);var Ze=Ye,et=a(8298),tt=a(7644),at=a(4379);const st={class:"fl-jsb-ac"},it={key:0},lt={class:"main flex"},nt={class:"left-box"},dt={class:"group-box"},ct=["onClick"],ot={class:"item-left"},ht={class:"item-right"},rt={key:0,class:"right-box flex1"},ut={class:"box-title"},gt={class:"group-box"},pt={class:"item-left"},vt={class:"item-text"};var _t={__name:"selectSensitivePhrase",emits:"selected",setup(e,{expose:t,emit:a}){const l=(0,i.KR)({}),n=a,c=(0,i.KR)(!1),o=(0,i.KR)(!1),h=(0,i.KR)([]),r=()=>{o.value=!1,h.value=[]},u=(e,t)=>{if(e.target.checked)h.value.push(t);else{let e=h.value.indexOf(t);e>-1&&h.value.splice(e,1)}},g=e=>{l.value=e},p=(0,i.KR)(!1),v=()=>{p.value=!0,n("selected",h.value),o.value=!1,p.value=!1};function _(e,t){if(!t)return e;if(!t.length)return e;let a=t.map((e=>e.id));return e.map((e=>{e.checked=a.indexOf(e.id)>-1})),e}const k=e=>{o.value=!0,h.value=e||[]},m=(0,i.KR)(!1),f=(0,i.KR)([]),b=(0,i.Kh)({total:0,current:0,pageSize:10}),C=()=>{if(c.value)return;c.value=!0;let e={page:b.current,size:b.pageSize};(0,tt.R8)(e).then((e=>{let t=e.data.items||[];if(!t.length)return m.value=!0,!1;b.total=Number(e.data?.total),f.value.length<b.total?m.value=!1:m.value=!0,!f.value.length&&t.length&&(l.value=t[0]),o.value?(f.value=_(f.value.concat(t),h.value),l.value=f.value[0]):f.value=f.value.concat(t)})).finally((()=>{c.value=!1}))};function L(){c.value||(b.current=b.current+1,C())}return(0,s.sV)((()=>{})),t({show:k}),(e,t)=>{const a=(0,s.g2)("a-button"),i=(0,s.g2)("a-checkbox"),n=(0,s.g2)("a-modal");return(0,s.uX)(),(0,s.Wv)(n,{open:o.value,"onUpdate:open":t[0]||(t[0]=e=>o.value=e),centered:"",onOk:v,wrapClassName:"select-words-chat",destroyOnClose:!0,onCancel:r,width:746},{title:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.Lk)("div",{class:"select-words-title"},"选择敏感词",-1)]))),footer:(0,s.k6)((()=>[(0,s.Lk)("div",st,[(0,s.bF)(a,{key:"back",onClick:r},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 取消 ")]))),_:1}),(0,s.bF)(a,{key:"submit",type:"primary",loading:p.value,onClick:v},{default:(0,s.k6)((()=>[t[3]||(t[3]=(0,s.eW)(" 确定 ")),h.value&&h.value.length>0?((0,s.uX)(),(0,s.CE)("span",it,"("+(0,d.v_)(h.value.length)+")",1)):(0,s.Q3)("",!0)])),_:1},8,["loading"])])])),default:(0,s.k6)((()=>[(0,s.Lk)("div",lt,[(0,s.Lk)("div",nt,[t[4]||(t[4]=(0,s.Lk)("div",{class:"box-title"},"敏感词组",-1)),(0,s.bF)(at.A,{class:"datas-item",onLoad:L,finished:m.value,loading:c.value},{default:(0,s.k6)((()=>[(0,s.Lk)("div",dt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)("div",{class:(0,d.C4)(["group-item",{active:e.id===l.value.id}]),key:e.id,onClick:t=>g(e)},[(0,s.Lk)("div",ot,[(0,s.bF)(i,{checked:e.checked,"onUpdate:checked":t=>e.checked=t,value:e.id,onChange:t=>u(t,e)},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.group_name),1)])),_:2},1032,["checked","onUpdate:checked","value","onChange"])]),(0,s.Lk)("div",ht,(0,d.v_)(e.keywords.length),1)],10,ct)))),128))])])),_:1},8,["finished","loading"])]),l.value.keywords?((0,s.uX)(),(0,s.CE)("div",rt,[(0,s.Lk)("div",ut,"敏感词 ("+(0,d.v_)(l.value.keywords.length)+")",1),(0,s.Lk)("div",gt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value.keywords,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"group-item",key:t},[(0,s.Lk)("div",pt,[(0,s.Lk)("div",vt,(0,d.v_)(e),1)])])))),128))])])):(0,s.Q3)("",!0)])])),_:1},8,["open"])}}};const kt=(0,te.A)(_t,[["__scopeId","data-v-bdc408d0"]]);var mt=kt,ft=a(7694);const bt={class:"container"},Ct={key:0,class:"group-select"},Lt={class:"tag-group"},yt={class:"textarea-box"},wt={class:"tag-group"},xt={class:"zm-fixed-bottom-box in-module",style:{"padding-left":"130px"}};var Gt={__name:"ruleStore",setup(e){const t=(0,l.lq)(),a=(0,l.rd)(),n=t.query,o=(0,i.KR)(null),h=(0,i.KR)(0),r=(0,i.KR)(!1),u=(0,i.KR)(!1),g=(0,i.KR)(!1),p=(0,i.KR)([]),v=(0,i.KR)([]),_=(0,i.KR)(""),k=(0,i.Kh)({id:void 0,rule_name:"",chat_type:0,check_user_type:0,group_chat_type:1,hint_group_ids:[],hint_keywords:[],target_msg_type:[],group_chat_id:[]}),m=e=>{k.hint_group_ids=e},f=()=>{o.value.show(k.hint_group_ids)},b=()=>{if(_.value=_.value.trim(),_.value){let e;e=_.value.split("\n");for(let t of e)k.hint_keywords.includes(t)||k.hint_keywords.length<20&&k.hint_keywords.push(t)}_.value=""},C=()=>{h.value>0&&(u.value=!0,(0,tt.vO)({id:h.value}).then((e=>{try{let t=e.data||{};t.group_chat_type=1,t.group_chat_id.length&&(t.group_chat_type=2,t.group_chat_info.map((e=>{e.name||(e.member_list=JSON.parse(e.member_list),e.name=e.member_list.map((e=>e.name)).join("、"))})),p.value=t.group_chat_info),(0,et.AB)(k,t),k.hint_group_ids=t.hint_group_info}catch(t){}})).finally((()=>{u.value=!1})))},L=e=>{p.value=e,k.group_chat_id=e.map((e=>e.chat_id))},y=(e,t)=>{e.preventDefault(),k.hint_group_ids.splice(t,1)},w=(e,t)=>{e.preventDefault(),k.hint_keywords.splice(t,1)},x=()=>{a.push({path:"/module/hint_keywords/index?tab=LOAD_BY_RULE"})},G=()=>{if(k.rule_name=k.rule_name.trim(),!k.rule_name)throw"请输入规则名称";if([0,2].includes(k.chat_type)){if(2==k.group_chat_type&&!k.group_chat_id.length)throw"请选择指定群聊"}else k.group_chat_id=[],p.value=[];if([2].includes(k.check_user_type)||(v.value=[]),!(k.hint_keywords.length||k.hint_group_ids.length||k.target_msg_type.length))throw"敏感词或敏感行为至少完善一项"},I=()=>{g.value=!0;try{G();let e=(0,et.t0)(k);!r.value&&h.value>0&&(e.id=h.value),e.hint_group_ids&&(e.hint_group_ids=e.hint_group_ids.map((e=>e.id))),(0,tt.KP)(e).then((e=>{"success"===e.status&&(ft.Ay.success("操作成功"),setTimeout((()=>{x()}),1200),g.value=!1)}))}catch(e){ft.Ay.error(e),g.value=!1}},S=(0,i.KR)(0),T=()=>{let e={page:1,size:1};(0,tt.R8)(e).then((e=>{S.value=Number(e.data?.total)}))};return(0,s.sV)((()=>{h.value=n.task_id||0,r.value=1==n.is_copy,h.value&&C(),T()})),(e,t)=>{const a=(0,s.g2)("a-input"),l=(0,s.g2)("a-form-item"),n=(0,s.g2)("a-radio"),h=(0,s.g2)("a-radio-group"),r=(0,s.g2)("a-button"),u=(0,s.g2)("a-tag"),v=(0,s.g2)("a-textarea"),C=(0,s.g2)("a-checkbox"),G=(0,s.g2)("a-checkbox-group"),T=(0,s.g2)("a-form");return(0,s.uX)(),(0,s.CE)("div",bt,[(0,s.bF)(T,{"label-col":{span:3},"wrapper-col":{span:21}},{default:(0,s.k6)((()=>[(0,s.bF)(l,{required:"",label:"规则名称"},{default:(0,s.k6)((()=>[(0,s.bF)(a,{value:k.rule_name,"onUpdate:value":t[0]||(t[0]=e=>k.rule_name=e),placeholder:"请输入规则名称","max-length":20,style:{width:"320px"}},null,8,["value"])])),_:1}),(0,s.bF)(l,{required:"",label:"聊天场景"},{default:(0,s.k6)((()=>[(0,s.bF)(h,{value:k.chat_type,"onUpdate:value":t[1]||(t[1]=e=>k.chat_type=e)},{default:(0,s.k6)((()=>[(0,s.bF)(n,{value:0},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("全部")]))),_:1}),(0,s.bF)(n,{value:1},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("仅单聊")]))),_:1}),(0,s.bF)(n,{value:2},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("仅群聊")]))),_:1})])),_:1},8,["value"]),[2].includes(k.chat_type)?((0,s.uX)(),(0,s.CE)("div",Ct,[(0,s.bF)(h,{value:k.group_chat_type,"onUpdate:value":t[2]||(t[2]=e=>k.group_chat_type=e)},{default:(0,s.k6)((()=>[(0,s.bF)(n,{value:1},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)("全部群聊")]))),_:1}),(0,s.bF)(n,{value:2},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)("指定群聊")]))),_:1})])),_:1},8,["value"]),2==k.group_chat_type?((0,s.uX)(),(0,s.Wv)(Ze,{key:0,class:"mt8",onChange:L,selectedChats:p.value},null,8,["selectedChats"])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)])),_:1}),(0,s.bF)(l,{required:"",label:"触发对象"},{default:(0,s.k6)((()=>[(0,s.bF)(h,{value:k.check_user_type,"onUpdate:value":t[3]||(t[3]=e=>k.check_user_type=e)},{default:(0,s.k6)((()=>[(0,s.bF)(n,{value:0},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)("全部")]))),_:1}),(0,s.bF)(n,{value:1},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)("仅客户")]))),_:1}),(0,s.bF)(n,{value:2},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)("仅员工")]))),_:1})])),_:1},8,["value"])])),_:1}),(0,s.bF)(l,{required:"",label:"敏感词"},{default:(0,s.k6)((()=>[(0,s.bF)(r,{type:"dashed",onClick:f},{icon:(0,s.k6)((()=>[(0,s.bF)((0,i.R1)(c.A))])),default:(0,s.k6)((()=>[(0,s.eW)(" 快速添加 ("+(0,d.v_)(S.value)+") ",1)])),_:1}),t[14]||(t[14]=(0,s.Lk)("div",{class:"trigger-object-info"},"除选择敏感词组外，可自定义其他敏感词",-1)),(0,s.Lk)("div",Lt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.hint_group_ids,((e,t)=>((0,s.uX)(),(0,s.Wv)(u,{key:t,class:"zm-customize-tag",onClose:e=>y(e,t),closable:""},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.group_name),1)])),_:2},1032,["onClose"])))),128))]),(0,s.Lk)("div",yt,[(0,s.Lk)("div",wt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.hint_keywords,((e,t)=>((0,s.uX)(),(0,s.Wv)(u,{key:t,class:"zm-customize-tag",onClose:e=>w(e,t),closable:""},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e),1)])),_:2},1032,["onClose"])))),128))]),(0,s.bF)(v,{placeholder:"请输入敏感词，键盘回车可换行添加多个",value:_.value,"onUpdate:value":t[4]||(t[4]=e=>_.value=e),onBlur:b,rows:2},null,8,["value"])])])),_:1}),(0,s.bF)(l,{required:"",label:"敏感行为"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{value:k.target_msg_type,"onUpdate:value":t[5]||(t[5]=e=>k.target_msg_type=e)},{default:(0,s.k6)((()=>[(0,s.bF)(C,{value:"link"},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.eW)("发送链接")]))),_:1}),(0,s.bF)(C,{value:"weapp"},{default:(0,s.k6)((()=>t[16]||(t[16]=[(0,s.eW)("发送小程序")]))),_:1}),(0,s.bF)(C,{value:"card"},{default:(0,s.k6)((()=>t[17]||(t[17]=[(0,s.eW)("发送名片")]))),_:1}),(0,s.bF)(C,{value:"qr_code"},{default:(0,s.k6)((()=>t[18]||(t[18]=[(0,s.eW)("发送二维码图片")]))),_:1}),(0,s.bF)(C,{value:"link_text"},{default:(0,s.k6)((()=>t[19]||(t[19]=[(0,s.eW)("发送包含链接的文本 (发送的文本内容中包含域地址)")]))),_:1})])),_:1},8,["value"])])),_:1}),(0,s.bF)(l),(0,s.Lk)("div",xt,[(0,s.bF)(r,{onClick:x},{default:(0,s.k6)((()=>t[20]||(t[20]=[(0,s.eW)("取 消")]))),_:1}),(0,s.bF)(r,{onClick:I,loading:g.value,class:"ml8",type:"primary"},{default:(0,s.k6)((()=>t[21]||(t[21]=[(0,s.eW)("保 存")]))),_:1},8,["loading"])])])),_:1}),(0,s.bF)(mt,{ref_key:"selectSensitivePhrase",ref:o,onSelected:m},null,512)])}}};const It=(0,te.A)(Gt,[["__scopeId","data-v-c8adb062"]]);var St=It;const Tt={class:"_main-nav"},Ft={key:1,class:"title"};var At={__name:"mainNavbar",props:{title:{type:[Array,String]}},setup(e){return(t,a)=>{const i=(0,s.g2)("router-link"),l=(0,s.g2)("a-breadcrumb-item"),n=(0,s.g2)("a-breadcrumb");return(0,s.uX)(),(0,s.CE)("div",Tt,[Array.isArray(e.title)?((0,s.uX)(),(0,s.Wv)(n,{key:0},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.title,((e,t)=>((0,s.uX)(),(0,s.Wv)(l,{key:t},{default:(0,s.k6)((()=>[e.route?((0,s.uX)(),(0,s.Wv)(i,{key:0,to:e.route},{default:(0,s.k6)((()=>[(0,s.eW)((0,d.v_)(e.name),1)])),_:2},1032,["to"])):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)((0,d.v_)(e.name),1)],64))])),_:2},1024)))),128))])),_:1})):((0,s.uX)(),(0,s.CE)("div",Ft,(0,d.v_)(e.title),1))])}}};const Wt=(0,te.A)(At,[["__scopeId","data-v-b8774510"]]);var Xt=Wt;const Et={class:"sensitive-panel"};var Ot={__name:"ruleConfig",setup(e){const t=(0,l.lq)(),a=t.query,d=((0,s.EW)((()=>t.meta.links||[])),(0,i.KR)(!1)),c=()=>{};return(0,s.sV)((()=>{a.task_id&&c()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(Xt,{title:[{name:"敏感词提醒",route:"/module/hint_keywords/index"},{name:(0,i.R1)(a).task_id?"编辑规则":"新建规则"}]},null,8,["title"]),(0,s.Lk)("div",Et,[d.value?((0,s.uX)(),(0,s.Wv)(n.A,{key:0})):(0,s.Q3)("",!0),(0,s.bF)(St)])]))}};const Kt=(0,te.A)(Ot,[["__scopeId","data-v-a6826dee"]]);var Rt=Kt}}]);